import{d as E,c as D,u as L,g as A,r as M,b as P,j as e,L as k}from"./index-BYH-xESx.js";import{M as q,a as z}from"./scale-control-DsfW2WLY.js";import{C as o}from"./config-BUEk0qKv.js";import{c as u}from"./cn-CBfrqCZ4.js";import{I as F}from"./Image-C35RD_JP.js";import{g as c}from"./image-CpkqAB9L.js";import{s as R}from"./slugify-BCIJIR2V.js";import{p as U}from"./date-1H0cpUAF.js";import{C as G}from"./check-BMi9hL_X.js";import{H as w}from"./Href-E2Dq1iLl.js";import"./mapbox-gl-CNTiHEyl.js";import"./index-Dhbw-shN.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],K=E("copy",O),B=()=>{const r=D.c(10),{gallerySlug:l,slug:t}=L();let a;e:{if(!l||!t){a=void 0;break e}let s,d;if(r[0]!==l||r[1]!==t){let m;if(r[5]!==l?(m=p=>p.slug===l,r[5]=l,r[6]=m):m=r[6],s=A.find(m),!s){a=void 0;break e}d=s.images?.find(p=>{const g=p.filename.replace(/\.[^/.]+$/,"");return R(g)===t}),r[0]=l,r[1]=t,r[2]=s,r[3]=d,r[4]=a}else s=r[2],d=r[3],a=r[4];const x=d;if(x){let m;r[7]!==s||r[8]!==x?(m={image:x,gallery:s},r[7]=s,r[8]=x,r[9]=m):m=r[9],a=m;break e}a=void 0}return a},v=r=>{const l=D.c(16),{textToCopy:t,className:a,children:j,ariaLabel:s,iconToRight:d}=r,x=d===void 0?!1:d,[m,p]=M.useState(!1),{theme:g}=P();let f;l[0]!==t?(f=async()=>{try{await navigator.clipboard.writeText(t),p(!0),setTimeout(()=>p(!1),2e3)}catch(I){console.error("Failed to copy text: ",I)}},l[0]=t,l[1]=f):f=l[1];const N=f,b=`text-xs p-1 bg-transparent flex ${x?"flex-row-reverse":""} items-center gap-2`;let y;l[2]!==a||l[3]!==b?(y=u(b,a),l[2]=a,l[3]=b,l[4]=y):y=l[4];const $=s||"Kopieren";let i;l[5]!==m||l[6]!==g?(i=m?e.jsx(G,{size:16,strokeWidth:2,className:u("min-w-[16px] w-[16px] h-[16px] min-h-[16px]",g==="dark"?"text-red-300":"text-red-600")}):e.jsx(K,{className:u("min-w-[16px] w-[16px] h-[16px] min-h-[16px]",g==="dark"?"text-red-300":"text-red-600"),size:16}),l[5]=m,l[6]=g,l[7]=i):i=l[7];let n;l[8]!==j?(n=e.jsx("span",{children:j}),l[8]=j,l[9]=n):n=l[9];let h;return l[10]!==N||l[11]!==y||l[12]!==$||l[13]!==i||l[14]!==n?(h=e.jsxs("button",{onClick:N,className:y,"aria-label":$,children:[i,n]}),l[10]=N,l[11]=y,l[12]=$,l[13]=i,l[14]=n,l[15]=h):h=l[15],h},re=()=>{const{theme:r}=P(),l=B();if(M.useEffect(()=>{if(l){const{image:s,gallery:d}=l,x=document.createElement("script");x.type="application/ld+json",x.id="image-structured-data";const m={"@context":"https://schema.org","@type":"ImageObject",name:s.filename,description:s.alt||`A photo from the gallery: ${d.title}`,contentUrl:`${o.url}${c(d.slug,encodeURI(s.filename.replaceAll(" ","_")),"original")}`,author:{"@type":"Person",name:o.meta.title},...s.latitude&&s.longitude&&{location:{"@type":"Place",geo:{"@type":"GeoCoordinates",latitude:s.latitude,longitude:s.longitude},...s.googleMapsUrl&&{sameAs:s.googleMapsUrl}}}};return x.innerHTML=JSON.stringify(m),document.head.appendChild(x),()=>{const p=document.getElementById("image-structured-data");p&&document.head.removeChild(p)}}},[l]),!l)return e.jsx("div",{className:"py-10 text-left",children:"Bild nicht gefunden."});const{image:t,gallery:a}=l,j=M.useMemo(()=>{if(!l)return[];const{image:s,gallery:d}=l;let x=[];if(s.latitude&&s.longitude){const i=(n,h,I,C)=>{const _=(I-n)*(Math.PI/180),S=(C-h)*(Math.PI/180),T=Math.sin(_/2)*Math.sin(_/2)+Math.cos(n*(Math.PI/180))*Math.cos(I*(Math.PI/180))*Math.sin(S/2)*Math.sin(S/2);return 6371*(2*Math.atan2(Math.sqrt(T),Math.sqrt(1-T)))};x=A.flatMap(n=>n.images.map(h=>({...h,gallerySlug:n.slug}))).filter(n=>n.filename!==s.filename&&n.latitude&&n.longitude).map(n=>({...n,distance:i(s.latitude,s.longitude,n.latitude,n.longitude)})).sort((n,h)=>n.distance-h.distance)}let m=d.images.filter(i=>i.filename!==s.filename).map(i=>({...i,gallerySlug:d.slug}));const p=A.filter(i=>i.slug!==d.slug).flatMap(i=>i.images.map(n=>({...n,gallerySlug:i.slug}))).filter(i=>i.filename!==s.filename),g=p.length>0?p:A.flatMap(i=>i.images.map(n=>({...n,gallerySlug:i.slug}))).filter(i=>i.filename!==s.filename);let f=null;if(g.length>0){const i=new Date().getTime(),n=Math.floor((i%g.length+g.length)%g.length);f={...g[n],isRandomPick:!0},console.log("RANDOM IMAGE SELECTED:",f.filename,"from gallery:",f.gallerySlug)}const N=[...x,...m],b=f?N.filter(i=>i.filename!==f.filename):N,$=Array.from(new Map(b.map(i=>[i.filename,i])).values()).slice(0,5);return f&&$.push(f),$},[l]);return e.jsxs("div",{className:"w-full max-w-[var(--content-width)] p-4 md:p-8 flex flex-col items-center",children:[e.jsx("title",{children:`${t.filename.replace("_"," ").replace(".jpg","").trim()} | ${a.title} | ${o.meta.title}`}),e.jsx("meta",{name:"title",content:`${t.filename.replace("_"," ").replace(".jpg","").trim()} | ${a.title} | ${o.meta.title}`}),e.jsx("meta",{name:"description",content:`${t.alt||a.title}`}),e.jsx("meta",{name:"image",content:`${o.url}${c(a.slug,encodeURI(t.filename.replaceAll(" ","_")),640)}`}),e.jsx("meta",{name:"og:image",content:`${o.url}${c(a.slug,encodeURI(t.filename.replaceAll(" ","_")),640)}`}),e.jsx("meta",{name:"og:title",content:`${t.filename} | ${a.title} | ${o.meta.title}`}),e.jsx("meta",{name:"og:description",content:`${t.alt||a.title}`}),e.jsx("meta",{name:"og:url",content:`${o.url}${c(a.slug,encodeURI(t.filename.replaceAll(" ","_")),640)}`}),e.jsxs("div",{className:"w-full max-w-4xl flex flex-col gap-4",children:[e.jsx("div",{className:"flex items-center h-auto md:h-[85vh]",children:e.jsx(F,{src:c(a.slug,encodeURI(t.filename.replaceAll(" ","_"))),alt:t.filename.replaceAll("_"," ").replace(".jpg","").trim(),width:t.width,height:t.height,sizes:"(max-width: 768px) 100vw, 1024px",className:"max-h-full h-full max-w-full object-contain"})}),e.jsxs("div",{className:"flex flex-col gap-0 w-full",children:[e.jsx("h1",{className:"text-base md:text-3xl mb-4",children:t.filename.replaceAll("_"," ").replace(".jpg","").trim()}),e.jsxs("div",{className:"flex justify-between items-center gap-4 my-4 border-t border-neutral-500/50 border-dotted pt-8",children:[e.jsxs(k,{className:u("flex items-center gap-2  "),to:`/gallery/${a.slug}`,children:[e.jsx("img",{src:c(a.slug,encodeURI(a.images[0].filename.replaceAll(" ","_")),380),alt:a.title,className:"w-7 h-7 object-cover"}),e.jsx(w,{className:"text-[11px] truncate",children:a.title})]}),e.jsx(v,{className:"min-h-4 sm:flex-row-reverse",iconToRight:!1,textToCopy:window.location.href,children:e.jsx("span",{className:"text-[11px] text-nowrap hidden sm:block truncate",children:"Kopieren"})})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row-reverse gap-8 mt-4 border-t border-neutral-500/50 pt-4 md:pt-8 border-dotted",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-base mb-2",children:"URLs"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[100px,1fr] gap-x-4 gap-y-3 text-sm",children:[e.jsx("div",{className:"text-[10px] tracking-wider font-mono",children:"Original"}),e.jsxs("div",{className:"flex items-center gap-2 font-mono",children:[e.jsx(w,{href:c(a.slug,t.filename.replaceAll(" ","_"),"original"),hasDecoration:!1,className:u("truncate font-mono text-xs max-w-[calc(100%-40px)]"),children:`${o.url}${c(a.slug,encodeURI(t.filename.replaceAll(" ","_")),"original")}`}),e.jsx(v,{className:"",textToCopy:`${o.url}${c(a.slug,encodeURI(t.filename.replaceAll(" ","_")),"original")}`})]}),e.jsx("div",{className:"text-[10px] tracking-wider font-mono",children:"1440 px"}),e.jsxs("div",{className:"flex items-center gap-2 font-mono",children:[e.jsx(w,{href:c(a.slug,t.filename.replaceAll(" ","_"),1440),hasDecoration:!1,className:u("truncate font-mono text-xs max-w-[calc(100%-40px)]"),children:`${o.url}${c(a.slug,encodeURI(t.filename.replaceAll(" ","_")),1440)}`}),e.jsx(v,{textToCopy:window.location.href})]}),e.jsx("div",{className:"text-[10px] tracking-wider font-mono",children:"640 px"}),e.jsxs("div",{className:"flex items-center gap-2 font-mono",children:[e.jsx(w,{href:c(a.slug,t.filename.replaceAll(" ","_"),640),hasDecoration:!1,className:u("truncate font-mono text-xs max-w-[calc(100%-40px)]"),children:`${o.url}${c(a.slug,encodeURI(t.filename.replaceAll(" ","_")),640)}`}),e.jsx(v,{textToCopy:`${o.url}${c(a.slug,encodeURI(t.filename.replaceAll(" ","_")),640)}`})]}),e.jsx("div",{className:"text-[10px] tracking-wider font-mono",children:"380 px"}),e.jsxs("div",{className:"flex items-center gap-2 font-mono",children:[e.jsx(w,{href:c(a.slug,t.filename.replaceAll(" ","_"),380),hasDecoration:!1,className:u("truncate font-mono text-xs max-w-[calc(100%-40px)]"),children:`${o.url}${c(a.slug,encodeURI(t.filename.replaceAll(" ","_")),380)}`}),e.jsx(v,{textToCopy:`${o.url}${c(a.slug,encodeURI(t.filename.replaceAll(" ","_")),380)}`})]}),t.createDate&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-base mt-4",children:"Datum & Uhrzeit"}),e.jsx(k,{to:`/app/timeline?scrollTo=${U(t.createDate).toISOString().split("T")[0]}`,className:u("text-xs underline underline-offset-4",r==="dark"?"hover:text-red-300 decoration-red-300":"hover:text-red-600 decoration-red-600"),children:new Date(U(t.createDate)).toLocaleDateString("de-DE",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]})]}),t.latitude&&t.longitude&&e.jsxs("div",{className:"flex-1 mb-8 md:mb-4",children:[e.jsx("h2",{className:"text-base mb-2",children:"Standort & Karte"}),e.jsx("p",{className:"text-xs mb-2 font-mono text-[11px]",children:`${t.latitude.toFixed(4)}, ${t.longitude.toFixed(4)}`}),e.jsx("div",{className:"border aspect-square w-full overflow-hidden",children:e.jsx(q,{initialViewState:{latitude:t.latitude,longitude:t.longitude,zoom:12},style:{width:"100%",height:"100%"},mapStyle:r==="dark"?o.mapbox.style.dark:o.mapbox.style.light,mapboxAccessToken:o.mapbox.accessToken,scrollZoom:!0,dragPan:!1,children:e.jsx(z,{longitude:t.longitude,latitude:t.latitude,children:e.jsx("div",{children:e.jsx("div",{className:u("w-4 h-4 border border-white",r==="dark"?"bg-red-300":"bg-red-600")})})})},t.filename)}),e.jsxs("div",{className:"flex flex-wrap space-y-2 space-x-4 gap-0 mt-2",children:[e.jsx(k,{to:`/app/map?image=${R(t.filename.replace(/\.[^/.]+$/,""))}&gallery=${a.slug}`,className:u("text-sm inline-block underline underline-offset-4 inline-block ",r==="dark"?"text-white decoration-red-300 hover:text-red-300 hover:decoration-red-300":"text-black decoration-red-500 hover:text-red-600"),children:"Auf der Karte anzeigen"}),e.jsx(w,{className:"text-sm",href:`https://www.google.com/maps/search/?api=1&query=${t.latitude},${t.longitude}`,children:"Google Maps"}),e.jsx(w,{className:"text-sm",href:`http://maps.apple.com/?q=${t.latitude},${t.longitude}`,children:"Apple Maps"})]})]})]})]})]}),j.length>0&&e.jsxs("div",{className:"w-full pb-8 md:pb-0 max-w-4xl mt-8 pt-8 border-t border-neutral-500/50 border-dotted",children:[e.jsx("h2",{className:"text-base mb-4",children:"Andere Fotos"}),e.jsx("div",{className:"grid grid-cols-3 md:grid-cols-6 gap-4",children:j.map(s=>e.jsx(k,{to:`/gallery/${s.gallerySlug}/image/${R(s.filename.replace(/\.[^/.]+$/,""))}`,className:"relative",children:e.jsx("img",{src:c(s.gallerySlug,s.filename.replaceAll(" ","_"),380),alt:s.filename.replaceAll("_"," ").replace(".jpg","").trim(),width:380,height:380,sizes:"(max-width: 768px) 50vw, 20vw",className:u("aspect-square object-cover w-full h-full",s.isRandomPick&&"")})},s.filename))})]})]})};export{re as default};
