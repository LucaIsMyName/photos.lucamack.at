import{b as x,e as C,r as n,g as v,j as t,L as h}from"./index-Dri2YBdd.js";import{c as m}from"./cn-CBfrqCZ4.js";import{p as d}from"./date-1H0cpUAF.js";import{C as g}from"./config-BUEk0qKv.js";import{g as w}from"./image-CpkqAB9L.js";import{s as y}from"./slugify-BCIJIR2V.js";import{M as E}from"./map-pin-BkHfocnp.js";import{D as P}from"./download-JwSBCDZY.js";import"./mapbox-gl-CNTiHEyl.js";const O=()=>{const{theme:r}=x(),[o,b]=C(),[i,u]=n.useState(o.get("tab")||"images");n.useEffect(()=>{const e=o.get("scrollTo");if(e){const a=document.getElementById(e);a&&setTimeout(()=>{a.scrollIntoView({behavior:"smooth",block:"start"})},100)}},[]),n.useEffect(()=>{const e=new URLSearchParams(o);i==="images"?e.delete("tab"):e.set("tab",i),o.toString()!==e.toString()&&b(e,{replace:!0})},[i,o,b]);const f=n.useMemo(()=>{const e=[];return v.forEach(a=>{a.images?.forEach((s,l)=>{e.push({...s,galleryTitle:a.title,gallerySlug:a.slug,index:l+1})})}),e},[]),$=n.useMemo(()=>{const e={};f.forEach(a=>{const s=d(a.createDate);if(s){const l=s.toISOString().split("T")[0];e[l]||(e[l]=[]),e[l].push(a)}});for(const a in e)e[a].sort((s,l)=>{const p=d(s.createDate)?.getTime()||0,c=d(l.createDate)?.getTime()||0;return p-c});return Object.entries(e).sort(([a],[s])=>new Date(s).getTime()-new Date(a).getTime())},[f]),T=n.useMemo(()=>v.map(e=>{if(!e.images||e.images.length===0)return{...e,startDate:null,endDate:null};const a=e.images.map(c=>d(c.createDate)).filter(c=>c!==null);if(a.length===0)return{...e,startDate:null,endDate:null};const s=a.sort((c,S)=>c.getTime()-S.getTime()),l=s[0],p=s[s.length-1];return{...e,startDate:l,endDate:p}}).filter(e=>e.startDate!==null&&e.endDate!==null).sort((e,a)=>a.startDate.getTime()-e.startDate.getTime()),[]),j=e=>`text-4xl md:text-5xl py-2   ${e===!0?x().theme==="dark"?`${g.theme.dark.text.primary}`:`${g.theme.light.text.primary}`:x().theme==="dark"?"text-white":"text-black"}`,D=m(`absolute sm:left-2 left-0 top-4.5 h-full w-px ${r==="dark"?"bg-white":"bg-black"}`),k=m("absolute -left-[32px] sm:-left-[23.4px] top-4.5 transform -translate-x-1/2 flex items-center"),N=m(`${r==="dark"?"bg-red-300 border border-white":"bg-red-600 border border-black"} h-2 w-2 `);return t.jsxs("div",{className:`p-4  pl-7 sm:pl-4 md:pl-0 md:pt-6  ${r==="light"?"bg-white text-gray-800":"bg-black text-gray-200"}`,children:[t.jsx("title",{children:`Timeline | ${g.meta.title}`}),t.jsx("meta",{name:"description",content:"Timeline von allen Fotos & Galerien"}),t.jsx("meta",{name:"title",content:`Timeline | ${g.meta.title}`}),t.jsxs("div",{className:"flex items-center justify-between mb-4 -ml-3 sm:ml-0",children:[t.jsx("h1",{className:"text-2xl sr-only",children:"Timeline"}),t.jsxs("div",{className:"flex items-center space-x-2 gap-2 md:ml-0",children:[t.jsx("button",{onClick:()=>u("images"),className:` ${j(i==="images")}`,children:"Fotos"}),t.jsx("button",{onClick:()=>u("galleries"),className:` ${j(i==="galleries")}`,children:"Serien"})]})]}),i==="images"&&t.jsxs("div",{className:"relative pl-8",children:[t.jsx("div",{className:D}),t.jsx("div",{className:"space-y-8",children:$.map(([e,a])=>t.jsxs("div",{id:e,className:"relative",children:[t.jsx("div",{className:k,children:t.jsx("div",{className:N})}),t.jsx("h2",{className:`sm:text-lg mb-4 sticky top-0 py-2 z-50 ${r==="dark"?"bg-black":"bg-white"}`,children:new Date(e).toLocaleDateString("de-DE",{year:"numeric",month:"long",day:"numeric"})}),t.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-6 md:grid-cols-7 lg:grid-cols-8 xl:grid-cols-10 gap-2 sm:gap-4",children:a.map(s=>t.jsxs(h,{to:`/gallery/${s.gallerySlug}/image/${y(s.filename.replace(/\.[^/.]+$/,""))}`,className:m(`${r==="dark"?"text-white bg-white/10":"text-black bg-black/10"} relative group block`),children:[t.jsx("img",{src:w(s.gallerySlug,s.filename.replaceAll(" ","_"),160),alt:s.alt||s.filename,loading:"lazy",className:"w-full h-full object-cover aspect-square"}),t.jsxs("div",{className:"sr-only absolute inset-0 bg-black/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex justify-end items-start p-2 gap-1.5",children:[s.googleMapsUrl&&t.jsx(h,{to:`/app/map?gallery=${s.gallerySlug}&image=${y(s.filename.replace(/\.[^/.]+$/,""))}`,onClick:l=>l.stopPropagation(),className:`p-1 transition-colors ${r==="dark"?"text-white bg-black bg-opacity-50 ":"text-black bg-white bg-opacity-50"}`,"aria-label":`View ${s.filename} on map`,children:t.jsx(E,{size:16})}),t.jsx("a",{href:w(s.gallerySlug,s.filename.replaceAll(" ","_"),"original"),target:"_blank",onClick:l=>l.stopPropagation(),className:`p-1 transition-colors ${r==="dark"?"text-white bg-black bg-opacity-50 ":"text-black bg-white bg-opacity-50"}`,"aria-label":`Download ${s.filename.replaceAll(" ","_")}`,children:t.jsx(P,{size:16})})]})]},s.filename))})]},e))})]}),i==="galleries"&&t.jsxs("div",{className:"relative pl-8",children:[t.jsx("div",{className:D}),t.jsx("h2",{className:"sr-only text-xl font-semibold my-4",children:"Gallerien nach Zeitraum"}),t.jsx("div",{className:"space-y-4",children:T.map(e=>t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:k,children:t.jsx("div",{className:N})}),t.jsxs(h,{to:`/gallery/${e.slug}`,className:"block p-4 pt-2",children:[t.jsx("h3",{className:" text-lg",children:e.title}),t.jsxs("p",{className:"text-xs ",children:[e.startDate.toLocaleDateString("de-DE")," - ",e.endDate.toLocaleDateString("de-DE")]}),t.jsxs("p",{className:"text-xs ",children:[e.images.length," Fotos"]})]})]},e.slug))})]})]})};export{O as default};
