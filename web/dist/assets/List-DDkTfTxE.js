import{h as X,c as se,r as o,u as _,j as t,C as D,k as le,l as ce,i as ie,g as W,p as B,b as Z,a as J,L as Y,s as ee}from"./index-DVdTHJIc.js";import{H as Q}from"./Href-C42Sdcvk.js";import{V as oe,T as me,I as he,S as de,a as ue,b as fe,c as xe,d as ge,P as pe,C as be,R as je,D as ye}from"./index-G1Lnzr_q.js";import{S as we}from"./SeoHead-5TUofPTk.js";import{M as ae}from"./map-pin-CNMFREh_.js";import"./mapbox-gl-CNTiHEyl.js";import"./index-M_cDX5gi.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],ve=X("chevron-left",Se);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],De=X("chevron-right",Ne);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ke=X("clock",$e);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Fe=X("image",Ce),re=x=>{const e=se.c(25),{children:n,className:z}=x,g=z===void 0?"":z,p=o.useRef(null),[f,V]=o.useState(!1),[F,G]=o.useState(!1),{theme:m}=_();let E;e[0]===Symbol.for("react.memo_cache_sentinel")?(E=N=>{const v=p.current;if(v){const w=v.clientWidth*.8;v.scrollBy({left:N==="left"?-w:w,behavior:"smooth"})}},e[0]=E):E=e[0];const h=E;let I;e[1]===Symbol.for("react.memo_cache_sentinel")?(I=()=>{const N=()=>{const w=p.current;if(w){const{scrollLeft:s,scrollWidth:l,clientWidth:a}=w,r=s<=0,i=s>=l-a-1;V(!r),G(!i)}},v=p.current;if(v){N(),v.addEventListener("scroll",N);const w=new ResizeObserver(N);return w.observe(v),()=>{v.removeEventListener("scroll",N),w.unobserve(v)}}},e[1]=I):I=e[1];let c;e[2]!==n?(c=[n],e[2]=n,e[3]=c):c=e[3],o.useEffect(I,c);const $=`flex items-center  w-full overflow-x-auto no-scrollbar py-2 ${g}`;let d;e[4]!==n||e[5]!==$?(d=t.jsx("div",{ref:p,className:$,children:n}),e[4]=n,e[5]=$,e[6]=d):d=e[6];const M=`absolute top-0 left-0 bottom-0 w-12 bg-gradient-to-r ${m==="light"?"from-white":"from-black"} to-transparent pointer-events-none transition-opacity duration-300 ${f?"opacity-100":"opacity-0"}`;let b;e[7]===Symbol.for("react.memo_cache_sentinel")?(b=()=>h("left"),e[7]=b):b=e[7];const k=`absolute top-1/2 -translate-y-1/2 left-0 ${m==="dark"?"text-white":"text-black"} pointer-events-auto`;let T;e[8]===Symbol.for("react.memo_cache_sentinel")?(T=t.jsx(ve,{size:20}),e[8]=T):T=e[8];let j;e[9]!==k?(j=t.jsx("button",{onClick:b,className:k,children:T}),e[9]=k,e[10]=j):j=e[10];let y;e[11]!==j||e[12]!==M?(y=t.jsx("div",{className:M,children:j}),e[11]=j,e[12]=M,e[13]=y):y=e[13];const L=`absolute top-0 right-0 bottom-0 w-12 bg-gradient-to-l ${m==="light"?"from-white":"from-black"} to-transparent pointer-events-none transition-opacity duration-300 ${F?"opacity-100":"opacity-0"}`;let O;e[14]===Symbol.for("react.memo_cache_sentinel")?(O=()=>h("right"),e[14]=O):O=e[14];const R=`absolute top-1/2 -translate-y-1/2 right-0 ${m==="dark"?"text-white":"text-black"} pointer-events-auto`;let u;e[15]===Symbol.for("react.memo_cache_sentinel")?(u=t.jsx(De,{size:20}),e[15]=u):u=e[15];let A;e[16]!==R?(A=t.jsx("button",{onClick:O,className:R,children:u}),e[16]=R,e[17]=A):A=e[17];let C;e[18]!==L||e[19]!==A?(C=t.jsx("div",{className:L,children:A}),e[18]=L,e[19]=A,e[20]=C):C=e[20];let S;return e[21]!==y||e[22]!==C||e[23]!==d?(S=t.jsxs("div",{className:"relative flex items-center w-full",children:[d,y,C]}),e[21]=y,e[22]=C,e[23]=d,e[24]=S):S=e[24],S};function te(x,e){const n=se.c(4),[z,g]=o.useState(x);let p,f;return n[0]!==e||n[1]!==x?(p=()=>{const V=setTimeout(()=>{g(x)},e);return()=>{clearTimeout(V)}},f=[x,e],n[0]=e,n[1]=x,n[2]=p,n[3]=f):(p=n[2],f=n[3]),o.useEffect(p,f),z}const ne=x=>{const e=se.c(56),{searchTerm:n,setSearchTerm:z,sortKey:g,setSortKey:p,sortOptions:f,sortOrder:V,setSortOrder:F,startDate:G,setStartDate:m,endDate:E,setEndDate:h,onClearFilters:I}=x,{theme:c}=_();let $;e[0]!==z?($=H=>z(H.target.value),e[0]=z,e[1]=$):$=e[1];let d;e[2]!==n||e[3]!==$?(d=t.jsx("div",{className:`flex-shrink-0 p-2  ${D.theme.border.right} `,children:t.jsx("input",{type:"text",placeholder:"Suchen...",value:n,onChange:$,className:"bg-transparent focus:outline-none w-48"})}),e[2]=n,e[3]=$,e[4]=d):d=e[4];let M;e[5]===Symbol.for("react.memo_cache_sentinel")?(M=t.jsx("label",{htmlFor:"startDate",className:"whitespace-nowrap",children:"Filter von"}),e[5]=M):M=e[5];let b;e[6]!==m?(b=H=>m(H.target.value),e[6]=m,e[7]=b):b=e[7];let k;e[8]!==G||e[9]!==b?(k=t.jsx("input",{id:"startDate",type:"date",value:G,onChange:b,className:"bg-transparent focus:outline-none uppercase"}),e[8]=G,e[9]=b,e[10]=k):k=e[10];let T;e[11]===Symbol.for("react.memo_cache_sentinel")?(T=t.jsx("label",{htmlFor:"endDate",children:"bis"}),e[11]=T):T=e[11];let j;e[12]!==h?(j=H=>h(H.target.value),e[12]=h,e[13]=j):j=e[13];let y;e[14]!==E||e[15]!==j?(y=t.jsx("input",{id:"endDate",type:"date",value:E,onChange:j,className:"bg-transparent focus:outline-none uppercase"}),e[14]=E,e[15]=j,e[16]=y):y=e[16];let L;e[17]!==k||e[18]!==y?(L=t.jsxs("div",{className:`flex-shrink-0 flex items-center gap-4 p-2 px-4  ${D.theme.border.right}`,children:[M,k,T,y]}),e[17]=k,e[18]=y,e[19]=L):L=e[19];let O;e[20]===Symbol.for("react.memo_cache_sentinel")?(O=t.jsx("span",{className:"whitespace-nowrap",children:"Sortieren nach"}),e[20]=O):O=e[20];let R;e[21]===Symbol.for("react.memo_cache_sentinel")?(R=t.jsx(oe,{}),e[21]=R):R=e[21];let u;e[22]===Symbol.for("react.memo_cache_sentinel")?(u=t.jsxs(me,{className:"inline-flex items-center justify-center gap-2 bg-transparent focus:outline-none",children:[R,t.jsx(he,{children:t.jsx(le,{size:16})})]}),e[22]=u):u=e[22];const A=`overflow-hidden ${c==="dark"?"bg-black text-white ":"bg-white text-black"}  ${D.theme.border.default}`;let C;e[23]===Symbol.for("react.memo_cache_sentinel")?(C=t.jsx(de,{className:"flex items-center justify-center h-6 cursor-default",children:t.jsx(ce,{})}),e[23]=C):C=e[23];let S;if(e[24]!==f||e[25]!==c){let H;e[27]!==c?(H=q=>t.jsx(ue,{value:q.value,"aria-label":q.label,className:`text-sm leading-none flex items-center h-6 pr-8 pl-6 relative select-none data-[highlighted]:outline-none ${c==="dark"?"data-[highlighted]:bg-red-300 data-[highlighted]:text-black":"data-[highlighted]:bg-red-600 data-[highlighted]:text-white"}`,children:t.jsx(fe,{children:q.label})},q.value),e[27]=c,e[28]=H):H=e[28],S=f.map(H),e[24]=f,e[25]=c,e[26]=S}else S=e[26];let N;e[29]!==S?(N=t.jsx(xe,{className:"p-1",children:S}),e[29]=S,e[30]=N):N=e[30];let v;e[31]===Symbol.for("react.memo_cache_sentinel")?(v=t.jsx(ge,{className:"flex items-center justify-center h-6 cursor-default",children:t.jsx(le,{})}),e[31]=v):v=e[31];let w;e[32]!==A||e[33]!==N?(w=t.jsx(pe,{children:t.jsxs(be,{className:A,children:[C,N,v]})}),e[32]=A,e[33]=N,e[34]=w):w=e[34];let s;e[35]!==p||e[36]!==g||e[37]!==w?(s=t.jsxs(je,{value:g,"aria-label":"Sortieren nach",onValueChange:p,children:[u,w]}),e[35]=p,e[36]=g,e[37]=w,e[38]=s):s=e[38];let l;e[39]!==F||e[40]!==V?(l=()=>F(V==="asc"?"desc":"asc"),e[39]=F,e[40]=V,e[41]=l):l=e[41];const a=V==="asc"?"(Aufsteigend)":"(Absteigend)";let r;e[42]!==l||e[43]!==a?(r=t.jsx("button",{onClick:l,"aria-label":"Sortieren nach",className:"whitespace-nowrap",children:a}),e[42]=l,e[43]=a,e[44]=r):r=e[44];let i;e[45]!==s||e[46]!==r?(i=t.jsxs("div",{className:`flex-shrink-0 flex items-center gap-4 p-2 px-4  ${D.theme.border.right}`,children:[O,s,r]}),e[45]=s,e[46]=r,e[47]=i):i=e[47];const K=`${c==="dark"?"text-red-300":"text-red-600"} underline underline-offset-4 whitespace-nowrap hover:underline`;let P;e[48]!==I||e[49]!==K?(P=t.jsx("div",{className:"flex-shrink-0 p-2 px-4",children:t.jsx("button",{onClick:I,"aria-label":"Alle Filter löschen",className:K,children:"Filter löschen"})}),e[48]=I,e[49]=K,e[50]=P):P=e[50];let U;return e[51]!==d||e[52]!==i||e[53]!==P||e[54]!==L?(U=t.jsxs("div",{className:"flex items-center w-full",children:[d,L,i,P]}),e[51]=d,e[52]=i,e[53]=P,e[54]=L,e[55]=U):U=e[55],U},Ae=()=>{const[x,e]=ie(),[n,z]=o.useState(x.get("tab")||"images"),[g,p]=o.useState(x.get("search")||""),[f,V]=o.useState(x.get("sortBy")||"createDate"),[F,G]=o.useState(x.get("gallerySortBy")||"title"),[m,E]=o.useState(x.get("sortOrder")||"desc"),[h,I]=o.useState(x.get("startDate")||""),[c,$]=o.useState(x.get("endDate")||""),[d,M]=o.useState(50),b=o.useRef(null),k=o.useRef(!1),T=te(g,300),j=te(h,300),y=te(c,300),{theme:L}=_();o.useEffect(()=>{const s=new URLSearchParams;n!=="images"&&s.set("tab",n),T&&s.set("search",T),f!=="createDate"&&s.set("sortBy",f),F!=="title"&&s.set("gallerySortBy",F),m!=="desc"&&s.set("sortOrder",m),j&&s.set("startDate",j),y&&s.set("endDate",y),e(s,{replace:!0}),M(50)},[n,T,f,F,m,j,y,e]);const O=()=>{p(""),V("createDate"),G("title"),E("desc"),I(""),$(""),M(50)},R=o.useMemo(()=>{const s=[];return W.forEach(l=>{l.images?.forEach((a,r)=>{s.push({...a,galleryTitle:l.title,gallerySlug:l.slug,index:r+1})})}),s},[]),u=o.useMemo(()=>{let s=R;if(g){const l=g.toLowerCase().split(" ").filter(Boolean);l.length>0&&(s=s.filter(a=>{const r=`${a.galleryTitle.toLowerCase()} ${a.filename?a.filename.toLowerCase():""}`;return l.every(i=>r.includes(i))}))}if(h){const l=new Date(h);l.setHours(0,0,0,0),s=s.filter(a=>{const r=B(a.createDate);return r&&r>=l})}if(c){const l=new Date(c);l.setHours(23,59,59,999),s=s.filter(a=>{const r=B(a.createDate);return r&&r<=l})}return[...s].sort((l,a)=>{const r=f==="createDate"?B(l.createDate):l.galleryTitle,i=f==="createDate"?B(a.createDate):a.galleryTitle;return r===null?1:i===null?-1:r<i?m==="asc"?-1:1:r>i?m==="asc"?1:-1:0})},[R,g,f,m,h,c]),A=o.useMemo(()=>u.slice(0,d),[u,d]),C=o.useCallback(s=>{const[l]=s;l.isIntersecting&&!k.current&&(k.current=!0,setTimeout(()=>{M(a=>{const r=a+50;return Math.min(r,u.length)}),k.current=!1},300))},[u.length]);o.useEffect(()=>{const s=new IntersectionObserver(C,{root:null,rootMargin:"0px",threshold:.1});return b.current&&s.observe(b.current),()=>{b.current&&s.unobserve(b.current)}},[C]);const S=o.useMemo(()=>{let s=W.map(l=>({...l,createDate:l.images?.[0]?.createDate}));if(g){const l=g.toLowerCase();s=s.filter(a=>{const r=a.title.toLowerCase().includes(l),i=a.images.some(K=>K.filename.toLowerCase().includes(l));return r||i})}if(h||c){const l=h?new Date(h):null;l&&l.setHours(0,0,0,0);const a=c?new Date(c):null;a&&a.setHours(23,59,59,999),s=s.filter(r=>R.filter(i=>{const K=B(i.createDate),P=h?new Date(h):null,U=c?new Date(c):null;return!(P&&K&&K<P||U&&K&&K>U)}).some(i=>i.gallerySlug===r.slug))}return[...s].sort((l,a)=>{const r=F==="createDate"?B(l.createDate):l.title,i=F==="createDate"?B(a.createDate):a.title;return r===null?1:i===null?-1:r<i?m==="asc"?-1:1:r>i?m==="asc"?1:-1:0})},[g,F,m,h,c]),N=o.useMemo(()=>{const s={};return W.forEach(l=>{l.images&&l.images.length>0?s[l.slug]=l.images[Math.floor(Math.random()*l.images.length)]:s[l.slug]=null}),s},[]),v=[{value:"createDate",label:"Datum"},{value:"galleryTitle",label:"Name"}],w=[{value:"title",label:"Name"},{value:"createDate",label:"Datum"}];return t.jsxs("div",{className:"p-4 md:px-8",children:[t.jsx(we,{title:`Liste aller Fotos und Fotoserien | ${D.meta.title}`,description:"Eine Liste aller Fotos und Fotoserien. Sortierbar und Filterbar.",imageUrl:`${D.url}${Z(W[0].slug,encodeURI(W[0].images[0].filename.replaceAll(" ","_")),640)}`}),t.jsxs("div",{className:`flex gap-4 ${D.theme.border.bottom}`,children:[t.jsx("button",{className:J(`${D.theme.headline.one} py-2 sm:py-4 ${n==="images"?_().theme==="dark"?`${D.theme.dark.text.primary}`:`${D.theme.light.text.primary}`:_().theme==="dark"?"text-white":"text-black"}`),onClick:()=>z("images"),children:"Fotos"}),t.jsx("button",{className:J(`${D.theme.headline.one} py-2 sm:py-4 ${n==="galleries"?_().theme==="dark"?`${D.theme.dark.text.primary}`:`${D.theme.light.text.primary}`:_().theme==="dark"?"text-white":"text-black"}`),onClick:()=>z("galleries"),children:"Serien"})]}),n==="images"&&t.jsxs("div",{className:"",children:[t.jsx(re,{className:`items-center ${D.theme.border.bottom} py-5 `,children:t.jsx(ne,{searchTerm:g,setSearchTerm:p,sortKey:f,setSortKey:V,sortOptions:v,sortOrder:m,setSortOrder:E,startDate:h,setStartDate:I,endDate:c,setEndDate:$,onClearFilters:O})}),t.jsxs("div",{className:"py-4 text-xs",children:[u.length," ",u.length===1?"Foto":"Fotos"," gefunden",d<u.length&&t.jsxs("span",{className:"ml-2 text-gray-500",children:["(Zeige ",d," von ",u.length,")"]})]}),t.jsxs("div",{className:"flex flex-col lg:flex-row lg:flex-wrap",children:[A.map(s=>t.jsx("div",{className:"w-full lg:w-1/2",children:t.jsxs("div",{className:"flex lg:flex-row items-center gap-4 py-2",children:[t.jsx(Y,{className:"block min-w-24 min-h-24 lg:w-24 lg:h-24 flex-shrink-0",to:`/gallery/${s.gallerySlug}/image/${ee(s.filename.replace(/\.[^/.]+$/,""))}`,children:t.jsx("img",{loading:"lazy",src:Z(s.gallerySlug,s.filename.replaceAll(" ","_"),160),alt:s.alt||`${s.galleryTitle} - ${s.filename}`,width:128,height:128,className:J(`${L==="dark"?"text-white bg-white/10":"text-black bg-black/10"} lg:w-24 lg:h-24 min-w-24 min-h-24 w-24 h-24 object-cover `)})}),t.jsxs("div",{className:"text-sm md:pr-4",children:[t.jsx(Y,{to:`/gallery/${s.gallerySlug}/image/${ee(s.filename.replace(/\.[^/.]+$/,""))}`,children:t.jsx("h3",{className:"truncate text-base",children:s.filename.replaceAll(".jpg","")})}),t.jsxs("div",{className:"flex items-center  space-x-2  flex-wrap",children:[t.jsxs("p",{className:"flex items-center gap-1 text-[11px] mt-1",children:[t.jsx(Fe,{size:12}),t.jsx(Q,{to:`/gallery/${s.gallerySlug}`,children:s.galleryTitle})]}),t.jsxs("p",{className:"flex items-center gap-1 text-[11px] mt-1",children:[t.jsx(ke,{size:12})," ",t.jsx(Q,{hasDecoration:!0,to:`/app/timeline?scrollTo=${B(s.createDate)?.toISOString().split("T")[0]}`,children:B(s.createDate)&&new Date(B(s.createDate)).toLocaleDateString("de-DE",{year:"numeric",month:"long",day:"numeric"})})]}),t.jsx("p",{className:"flex items-center gap-1 text-[11px] mt-1",children:s.latitude&&s.longitude?t.jsxs(t.Fragment,{children:[t.jsx(ae,{size:12}),t.jsx(Q,{target:"_self",className:"",href:`/app/map?gallery=${s.gallerySlug}&image=${ee(s.filename.replace(/\.[^/.]+$/,""))}`,children:`${s.latitude.toFixed(3)}, ${s.longitude.toFixed(3)}`})]}):t.jsxs(t.Fragment,{children:[t.jsx(ae,{size:12}),t.jsx("span",{className:"truncate",children:"N/A"})]})}),t.jsxs(Q,{className:"flex items-center gap-1 text-[11px] mt-1",href:Z(s.gallerySlug,s.filename.replaceAll(" ","_"),"original"),download:!0,children:[t.jsx(ye,{size:12}),t.jsx("span",{className:"",children:"Download"})]})]})]})]})},`${s.gallerySlug}-${s.filename}`)),d<u.length&&t.jsx("div",{ref:b,className:"w-full py-6 text-center text-xs text-neutral-500 font-mono",children:"Weitere Fotos werden geladen..."})]})]}),n==="galleries"&&t.jsxs("div",{children:[t.jsx(re,{className:`items-center  ${D.theme.border.bottom} py-5 `,children:t.jsx(ne,{searchTerm:g,setSearchTerm:p,sortKey:F,setSortKey:G,sortOptions:w,sortOrder:m,setSortOrder:E,startDate:h,setStartDate:I,endDate:c,setEndDate:$,onClearFilters:O})}),t.jsxs("div",{className:"py-4 text-xs",children:[S.length," ",S.length===1?"Fotoserie":"Fotoserien"," gefunden"]}),t.jsx("div",{className:"flex flex-col lg:flex-row lg:flex-wrap",children:S.map((s,l)=>{const a=N[s.slug];return t.jsxs("div",{className:"w-full lg:w-1/2",children:[t.jsxs(Y,{to:`/gallery/${s.slug}`,className:"flex lg:flex-row items-center gap-4 py-2",children:[a?t.jsx("img",{loading:"lazy",src:Z(s.slug,a.filename.replaceAll(" ","_"),160),alt:s.title,width:128,height:128,className:J(`${L==="dark"?"text-white bg-white/10":"text-black bg-black/10"} lg:w-24 lg:h-24 min-w-24 min-h-24 w-24 h-24 object-cover `)}):t.jsx("div",{className:"lg:w-24 lg:h-24 w-24 h-24 bg-gray-200 dark:bg-gray-700 flex items-center justify-center",children:t.jsx("span",{className:"text-xs text-gray-500",children:"Kein Bild"})}),t.jsxs("div",{className:"text-sm",children:[t.jsx("h3",{className:"truncate text-lg ",children:s.title}),t.jsxs("p",{className:"truncate text-xs",children:[s.images?.length||0," Bilder"]}),t.jsxs("p",{className:"truncate text-xs",children:["Datum: ",B(s.createDate)?.toLocaleDateString()||"N/V"]})]})]}),l<S.length-1&&""]},l)})})]})]})};export{Ae as default};
