import{d as S,c as _,u as U,g as R,r as M,b as T,j as e,L as A}from"./index-BaOktbzR.js";import{M as L,a as P}from"./scale-control-mSXj4UoL.js";import{C as c}from"./config-BUEk0qKv.js";import{c as p}from"./cn-CBfrqCZ4.js";import{I as q}from"./Image-C69AbVzx.js";import{g as o}from"./image-CpkqAB9L.js";import{s as I}from"./slugify-BCIJIR2V.js";import{p as C}from"./date-RcxNdlrM.js";import{C as z}from"./check-BnXLuOcU.js";import{H as $}from"./Href-C8gMVVO2.js";import{C as E}from"./chevron-right-3yb3yh4I.js";import"./mapbox-gl-CNTiHEyl.js";import"./index-DsbO3Yrj.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],B=S("copy",F),G=()=>{const r=_.c(10),{gallerySlug:a,slug:t}=U();let l;e:{if(!a||!t){l=void 0;break e}let s,d;if(r[0]!==a||r[1]!==t){let n;if(r[5]!==a?(n=g=>g.slug===a,r[5]=a,r[6]=n):n=r[6],s=R.find(n),!s){l=void 0;break e}d=s.images?.find(g=>{const w=g.filename.replace(/\.[^/.]+$/,"");return I(w)===t}),r[0]=a,r[1]=t,r[2]=s,r[3]=d,r[4]=l}else s=r[2],d=r[3],l=r[4];const m=d;if(m){let n;r[7]!==s||r[8]!==m?(n={image:m,gallery:s},r[7]=s,r[8]=m,r[9]=n):n=r[9],l=n;break e}l=void 0}return l},b=r=>{const a=_.c(16),{textToCopy:t,className:l,children:j,ariaLabel:s,iconToRight:d}=r,m=d===void 0?!1:d,[n,g]=M.useState(!1),{theme:w}=T();let x;a[0]!==t?(x=async()=>{try{await navigator.clipboard.writeText(t),g(!0),setTimeout(()=>g(!1),2e3)}catch(k){console.error("Failed to copy text: ",k)}},a[0]=t,a[1]=x):x=a[1];const i=x,u=`text-xs p-1 bg-transparent flex ${m?"flex-row-reverse":""} items-center gap-2`;let h;a[2]!==l||a[3]!==u?(h=p(u,l),a[2]=l,a[3]=u,a[4]=h):h=a[4];const v=s||"Kopieren";let y;a[5]!==n||a[6]!==w?(y=n?e.jsx(z,{size:16,strokeWidth:2,className:p("min-w-[16px] w-[16px] h-[16px] min-h-[16px]",w==="dark"?"text-red-300":"text-red-600")}):e.jsx(B,{className:p("min-w-[16px] w-[16px] h-[16px] min-h-[16px]",w==="dark"?"text-red-300":"text-red-600"),size:16}),a[5]=n,a[6]=w,a[7]=y):y=a[7];let f;a[8]!==j?(f=e.jsx("span",{children:j}),a[8]=j,a[9]=f):f=a[9];let N;return a[10]!==i||a[11]!==h||a[12]!==v||a[13]!==y||a[14]!==f?(N=e.jsxs("button",{onClick:i,className:h,"aria-label":v,children:[y,f]}),a[10]=i,a[11]=h,a[12]=v,a[13]=y,a[14]=f,a[15]=N):N=a[15],N},le=()=>{const{theme:r}=T(),a=G();if(M.useEffect(()=>{if(a){const{image:s,gallery:d}=a,m=document.createElement("script");m.type="application/ld+json",m.id="image-structured-data";const n={"@context":"https://schema.org","@type":"ImageObject",name:s.filename,description:s.alt||`A photo from the gallery: ${d.title}`,contentUrl:`${c.url}${o(d.slug,encodeURI(s.filename.replaceAll(" ","_")),"original")}`,author:{"@type":"Person",name:c.meta.title},...s.latitude&&s.longitude&&{location:{"@type":"Place",geo:{"@type":"GeoCoordinates",latitude:s.latitude,longitude:s.longitude},...s.googleMapsUrl&&{sameAs:s.googleMapsUrl}}}};return m.innerHTML=JSON.stringify(n),document.head.appendChild(m),()=>{const g=document.getElementById("image-structured-data");g&&document.head.removeChild(g)}}},[a]),!a)return e.jsx("div",{className:"py-10 text-left",children:"Bild nicht gefunden."});const{image:t,gallery:l}=a,j=M.useMemo(()=>{if(!a)return[];const{image:s,gallery:d}=a;let m=d.images.filter(x=>x.filename!==s.filename).map(x=>({...x,gallerySlug:d.slug}));if(m.length>=6)return m.slice(0,6);let n=[];if(s.latitude&&s.longitude){const x=(i,u,h,v)=>{const f=(h-i)*(Math.PI/180),N=(v-u)*(Math.PI/180),k=Math.sin(f/2)*Math.sin(f/2)+Math.cos(i*(Math.PI/180))*Math.cos(h*(Math.PI/180))*Math.sin(N/2)*Math.sin(N/2);return 6371*(2*Math.atan2(Math.sqrt(k),Math.sqrt(1-k)))};n=R.flatMap(i=>i.images.map(u=>({...u,gallerySlug:i.slug}))).filter(i=>i.filename!==s.filename&&i.latitude&&i.longitude).map(i=>({...i,distance:x(s.latitude,s.longitude,i.latitude,i.longitude)})).sort((i,u)=>i.distance-u.distance)}const g=[...m,...n];return Array.from(new Map(g.map(x=>[x.filename,x])).values()).slice(0,6)},[a]);return e.jsxs("div",{className:"w-full max-w-[var(--content-width)] p-4 md:p-8 flex flex-col items-center",children:[e.jsx("title",{children:`${t.filename.replace("_"," ").replace(".jpg","").trim()} | ${l.title} | ${c.meta.title}`}),e.jsx("meta",{name:"title",content:`${t.filename.replace("_"," ").replace(".jpg","").trim()} | ${l.title} | ${c.meta.title}`}),e.jsx("meta",{name:"description",content:`${t.alt||l.title}`}),e.jsx("meta",{name:"image",content:`${c.url}${o(l.slug,t.filename.replaceAll(" ","_"),640)}`}),e.jsx("meta",{name:"og:image",content:`${c.url}${o(l.slug,t.filename.replaceAll(" ","_"),640)}`}),e.jsx("meta",{name:"og:title",content:`${t.filename} | ${l.title} | ${c.meta.title}`}),e.jsx("meta",{name:"og:description",content:`${t.alt||l.title}`}),e.jsx("meta",{name:"og:url",content:`${c.url}${o(l.slug,t.filename.replaceAll(" ","_"),640)}`}),e.jsxs("div",{className:"w-full max-w-4xl flex flex-col gap-4",children:[e.jsx("div",{className:"flex items-center h-auto md:h-[80vh]",children:e.jsx(q,{src:o(l.slug,t.filename),alt:t.filename.replaceAll("_"," ").replace(".jpg","").trim(),width:t.width,height:t.height,sizes:"(max-width: 768px) 100vw, 1024px",className:"max-h-full h-full max-w-full object-contain"})}),e.jsxs("div",{className:"flex flex-col gap-0 w-full",children:[e.jsx("p",{className:"text-xs sr-only",children:"Fotoserie & Beschreibung"}),e.jsxs("h1",{className:p(" flex-grow-1 text-base md:text-base md:flex justify-between items-center gap-2 md:gap-4"),children:[e.jsxs("div",{className:"md:flex items-center justify-start gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:p(` flex-grow-1 flex items-center gap-4 underline  decoration-1 ${r==="dark"?"decoration-red-300 hover:text-red-300":"decoration-red-600 hover:text-red-600"} underline-offset-4`),to:`/gallery/${l.slug}`,children:e.jsx("span",{className:"md:truncate",children:l.title})}),e.jsx(E,{className:"w-4 h-4 hidden md:block"})]}),e.jsx("span",{className:"md:truncate flex-shrink-1",children:t.filename.replaceAll("_"," ").replace(".jpg","").trim()})]}),e.jsx(b,{className:"mt-2 md:mt-0 mr-2 min-h-4",iconToRight:!1,textToCopy:window.location.href,children:e.jsx("span",{className:"text-[11px]  truncate",children:"Kopieren"})})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row-reverse gap-8 mt-4 border-t border-neutral-500/50 pt-4 md:pt-8 border-dotted",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-base mb-2",children:"URLs"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[100px,1fr] gap-x-4 gap-y-3 text-sm",children:[e.jsx("div",{className:"text-[10px] uppercase tracking-wider",children:"Original"}),e.jsxs("div",{className:"flex items-center gap-2 font-mono",children:[e.jsx($,{href:o(l.slug,t.filename.replaceAll(" ","_"),"original"),hasDecoration:!1,className:p("truncate font-mono text-xs max-w-[calc(100%-40px)]"),children:`${c.url}${o(l.slug,encodeURI(t.filename.replaceAll(" ","_")),"original")}`}),e.jsx(b,{className:"",textToCopy:`${c.url}${o(l.slug,encodeURI(t.filename.replaceAll(" ","_")),"original")}`})]}),e.jsx("div",{className:"text-[10px] uppercase tracking-wider",children:"1440 px"}),e.jsxs("div",{className:"flex items-center gap-2 font-mono",children:[e.jsx($,{href:o(l.slug,t.filename.replaceAll(" ","_"),1440),hasDecoration:!1,className:p("truncate font-mono text-xs max-w-[calc(100%-40px)]"),children:`${c.url}${o(l.slug,encodeURI(t.filename.replaceAll(" ","_")),1440)}`}),e.jsx(b,{textToCopy:window.location.href})]}),e.jsx("div",{className:"text-[10px] uppercase tracking-wider",children:"640 px"}),e.jsxs("div",{className:"flex items-center gap-2 font-mono",children:[e.jsx($,{href:o(l.slug,t.filename.replaceAll(" ","_"),640),hasDecoration:!1,className:p("truncate font-mono text-xs max-w-[calc(100%-40px)]"),children:`${c.url}${o(l.slug,encodeURI(t.filename.replaceAll(" ","_")),640)}`}),e.jsx(b,{textToCopy:`${c.url}${o(l.slug,encodeURI(t.filename.replaceAll(" ","_")),640)}`})]}),e.jsx("div",{className:"text-[10px] uppercase tracking-wider",children:"380 px"}),e.jsxs("div",{className:"flex items-center gap-2 font-mono",children:[e.jsx($,{href:o(l.slug,t.filename.replaceAll(" ","_"),380),hasDecoration:!1,className:p("truncate font-mono text-xs max-w-[calc(100%-40px)]"),children:`${c.url}${o(l.slug,encodeURI(t.filename.replaceAll(" ","_")),380)}`}),e.jsx(b,{textToCopy:`${c.url}${o(l.slug,encodeURI(t.filename.replaceAll(" ","_")),380)}`})]}),t.createDate&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-base mt-4",children:"Datum & Uhrzeit"}),e.jsx(A,{to:`/app/timeline?scrollTo=${C(t.createDate).toISOString().split("T")[0]}`,className:p("text-xs underline underline-offset-4",r==="dark"?"hover:text-red-300 decoration-red-300":"hover:text-red-600 decoration-red-600"),children:new Date(C(t.createDate)).toLocaleDateString("de-DE",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]})]}),t.latitude&&t.longitude&&e.jsxs("div",{className:"flex-1 mb-8 md:mb-4",children:[e.jsx("h2",{className:"text-base mb-2",children:"Location"}),e.jsx("p",{className:"text-xs mb-2",children:`${t.latitude.toFixed(4)}, ${t.longitude.toFixed(4)}`}),e.jsx("div",{className:"border aspect-square w-full overflow-hidden",children:e.jsx(L,{initialViewState:{latitude:t.latitude,longitude:t.longitude,zoom:12},style:{width:"100%",height:"100%"},mapStyle:r==="dark"?c.mapbox.style.dark:c.mapbox.style.light,mapboxAccessToken:c.mapbox.accessToken,scrollZoom:!0,dragPan:!1,children:e.jsx(P,{longitude:t.longitude,latitude:t.latitude,children:e.jsx("div",{children:e.jsx("div",{className:p("w-4 h-4 border border-white",r==="dark"?"bg-red-300":"bg-red-600")})})})},t.filename)}),e.jsxs("div",{className:"flex flex-wrap space-y-2 space-x-4 gap-0 mt-2",children:[e.jsx(A,{to:`/app/map?image=${I(t.filename.replace(/\.[^/.]+$/,""))}&gallery=${l.slug}`,className:p("text-sm inline-block underline underline-offset-4 inline-block ",r==="dark"?"text-white decoration-red-300 hover:text-red-300 hover:decoration-red-300":"text-black decoration-red-500 hover:text-red-600"),children:"Auf der Karte anzeigen"}),e.jsx($,{className:"text-sm",href:`https://www.google.com/maps/search/?api=1&query=${t.latitude},${t.longitude}`,children:"Google Maps"}),e.jsx($,{className:"text-sm",href:`http://maps.apple.com/?q=${t.latitude},${t.longitude}`,children:"Apple Maps"})]})]})]})]})]}),j.length>0&&e.jsxs("div",{className:"w-full max-w-4xl mt-8 pt-8 border-t border-neutral-500/50 border-dotted",children:[e.jsx("h2",{className:"text-base mb-4",children:"Weitere Bilder"}),e.jsx("div",{className:"grid grid-cols-3 md:grid-cols-6 gap-4",children:j.map(s=>e.jsx(A,{to:`/gallery/${s.gallerySlug}/image/${I(s.filename.replace(/\.[^/.]+$/,""))}`,children:e.jsx("img",{src:o(s.gallerySlug,s.filename.replaceAll(" ","_"),380),alt:s.filename.replaceAll("_"," ").replace(".jpg","").trim(),width:380,height:380,sizes:"(max-width: 768px) 50vw, 20vw",className:"aspect-square object-cover w-full h-full"})},s.filename))})]})]})};export{le as default};
