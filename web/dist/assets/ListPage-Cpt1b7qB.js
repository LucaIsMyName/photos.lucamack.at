import{d as oe,c as se,r as u,b as q,j as t,e as me,g as Z,L as le,C as ae,f as de}from"./index-CedDT628.js";import{V as he,T as fe,I as ue,S as xe,a as ge,b as pe,c as be,d as je,P as we,C as Se,R as ye}from"./index-C8vTUQvY.js";import{p as A}from"./date-RcxNdlrM.js";import{C as z}from"./config-BUEk0qKv.js";import{c as re}from"./cn-CBfrqCZ4.js";import{g as ee}from"./image-CpkqAB9L.js";import{H as ne}from"./Href-BJbPczUn.js";import{D as Ne}from"./download-di7g3pdy.js";import"./mapbox-gl-CNTiHEyl.js";import"./index-9pdLW68f.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],De=oe("chevron-left",ve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ke=oe("chevron-right",$e),ce=x=>{const e=se.c(25),{children:n,className:T}=x,g=T===void 0?"":T,p=u.useRef(null),[h,E]=u.useState(!1),[N,G]=u.useState(!1),{theme:m}=q();let D;e[0]===Symbol.for("react.memo_cache_sentinel")?(D=c=>{const o=p.current;if(o){const w=o.clientWidth*.8;o.scrollBy({left:c==="left"?-w:w,behavior:"smooth"})}},e[0]=D):D=e[0];const d=D;let $;e[1]===Symbol.for("react.memo_cache_sentinel")?($=()=>{const c=()=>{const w=p.current;if(w){const{scrollLeft:O,scrollWidth:V,clientWidth:B}=w,M=O<=0,K=O>=V-B-1;E(!M),G(!K)}},o=p.current;if(o){c(),o.addEventListener("scroll",c);const w=new ResizeObserver(c);return w.observe(o),()=>{o.removeEventListener("scroll",c),w.unobserve(o)}}},e[1]=$):$=e[1];let i;e[2]!==n?(i=[n],e[2]=n,e[3]=i):i=e[3],u.useEffect($,i);const F=`flex items-center  w-full overflow-x-auto no-scrollbar py-2 ${g}`;let S;e[4]!==n||e[5]!==F?(S=t.jsx("div",{ref:p,className:F,children:n}),e[4]=n,e[5]=F,e[6]=S):S=e[6];const y=`absolute top-0 left-0 bottom-0 w-12 bg-gradient-to-r ${m==="light"?"from-white":"from-black"} to-transparent pointer-events-none transition-opacity duration-300 ${h?"opacity-100":"opacity-0"}`;let b;e[7]===Symbol.for("react.memo_cache_sentinel")?(b=()=>d("left"),e[7]=b):b=e[7];const v=`absolute top-1/2 -translate-y-1/2 left-0 ${m==="dark"?"text-white":"text-black"} pointer-events-auto`;let k;e[8]===Symbol.for("react.memo_cache_sentinel")?(k=t.jsx(De,{size:20}),e[8]=k):k=e[8];let j;e[9]!==v?(j=t.jsx("button",{onClick:b,className:v,children:k}),e[9]=v,e[10]=j):j=e[10];let f;e[11]!==j||e[12]!==y?(f=t.jsx("div",{className:y,children:j}),e[11]=j,e[12]=y,e[13]=f):f=e[13];const C=`absolute top-0 right-0 bottom-0 w-12 bg-gradient-to-l ${m==="light"?"from-white":"from-black"} to-transparent pointer-events-none transition-opacity duration-300 ${N?"opacity-100":"opacity-0"}`;let R;e[14]===Symbol.for("react.memo_cache_sentinel")?(R=()=>d("right"),e[14]=R):R=e[14];const L=`absolute top-1/2 -translate-y-1/2 right-0 ${m==="dark"?"text-white":"text-black"} pointer-events-auto`;let s;e[15]===Symbol.for("react.memo_cache_sentinel")?(s=t.jsx(ke,{size:20}),e[15]=s):s=e[15];let l;e[16]!==L?(l=t.jsx("button",{onClick:R,className:L,children:s}),e[16]=L,e[17]=l):l=e[17];let a;e[18]!==C||e[19]!==l?(a=t.jsx("div",{className:C,children:l}),e[18]=C,e[19]=l,e[20]=a):a=e[20];let r;return e[21]!==f||e[22]!==a||e[23]!==S?(r=t.jsxs("div",{className:"relative flex items-center w-full",children:[S,f,a]}),e[21]=f,e[22]=a,e[23]=S,e[24]=r):r=e[24],r};function te(x,e){const n=se.c(4),[T,g]=u.useState(x);let p,h;return n[0]!==e||n[1]!==x?(p=()=>{const E=setTimeout(()=>{g(x)},e);return()=>{clearTimeout(E)}},h=[x,e],n[0]=e,n[1]=x,n[2]=p,n[3]=h):(p=n[2],h=n[3]),u.useEffect(p,h),T}const ie=x=>{const e=se.c(61),{searchTerm:n,setSearchTerm:T,sortKey:g,setSortKey:p,sortOptions:h,sortOrder:E,setSortOrder:N,startDate:G,setStartDate:m,endDate:D,setEndDate:d,onClearFilters:$}=x,{theme:i}=q(),F=i==="dark"?"border-white":"border-black",S=`flex-shrink-0 p-2 border-r ${F}`;let y;e[0]!==T?(y=I=>T(I.target.value),e[0]=T,e[1]=y):y=e[1];let b;e[2]!==n||e[3]!==y?(b=t.jsx("input",{type:"text",placeholder:"Suchen...",value:n,onChange:y,className:"bg-transparent focus:outline-none w-48"}),e[2]=n,e[3]=y,e[4]=b):b=e[4];let v;e[5]!==S||e[6]!==b?(v=t.jsx("div",{className:S,children:b}),e[5]=S,e[6]=b,e[7]=v):v=e[7];const k=`flex-shrink-0 flex items-center gap-4 p-2 px-4 border-r ${F}`;let j;e[8]===Symbol.for("react.memo_cache_sentinel")?(j=t.jsx("span",{className:"whitespace-nowrap",children:"Filter von"}),e[8]=j):j=e[8];let f;e[9]!==m?(f=I=>m(I.target.value),e[9]=m,e[10]=f):f=e[10];let C;e[11]!==G||e[12]!==f?(C=t.jsx("input",{type:"date",value:G,onChange:f,className:"bg-transparent focus:outline-none uppercase"}),e[11]=G,e[12]=f,e[13]=C):C=e[13];let R;e[14]===Symbol.for("react.memo_cache_sentinel")?(R=t.jsx("span",{children:"bis"}),e[14]=R):R=e[14];let L;e[15]!==d?(L=I=>d(I.target.value),e[15]=d,e[16]=L):L=e[16];let s;e[17]!==D||e[18]!==L?(s=t.jsx("input",{type:"date",value:D,onChange:L,className:"bg-transparent focus:outline-none uppercase"}),e[17]=D,e[18]=L,e[19]=s):s=e[19];let l;e[20]!==s||e[21]!==k||e[22]!==C?(l=t.jsxs("div",{className:k,children:[j,C,R,s]}),e[20]=s,e[21]=k,e[22]=C,e[23]=l):l=e[23];const a=`flex-shrink-0 flex items-center gap-4 p-2 px-4 border-r ${F}`;let r;e[24]===Symbol.for("react.memo_cache_sentinel")?(r=t.jsx("span",{className:"whitespace-nowrap",children:"Sortieren nach"}),e[24]=r):r=e[24];let c;e[25]===Symbol.for("react.memo_cache_sentinel")?(c=t.jsx(he,{}),e[25]=c):c=e[25];let o;e[26]===Symbol.for("react.memo_cache_sentinel")?(o=t.jsxs(fe,{className:"inline-flex items-center justify-center gap-2 bg-transparent focus:outline-none",children:[c,t.jsx(ue,{children:t.jsx(ae,{size:16})})]}),e[26]=o):o=e[26];const w=`overflow-hidden ${i==="dark"?"bg-black text-white border-white":"bg-white text-black border-black"} border`;let O;e[27]===Symbol.for("react.memo_cache_sentinel")?(O=t.jsx(xe,{className:"flex items-center justify-center h-6 cursor-default",children:t.jsx(de,{})}),e[27]=O):O=e[27];let V;if(e[28]!==h||e[29]!==i){let I;e[31]!==i?(I=Y=>t.jsx(ge,{value:Y.value,className:`text-sm leading-none flex items-center h-6 pr-8 pl-6 relative select-none data-[highlighted]:outline-none ${i==="dark"?"data-[highlighted]:bg-red-300 data-[highlighted]:text-black":"data-[highlighted]:bg-red-600 data-[highlighted]:text-white"}`,children:t.jsx(pe,{children:Y.label})},Y.value),e[31]=i,e[32]=I):I=e[32],V=h.map(I),e[28]=h,e[29]=i,e[30]=V}else V=e[30];let B;e[33]!==V?(B=t.jsx(be,{className:"p-1",children:V}),e[33]=V,e[34]=B):B=e[34];let M;e[35]===Symbol.for("react.memo_cache_sentinel")?(M=t.jsx(je,{className:"flex items-center justify-center h-6 cursor-default",children:t.jsx(ae,{})}),e[35]=M):M=e[35];let K;e[36]!==w||e[37]!==B?(K=t.jsx(we,{children:t.jsxs(Se,{className:w,children:[O,B,M]})}),e[36]=w,e[37]=B,e[38]=K):K=e[38];let P;e[39]!==p||e[40]!==g||e[41]!==K?(P=t.jsxs(ye,{value:g,onValueChange:p,children:[o,K]}),e[39]=p,e[40]=g,e[41]=K,e[42]=P):P=e[42];let _;e[43]!==N||e[44]!==E?(_=()=>N(E==="asc"?"desc":"asc"),e[43]=N,e[44]=E,e[45]=_):_=e[45];const Q=E==="asc"?"(Aufsteigend)":"(Absteigend)";let H;e[46]!==_||e[47]!==Q?(H=t.jsx("button",{onClick:_,className:"whitespace-nowrap",children:Q}),e[46]=_,e[47]=Q,e[48]=H):H=e[48];let U;e[49]!==a||e[50]!==P||e[51]!==H?(U=t.jsxs("div",{className:a,children:[r,P,H]}),e[49]=a,e[50]=P,e[51]=H,e[52]=U):U=e[52];const X=`${i==="dark"?"text-red-300":"text-red-600"} underline underline-offset-4 whitespace-nowrap hover:underline`;let W;e[53]!==$||e[54]!==X?(W=t.jsx("div",{className:"flex-shrink-0 p-2 px-4",children:t.jsx("button",{onClick:$,className:X,children:"Filter löschen"})}),e[53]=$,e[54]=X,e[55]=W):W=e[55];let J;return e[56]!==l||e[57]!==U||e[58]!==W||e[59]!==v?(J=t.jsxs("div",{className:"flex items-center w-full",children:[v,l,U,W]}),e[56]=l,e[57]=U,e[58]=W,e[59]=v,e[60]=J):J=e[60],J},Ve=()=>{const[x,e]=me(),[n,T]=u.useState(x.get("tab")||"images"),[g,p]=u.useState(x.get("search")||""),[h,E]=u.useState(x.get("sortBy")||"createDate"),[N,G]=u.useState(x.get("gallerySortBy")||"title"),[m,D]=u.useState(x.get("sortOrder")||"desc"),[d,$]=u.useState(x.get("startDate")||""),[i,F]=u.useState(x.get("endDate")||""),S=te(g,300),y=te(d,300),b=te(i,300);u.useEffect(()=>{const s=new URLSearchParams;n!=="images"&&s.set("tab",n),S&&s.set("search",S),h!=="createDate"&&s.set("sortBy",h),N!=="title"&&s.set("gallerySortBy",N),m!=="desc"&&s.set("sortOrder",m),y&&s.set("startDate",y),b&&s.set("endDate",b),e(s,{replace:!0})},[n,S,h,N,m,y,b,e]);const v=()=>{p(""),E("createDate"),G("title"),D("desc"),$(""),F("")},k=u.useMemo(()=>{const s=[];return Z.forEach(l=>{l.images?.forEach((a,r)=>{s.push({...a,galleryTitle:l.title,gallerySlug:l.slug,index:r+1})})}),s},[]),j=u.useMemo(()=>{let s=k;if(g){const l=g.toLowerCase().split(" ").filter(Boolean);l.length>0&&(s=s.filter(a=>{const r=`${a.galleryTitle.toLowerCase()} ${a.filename?a.filename.toLowerCase():""}`;return l.every(c=>r.includes(c))}))}if(d){const l=new Date(d);l.setHours(0,0,0,0),s=s.filter(a=>{const r=A(a.createDate);return r&&r>=l})}if(i){const l=new Date(i);l.setHours(23,59,59,999),s=s.filter(a=>{const r=A(a.createDate);return r&&r<=l})}return[...s].sort((l,a)=>{const r=h==="createDate"?A(l.createDate):l.galleryTitle,c=h==="createDate"?A(a.createDate):a.galleryTitle;return r===null?1:c===null?-1:r<c?m==="asc"?-1:1:r>c?m==="asc"?1:-1:0})},[k,g,h,m,d,i]),f=u.useMemo(()=>{let s=Z.map(l=>({...l,createDate:l.images?.[0]?.createDate}));if(g){const l=g.toLowerCase();s=s.filter(a=>{const r=a.title.toLowerCase().includes(l),c=a.images.some(o=>o.filename.toLowerCase().includes(l));return r||c})}if(d||i){const l=d?new Date(d):null;l&&l.setHours(0,0,0,0);const a=i?new Date(i):null;a&&a.setHours(23,59,59,999),s=s.filter(r=>k.filter(c=>{const o=A(c.createDate),w=d?new Date(d):null,O=i?new Date(i):null;return!(w&&o&&o<w||O&&o&&o>O)}).some(c=>c.gallerySlug===r.slug))}return[...s].sort((l,a)=>{const r=N==="createDate"?A(l.createDate):l.title,c=N==="createDate"?A(a.createDate):a.title;return r===null?1:c===null?-1:r<c?m==="asc"?-1:1:r>c?m==="asc"?1:-1:0})},[g,N,m,d,i]),C=u.useMemo(()=>{const s={};return Z.forEach(l=>{l.images&&l.images.length>0?s[l.slug]=l.images[Math.floor(Math.random()*l.images.length)]:s[l.slug]=null}),s},[]),R=[{value:"createDate",label:"Datum"},{value:"galleryTitle",label:"Name"}],L=[{value:"title",label:"Name"},{value:"createDate",label:"Datum"}];return t.jsxs("div",{className:"p-4 md:pl-0",children:[t.jsx("title",{children:`Liste aller Fotos und Galerien | ${z.meta.title}`}),t.jsx("meta",{name:"title",content:`Liste aller Fotos und Galerien | ${z.meta.title}`}),t.jsx("meta",{name:"description",content:"Eine Liste aller Fotos und Galerien. Sortierbar und Filterbar."}),t.jsxs("div",{className:"flex gap-4 border-b",children:[t.jsx("button",{className:re(`${z.theme.headline.one} py-2 sm:py-4 ${n==="images"?q().theme==="dark"?`${z.theme.dark.text.primary}`:`${z.theme.light.text.primary}`:q().theme==="dark"?"text-white":"text-black"}`),onClick:()=>T("images"),children:"Fotos"}),t.jsx("button",{className:re(`${z.theme.headline.one} py-2 sm:py-4 ${n==="galleries"?q().theme==="dark"?`${z.theme.dark.text.primary}`:`${z.theme.light.text.primary}`:q().theme==="dark"?"text-white":"text-black"}`),onClick:()=>T("galleries"),children:"Serien"})]}),n==="images"&&t.jsxs("div",{className:"",children:[t.jsx(ce,{className:"items-center border-b py-5 ",children:t.jsx(ie,{searchTerm:g,setSearchTerm:p,sortKey:h,setSortKey:E,sortOptions:R,sortOrder:m,setSortOrder:D,startDate:d,setStartDate:$,endDate:i,setEndDate:F,onClearFilters:v})}),t.jsxs("div",{className:"py-4 text-xs",children:[j.length," ",j.length===1?"Foto":"Fotos"," gefunden"]}),t.jsx("div",{className:"flex flex-col lg:flex-row lg:flex-wrap",children:j.map(s=>t.jsx("div",{className:"w-full lg:w-1/2",children:t.jsxs("div",{className:"flex lg:flex-row items-center gap-4 py-2",children:[t.jsx(le,{to:`/image/${encodeURI(s.filename.replace(/\.[^/.]+$/,""))}`,children:t.jsx("img",{loading:"lazy",src:ee(s.gallerySlug,s.filename.replaceAll(" ","_"),380),alt:s.alt||`${s.galleryTitle} - ${s.filename}`,width:128,height:128,className:"min-w-24 w-24 min-h-24 h-24 lg:w-24 lg:h-24 object-cover aspect-square"})}),t.jsxs("div",{className:"text-sm",children:[t.jsx("h3",{className:"truncate text-base",children:s.filename.replaceAll(".jpg","")}),t.jsxs("p",{className:"truncate text-xs",children:["Erstellt: ",A(s.createDate)?.toLocaleString()||"Ungültiges Datum"]}),s.latitude&&s.longitude?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"text-xs",children:"Koordinaten: "}),t.jsx(ne,{target:"_self",className:"text-xs",href:`/app/map?gallery=${s.gallerySlug}&image=${encodeURI(s.filename)}`,children:`${s.latitude.toFixed(4)}, ${s.longitude.toFixed(4)}`})]}):t.jsx("p",{className:"truncate",children:"Koordinaten: N/V"}),t.jsxs(ne,{className:"flex items-center gap-1 text-xs",href:ee(s.gallerySlug,s.filename.replaceAll(" ","_"),"original"),download:!0,children:[t.jsx(Ne,{size:12}),t.jsx("span",{className:"",children:"Download Foto"})]})]})]})},`${s.gallerySlug}-${s.filename}`))})]}),n==="galleries"&&t.jsxs("div",{children:[t.jsx(ce,{className:"items-center border-b py-5 ",children:t.jsx(ie,{searchTerm:g,setSearchTerm:p,sortKey:N,setSortKey:G,sortOptions:L,sortOrder:m,setSortOrder:D,startDate:d,setStartDate:$,endDate:i,setEndDate:F,onClearFilters:v})}),t.jsxs("div",{className:"py-4 text-xs",children:[f.length," ",f.length===1?"Galerie":"Galerien"," gefunden"]}),t.jsx("div",{className:"flex flex-col lg:flex-row lg:flex-wrap",children:f.map((s,l)=>{const a=C[s.slug];return t.jsxs("div",{className:"w-full lg:w-1/2",children:[t.jsxs(le,{to:`/gallery/${s.slug}`,className:"flex lg:flex-row items-center gap-4 py-2",children:[a?t.jsx("img",{loading:"lazy",src:ee(s.slug,a.filename.replaceAll(" ","_"),380),alt:s.title,width:128,height:128,className:"lg:w-24 lg:h-24 min-w-24 min-h-24 w-24 h-24 object-cover "}):t.jsx("div",{className:"lg:w-24 lg:h-24 w-24 h-24 bg-gray-200 dark:bg-gray-700 flex items-center justify-center",children:t.jsx("span",{className:"text-xs text-gray-500",children:"Kein Bild"})}),t.jsxs("div",{className:"text-sm",children:[t.jsx("h3",{className:"truncate text-lg ",children:s.title}),t.jsxs("p",{className:"truncate",children:[s.images?.length||0," Bilder"]}),t.jsxs("p",{className:"truncate",children:["Erstellt: ",A(s.createDate)?.toLocaleDateString()||"N/V"]})]})]}),l<f.length-1&&""]},l)})})]})]})};export{Ve as default};
