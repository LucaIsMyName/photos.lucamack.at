import{d as ne,c as ce,r as f,b as K,j as t,e as he,g as ee,L as te,C as ie,f as fe}from"./index-CGS2EipM.js";import{V as ue,T as xe,I as ge,S as pe,a as be,b as je,c as we,d as ye,P as Se,C as Ne,R as ve}from"./index-Cp0JZ2mc.js";import{p as G}from"./date-1H0cpUAF.js";import{C as V}from"./config-BUEk0qKv.js";import{c as Q}from"./cn-CBfrqCZ4.js";import{g as se}from"./image-CpkqAB9L.js";import{H as le}from"./Href-s6uGxWD3.js";import{s as ae}from"./slugify-BCIJIR2V.js";import{M as oe}from"./map-pin-3a0-szQd.js";import{D as De}from"./download-CGWqnGzh.js";import"./mapbox-gl-CNTiHEyl.js";import"./index-CLKfy1Qt.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],$e=ne("chevron-left",ke);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Le=ne("chevron-right",Ce);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ee=ne("clock",Te),me=u=>{const e=ce.c(25),{children:c,className:L}=u,x=L===void 0?"":L,g=f.useRef(null),[h,T]=f.useState(!1),[N,I]=f.useState(!1),{theme:o}=K();let k;e[0]===Symbol.for("react.memo_cache_sentinel")?(k=r=>{const n=g.current;if(n){const d=n.clientWidth*.8;n.scrollBy({left:r==="left"?-d:d,behavior:"smooth"})}},e[0]=k):k=e[0];const m=k;let $;e[1]===Symbol.for("react.memo_cache_sentinel")?($=()=>{const r=()=>{const d=g.current;if(d){const{scrollLeft:R,scrollWidth:A,clientWidth:M}=d,P=R<=0,B=R>=A-M-1;T(!P),I(!B)}},n=g.current;if(n){r(),n.addEventListener("scroll",r);const d=new ResizeObserver(r);return d.observe(n),()=>{n.removeEventListener("scroll",r),d.unobserve(n)}}},e[1]=$):$=e[1];let i;e[2]!==c?(i=[c],e[2]=c,e[3]=i):i=e[3],f.useEffect($,i);const E=`flex items-center  w-full overflow-x-auto no-scrollbar py-2 ${x}`;let y;e[4]!==c||e[5]!==E?(y=t.jsx("div",{ref:g,className:E,children:c}),e[4]=c,e[5]=E,e[6]=y):y=e[6];const S=`absolute top-0 left-0 bottom-0 w-12 bg-gradient-to-r ${o==="light"?"from-white":"from-black"} to-transparent pointer-events-none transition-opacity duration-300 ${h?"opacity-100":"opacity-0"}`;let b;e[7]===Symbol.for("react.memo_cache_sentinel")?(b=()=>m("left"),e[7]=b):b=e[7];const v=`absolute top-1/2 -translate-y-1/2 left-0 ${o==="dark"?"text-white":"text-black"} pointer-events-auto`;let F;e[8]===Symbol.for("react.memo_cache_sentinel")?(F=t.jsx($e,{size:20}),e[8]=F):F=e[8];let j;e[9]!==v?(j=t.jsx("button",{onClick:b,className:v,children:F}),e[9]=v,e[10]=j):j=e[10];let p;e[11]!==j||e[12]!==S?(p=t.jsx("div",{className:S,children:j}),e[11]=j,e[12]=S,e[13]=p):p=e[13];const w=`absolute top-0 right-0 bottom-0 w-12 bg-gradient-to-l ${o==="light"?"from-white":"from-black"} to-transparent pointer-events-none transition-opacity duration-300 ${N?"opacity-100":"opacity-0"}`;let O;e[14]===Symbol.for("react.memo_cache_sentinel")?(O=()=>m("right"),e[14]=O):O=e[14];const C=`absolute top-1/2 -translate-y-1/2 right-0 ${o==="dark"?"text-white":"text-black"} pointer-events-auto`;let D;e[15]===Symbol.for("react.memo_cache_sentinel")?(D=t.jsx(Le,{size:20}),e[15]=D):D=e[15];let s;e[16]!==C?(s=t.jsx("button",{onClick:O,className:C,children:D}),e[16]=C,e[17]=s):s=e[17];let l;e[18]!==w||e[19]!==s?(l=t.jsx("div",{className:w,children:s}),e[18]=w,e[19]=s,e[20]=l):l=e[20];let a;return e[21]!==p||e[22]!==l||e[23]!==y?(a=t.jsxs("div",{className:"relative flex items-center w-full",children:[y,p,l]}),e[21]=p,e[22]=l,e[23]=y,e[24]=a):a=e[24],a};function re(u,e){const c=ce.c(4),[L,x]=f.useState(u);let g,h;return c[0]!==e||c[1]!==u?(g=()=>{const T=setTimeout(()=>{x(u)},e);return()=>{clearTimeout(T)}},h=[u,e],c[0]=e,c[1]=u,c[2]=g,c[3]=h):(g=c[2],h=c[3]),f.useEffect(g,h),L}const de=u=>{const e=ce.c(61),{searchTerm:c,setSearchTerm:L,sortKey:x,setSortKey:g,sortOptions:h,sortOrder:T,setSortOrder:N,startDate:I,setStartDate:o,endDate:k,setEndDate:m,onClearFilters:$}=u,{theme:i}=K(),E=i==="dark"?"border-white":"border-black",y=`flex-shrink-0 p-2 border-r ${E}`;let S;e[0]!==L?(S=z=>L(z.target.value),e[0]=L,e[1]=S):S=e[1];let b;e[2]!==c||e[3]!==S?(b=t.jsx("input",{type:"text",placeholder:"Suchen...",value:c,onChange:S,className:"bg-transparent focus:outline-none w-48"}),e[2]=c,e[3]=S,e[4]=b):b=e[4];let v;e[5]!==y||e[6]!==b?(v=t.jsx("div",{className:y,children:b}),e[5]=y,e[6]=b,e[7]=v):v=e[7];const F=`flex-shrink-0 flex items-center gap-4 p-2 px-4 border-r ${E}`;let j;e[8]===Symbol.for("react.memo_cache_sentinel")?(j=t.jsx("span",{className:"whitespace-nowrap",children:"Filter von"}),e[8]=j):j=e[8];let p;e[9]!==o?(p=z=>o(z.target.value),e[9]=o,e[10]=p):p=e[10];let w;e[11]!==I||e[12]!==p?(w=t.jsx("input",{type:"date",value:I,onChange:p,className:"bg-transparent focus:outline-none uppercase"}),e[11]=I,e[12]=p,e[13]=w):w=e[13];let O;e[14]===Symbol.for("react.memo_cache_sentinel")?(O=t.jsx("span",{children:"bis"}),e[14]=O):O=e[14];let C;e[15]!==m?(C=z=>m(z.target.value),e[15]=m,e[16]=C):C=e[16];let D;e[17]!==k||e[18]!==C?(D=t.jsx("input",{type:"date",value:k,onChange:C,className:"bg-transparent focus:outline-none uppercase"}),e[17]=k,e[18]=C,e[19]=D):D=e[19];let s;e[20]!==D||e[21]!==F||e[22]!==w?(s=t.jsxs("div",{className:F,children:[j,w,O,D]}),e[20]=D,e[21]=F,e[22]=w,e[23]=s):s=e[23];const l=`flex-shrink-0 flex items-center gap-4 p-2 px-4 border-r ${E}`;let a;e[24]===Symbol.for("react.memo_cache_sentinel")?(a=t.jsx("span",{className:"whitespace-nowrap",children:"Sortieren nach"}),e[24]=a):a=e[24];let r;e[25]===Symbol.for("react.memo_cache_sentinel")?(r=t.jsx(ue,{}),e[25]=r):r=e[25];let n;e[26]===Symbol.for("react.memo_cache_sentinel")?(n=t.jsxs(xe,{className:"inline-flex items-center justify-center gap-2 bg-transparent focus:outline-none",children:[r,t.jsx(ge,{children:t.jsx(ie,{size:16})})]}),e[26]=n):n=e[26];const d=`overflow-hidden ${i==="dark"?"bg-black text-white border-white":"bg-white text-black border-black"} border`;let R;e[27]===Symbol.for("react.memo_cache_sentinel")?(R=t.jsx(pe,{className:"flex items-center justify-center h-6 cursor-default",children:t.jsx(fe,{})}),e[27]=R):R=e[27];let A;if(e[28]!==h||e[29]!==i){let z;e[31]!==i?(z=Z=>t.jsx(be,{value:Z.value,className:`text-sm leading-none flex items-center h-6 pr-8 pl-6 relative select-none data-[highlighted]:outline-none ${i==="dark"?"data-[highlighted]:bg-red-300 data-[highlighted]:text-black":"data-[highlighted]:bg-red-600 data-[highlighted]:text-white"}`,children:t.jsx(je,{children:Z.label})},Z.value),e[31]=i,e[32]=z):z=e[32],A=h.map(z),e[28]=h,e[29]=i,e[30]=A}else A=e[30];let M;e[33]!==A?(M=t.jsx(we,{className:"p-1",children:A}),e[33]=A,e[34]=M):M=e[34];let P;e[35]===Symbol.for("react.memo_cache_sentinel")?(P=t.jsx(ye,{className:"flex items-center justify-center h-6 cursor-default",children:t.jsx(ie,{})}),e[35]=P):P=e[35];let B;e[36]!==d||e[37]!==M?(B=t.jsx(Se,{children:t.jsxs(Ne,{className:d,children:[R,M,P]})}),e[36]=d,e[37]=M,e[38]=B):B=e[38];let H;e[39]!==g||e[40]!==x||e[41]!==B?(H=t.jsxs(ve,{value:x,onValueChange:g,children:[n,B]}),e[39]=g,e[40]=x,e[41]=B,e[42]=H):H=e[42];let _;e[43]!==N||e[44]!==T?(_=()=>N(T==="asc"?"desc":"asc"),e[43]=N,e[44]=T,e[45]=_):_=e[45];const X=T==="asc"?"(Aufsteigend)":"(Absteigend)";let U;e[46]!==_||e[47]!==X?(U=t.jsx("button",{onClick:_,className:"whitespace-nowrap",children:X}),e[46]=_,e[47]=X,e[48]=U):U=e[48];let W;e[49]!==l||e[50]!==H||e[51]!==U?(W=t.jsxs("div",{className:l,children:[a,H,U]}),e[49]=l,e[50]=H,e[51]=U,e[52]=W):W=e[52];const Y=`${i==="dark"?"text-red-300":"text-red-600"} underline underline-offset-4 whitespace-nowrap hover:underline`;let q;e[53]!==$||e[54]!==Y?(q=t.jsx("div",{className:"flex-shrink-0 p-2 px-4",children:t.jsx("button",{onClick:$,className:Y,children:"Filter löschen"})}),e[53]=$,e[54]=Y,e[55]=q):q=e[55];let J;return e[56]!==s||e[57]!==W||e[58]!==q||e[59]!==v?(J=t.jsxs("div",{className:"flex items-center w-full",children:[v,s,W,q]}),e[56]=s,e[57]=W,e[58]=q,e[59]=v,e[60]=J):J=e[60],J},He=()=>{const[u,e]=he(),[c,L]=f.useState(u.get("tab")||"images"),[x,g]=f.useState(u.get("search")||""),[h,T]=f.useState(u.get("sortBy")||"createDate"),[N,I]=f.useState(u.get("gallerySortBy")||"title"),[o,k]=f.useState(u.get("sortOrder")||"desc"),[m,$]=f.useState(u.get("startDate")||""),[i,E]=f.useState(u.get("endDate")||""),y=re(x,300),S=re(m,300),b=re(i,300),{theme:v}=K();f.useEffect(()=>{const s=new URLSearchParams;c!=="images"&&s.set("tab",c),y&&s.set("search",y),h!=="createDate"&&s.set("sortBy",h),N!=="title"&&s.set("gallerySortBy",N),o!=="desc"&&s.set("sortOrder",o),S&&s.set("startDate",S),b&&s.set("endDate",b),e(s,{replace:!0})},[c,y,h,N,o,S,b,e]);const F=()=>{g(""),T("createDate"),I("title"),k("desc"),$(""),E("")},j=f.useMemo(()=>{const s=[];return ee.forEach(l=>{l.images?.forEach((a,r)=>{s.push({...a,galleryTitle:l.title,gallerySlug:l.slug,index:r+1})})}),s},[]),p=f.useMemo(()=>{let s=j;if(x){const l=x.toLowerCase().split(" ").filter(Boolean);l.length>0&&(s=s.filter(a=>{const r=`${a.galleryTitle.toLowerCase()} ${a.filename?a.filename.toLowerCase():""}`;return l.every(n=>r.includes(n))}))}if(m){const l=new Date(m);l.setHours(0,0,0,0),s=s.filter(a=>{const r=G(a.createDate);return r&&r>=l})}if(i){const l=new Date(i);l.setHours(23,59,59,999),s=s.filter(a=>{const r=G(a.createDate);return r&&r<=l})}return[...s].sort((l,a)=>{const r=h==="createDate"?G(l.createDate):l.galleryTitle,n=h==="createDate"?G(a.createDate):a.galleryTitle;return r===null?1:n===null?-1:r<n?o==="asc"?-1:1:r>n?o==="asc"?1:-1:0})},[j,x,h,o,m,i]),w=f.useMemo(()=>{let s=ee.map(l=>({...l,createDate:l.images?.[0]?.createDate}));if(x){const l=x.toLowerCase();s=s.filter(a=>{const r=a.title.toLowerCase().includes(l),n=a.images.some(d=>d.filename.toLowerCase().includes(l));return r||n})}if(m||i){const l=m?new Date(m):null;l&&l.setHours(0,0,0,0);const a=i?new Date(i):null;a&&a.setHours(23,59,59,999),s=s.filter(r=>j.filter(n=>{const d=G(n.createDate),R=m?new Date(m):null,A=i?new Date(i):null;return!(R&&d&&d<R||A&&d&&d>A)}).some(n=>n.gallerySlug===r.slug))}return[...s].sort((l,a)=>{const r=N==="createDate"?G(l.createDate):l.title,n=N==="createDate"?G(a.createDate):a.title;return r===null?1:n===null?-1:r<n?o==="asc"?-1:1:r>n?o==="asc"?1:-1:0})},[x,N,o,m,i]),O=f.useMemo(()=>{const s={};return ee.forEach(l=>{l.images&&l.images.length>0?s[l.slug]=l.images[Math.floor(Math.random()*l.images.length)]:s[l.slug]=null}),s},[]),C=[{value:"createDate",label:"Datum"},{value:"galleryTitle",label:"Name"}],D=[{value:"title",label:"Name"},{value:"createDate",label:"Datum"}];return t.jsxs("div",{className:"p-4 md:pl-0",children:[t.jsx("title",{children:`Liste aller Fotos und Galerien | ${V.meta.title}`}),t.jsx("meta",{name:"title",content:`Liste aller Fotos und Galerien | ${V.meta.title}`}),t.jsx("meta",{name:"description",content:"Eine Liste aller Fotos und Galerien. Sortierbar und Filterbar."}),t.jsxs("div",{className:"flex gap-4 border-b",children:[t.jsx("button",{className:Q(`${V.theme.headline.one} py-2 sm:py-4 ${c==="images"?K().theme==="dark"?`${V.theme.dark.text.primary}`:`${V.theme.light.text.primary}`:K().theme==="dark"?"text-white":"text-black"}`),onClick:()=>L("images"),children:"Fotos"}),t.jsx("button",{className:Q(`${V.theme.headline.one} py-2 sm:py-4 ${c==="galleries"?K().theme==="dark"?`${V.theme.dark.text.primary}`:`${V.theme.light.text.primary}`:K().theme==="dark"?"text-white":"text-black"}`),onClick:()=>L("galleries"),children:"Serien"})]}),c==="images"&&t.jsxs("div",{className:"",children:[t.jsx(me,{className:"items-center border-b py-5 ",children:t.jsx(de,{searchTerm:x,setSearchTerm:g,sortKey:h,setSortKey:T,sortOptions:C,sortOrder:o,setSortOrder:k,startDate:m,setStartDate:$,endDate:i,setEndDate:E,onClearFilters:F})}),t.jsxs("div",{className:"py-4 text-xs",children:[p.length," ",p.length===1?"Foto":"Fotos"," gefunden"]}),t.jsx("div",{className:"flex flex-col lg:flex-row lg:flex-wrap",children:p.map(s=>t.jsx("div",{className:"w-full lg:w-1/2",children:t.jsxs("div",{className:"flex lg:flex-row items-center gap-4 py-2",children:[t.jsx(te,{className:"block min-w-24 min-h-24 lg:w-24 lg:h-24 flex-shrink-0",to:`/gallery/${s.gallerySlug}/image/${ae(s.filename.replace(/\.[^/.]+$/,""))}`,children:t.jsx("img",{loading:"lazy",src:se(s.gallerySlug,s.filename.replaceAll(" ","_"),160),alt:s.alt||`${s.galleryTitle} - ${s.filename}`,width:128,height:128,className:Q(`${v==="dark"?"text-white bg-white/10":"text-black bg-black/10"} lg:w-24 lg:h-24 min-w-24 min-h-24 w-24 h-24 object-cover `)})}),t.jsxs("div",{className:"text-sm md:pr-4",children:[t.jsx(te,{to:`/gallery/${s.gallerySlug}/image/${ae(s.filename.replace(/\.[^/.]+$/,""))}`,children:t.jsx("h3",{className:"truncate text-base",children:s.filename.replaceAll(".jpg","")})}),t.jsxs("p",{className:"flex items-center gap-2 text-xs mt-1",children:[t.jsx(Ee,{size:12})," ",t.jsx(le,{hasDecoration:!0,to:`/app/timeline?scrollTo=${G(s.createDate)?.toISOString().split("T")[0]}`,children:G(s.createDate)?.toLocaleString()||"Ungültiges Datum"})]}),s.latitude&&s.longitude?t.jsxs("p",{className:"flex items-center gap-2 text-xs mt-1",children:[t.jsx(oe,{size:12}),t.jsx(le,{target:"_self",className:"text-xs",href:`/app/map?gallery=${s.gallerySlug}&image=${ae(s.filename.replace(/\.[^/.]+$/,""))}`,children:`${s.latitude.toFixed(3)}, ${s.longitude.toFixed(3)}`})]}):t.jsxs("p",{className:"flex items-center gap-2 text-xs mt-1",children:[t.jsx(oe,{size:12}),t.jsx("span",{className:"truncate",children:"N/A"})]}),t.jsxs(le,{className:"flex items-center gap-2 text-xs mt-1",href:se(s.gallerySlug,s.filename.replaceAll(" ","_"),"original"),download:!0,children:[t.jsx(De,{size:12}),t.jsx("span",{className:"",children:"Download Foto"})]})]})]})},`${s.gallerySlug}-${s.filename}`))})]}),c==="galleries"&&t.jsxs("div",{children:[t.jsx(me,{className:"items-center border-b py-5 ",children:t.jsx(de,{searchTerm:x,setSearchTerm:g,sortKey:N,setSortKey:I,sortOptions:D,sortOrder:o,setSortOrder:k,startDate:m,setStartDate:$,endDate:i,setEndDate:E,onClearFilters:F})}),t.jsxs("div",{className:"py-4 text-xs",children:[w.length," ",w.length===1?"Galerie":"Galerien"," gefunden"]}),t.jsx("div",{className:"flex flex-col lg:flex-row lg:flex-wrap",children:w.map((s,l)=>{const a=O[s.slug];return t.jsxs("div",{className:"w-full lg:w-1/2",children:[t.jsxs(te,{to:`/gallery/${s.slug}`,className:"flex lg:flex-row items-center gap-4 py-2",children:[a?t.jsx("img",{loading:"lazy",src:se(s.slug,a.filename.replaceAll(" ","_"),160),alt:s.title,width:128,height:128,className:Q(`${v==="dark"?"text-white bg-white/10":"text-black bg-black/10"} lg:w-24 lg:h-24 min-w-24 min-h-24 w-24 h-24 object-cover `)}):t.jsx("div",{className:"lg:w-24 lg:h-24 w-24 h-24 bg-gray-200 dark:bg-gray-700 flex items-center justify-center",children:t.jsx("span",{className:"text-xs text-gray-500",children:"Kein Bild"})}),t.jsxs("div",{className:"text-sm",children:[t.jsx("h3",{className:"truncate text-lg ",children:s.title}),t.jsxs("p",{className:"truncate",children:[s.images?.length||0," Bilder"]}),t.jsxs("p",{className:"truncate",children:["Erstellt: ",G(s.createDate)?.toLocaleDateString()||"N/V"]})]})]}),l<w.length-1&&""]},l)})})]})]})};export{He as default};
