const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/mapbox-gl-CVYYZmbF.js","assets/mapbox-gl-BTr1OiDZ.css"])))=>i.map(i=>d[i]);
import{r as c,_ as U,m as k}from"./index-CFH5Ecws.js";const D=c.createContext(null);function j(e){return{longitude:e.center.lng,latitude:e.center.lat,zoom:e._seaLevelZoom??e.zoom,pitch:e.pitch,bearing:e.bearing,padding:e.padding,elevation:e._centerAltitude}}function V(e){return Number.isFinite(e.longitude)||Number.isFinite(e.latitude)||Number.isFinite(e.zoom)||Number.isFinite(e.pitch)||Number.isFinite(e.bearing)}function $(e,t){return!!(Number.isFinite(t.longitude)&&e.center.lng!==t.longitude||Number.isFinite(t.latitude)&&e.center.lat!==t.latitude||Number.isFinite(t.bearing)&&e.bearing!==t.bearing||Number.isFinite(t.pitch)&&e.pitch!==t.pitch||Number.isFinite(t.zoom)&&(e._seaLevelZoom??e.zoom)!==t.zoom||t.padding&&!e.isPaddingEqual(t.padding))}function x(){}function H(e,t){const o=e._constrain,i=e._calcMatrices;if(e._constrain=x,e._calcMatrices=x,Number.isFinite(t.bearing)&&(e.bearing=t.bearing),Number.isFinite(t.pitch)&&(e.pitch=t.pitch),t.padding&&!e.isPaddingEqual(t.padding)&&(e.padding=t.padding),Number.isFinite(t.longitude)||Number.isFinite(t.latitude)){const n=e.center;e._center=new n.constructor(t.longitude??n.lng,t.latitude??n.lat)}if(Number.isFinite(t.zoom))if(e._centerAltitude=t.elevation??0,e.elevation){e._seaLevelZoom=t.zoom;const n=e.pixelsPerMeter/e.worldSize*e._centerAltitude,r=e._mercatorZfromZoom(t.zoom),s=e._mercatorZfromZoom(e._maxZoom),a=Math.max(r-n,s);e._setZoom(e._zoomFromMercatorZ(a))}else e._seaLevelZoom=null,e.zoom=t.zoom;e._constrain=o,e._calcMatrices=i,e._unmodified||(e._constrain(),e._calcMatrices())}const I=new Set(["_calcMatrices","_calcFogMatrices","_updateCameraState","_updateSeaLevelZoom"]);function q(e){let t=!1,o={};const i=e;let n=null;const r={get(s,a){return a==="$reactViewState"?o:a==="$proposedTransform"?n:a==="$internalUpdate"?t:a==="_setZoom"?l=>{t&&n?.[a](l),Number.isFinite(o.zoom)||i[a](l)}:(t&&a==="_translateCameraConstrained"&&V(o)&&(n=n||i.clone()),I.has(a)?function(...l){n?.[a](...l),i[a](...l)}:t&&n?n[a]:i[a])},set(s,a,l){if(a==="$reactViewState")return o=l,H(i,o),!0;if(a==="$proposedTransform")return n=l,!0;if(a==="$internalUpdate")return t=l,!0;let u=l;return a==="center"||a==="_center"?(Number.isFinite(o.longitude)||Number.isFinite(o.latitude))&&(u=new l.constructor(o.longitude??l.lng,o.latitude??l.lat)):a==="zoom"||a==="_zoom"||a==="_seaLevelZoom"?Number.isFinite(o.zoom)&&(u=i[a]):a==="_centerAltitude"?Number.isFinite(o.elevation)&&(u=i[a]):a==="pitch"||a==="_pitch"?Number.isFinite(o.pitch)&&(u=i[a]):(a==="bearing"||a==="rotation"||a==="angle")&&Number.isFinite(o.bearing)&&(u=i[a]),t&&u!==l&&(n=n||i.clone()),t&&n&&(n[a]=l),i[a]=u,!0}};return new Proxy(e,r)}const W=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function T(e){if(!e)return null;if(typeof e=="string"||("toJS"in e&&(e=e.toJS()),!e.layers))return e;const t={};for(const i of e.layers)t[i.id]=i;const o=e.layers.map(i=>{let n=null;"interactive"in i&&(n=Object.assign({},i),delete n.interactive);const r=t[i.ref];if(r){n=n||Object.assign({},i),delete n.ref;for(const s of W)s in r&&(n[s]=r[s])}return n||i});return{...e,layers:o}}function B(e,t){const o=Array.isArray(e)?e[0]:e?e.x:0,i=Array.isArray(e)?e[1]:e?e.y:0,n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0;return o===n&&i===r}function _(e,t){if(e===t)return!0;if(!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let o=0;o<e.length;o++)if(!_(e[o],t[o]))return!1;return!0}else if(Array.isArray(t))return!1;if(typeof e=="object"&&typeof t=="object"){const o=Object.keys(e),i=Object.keys(t);if(o.length!==i.length)return!1;for(const n of o)if(!t.hasOwnProperty(n)||!_(e[n],t[n]))return!1;return!0}return!1}var w={};const F={version:8,sources:{},layers:[]},R={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},N={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},z={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},G=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],Q=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class E{constructor(t,o,i){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=n=>{const r=this.props[z[n.type]];r?r(n):n.type==="error"&&console.error(n.error)},this._onPointerEvent=n=>{(n.type==="mousemove"||n.type==="mouseout")&&this._updateHover(n);const r=this.props[R[n.type]];r&&(this.props.interactiveLayerIds&&n.type!=="mouseover"&&n.type!=="mouseout"&&(n.features=this._hoveredFeatures||this._queryRenderedFeatures(n.point)),r(n),delete n.features)},this._onCameraEvent=n=>{if(!this._internalUpdate){const r=this.props[N[n.type]],s=this._proxyTransform;r&&(n.viewState=j(s.$proposedTransform??s),r(n)),n.type==="moveend"&&(s.$proposedTransform=null)}n.type in this._deferredEvents&&(this._deferredEvents[n.type]=!1)},this._MapClass=t,this.props=o,this._initialize(i)}get map(){return this._map}get transform(){return this._map.transform}setProps(t){const o=this.props;this.props=t;const i=this._updateSettings(t,o);i&&this._createProxyTransform(this._map);const n=this._updateSize(t),r=this._updateViewState(t,!0);this._updateStyle(t,o),this._updateStyleComponents(t,o),this._updateHandlers(t,o),(i||n||r&&!this._map.isMoving())&&this.redraw()}static reuse(t,o){const i=E.savedMaps.pop();if(!i)return null;const n=i.map,r=n.getContainer();for(o.className=r.className;r.childNodes.length>0;)o.appendChild(r.childNodes[0]);n._container=o,i.setProps({...t,styleDiffing:!1}),n.resize();const{initialViewState:s}=t;return s&&(s.bounds?n.fitBounds(s.bounds,{...s.fitBoundsOptions,duration:0}):i._updateViewState(s,!1)),n.isStyleLoaded()?n.fire("load"):n.once("styledata",()=>n.fire("load")),n._update(),i}_initialize(t){const{props:o}=this,{mapStyle:i=F}=o,n={...o,...o.initialViewState,accessToken:o.mapboxAccessToken||K()||null,container:t,style:T(i)},r=n.initialViewState||n.viewState||n;if(Object.assign(n,{center:[r.longitude||0,r.latitude||0],zoom:r.zoom||0,pitch:r.pitch||0,bearing:r.bearing||0}),o.gl){const f=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=f,o.gl)}const s=new this._MapClass(n);r.padding&&s.setPadding(r.padding),o.cursor&&(s.getCanvas().style.cursor=o.cursor),this._createProxyTransform(s);const a=s._render;s._render=f=>{this._inRender=!0,a.call(s,f),this._inRender=!1};const l=s._renderTaskQueue.run;s._renderTaskQueue.run=f=>{this._proxyTransform.$internalUpdate=!0,l.call(s._renderTaskQueue,f),this._proxyTransform.$internalUpdate=!1,this._fireDefferedEvents()};const u=s.jumpTo;s.jumpTo=(...f)=>(this._proxyTransform.$internalUpdate=!0,u.apply(s,f),this._proxyTransform.$internalUpdate=!1,s);const y=s.fire;s.fire=this._fireEvent.bind(this,y),s.on("styledata",()=>{this._updateStyleComponents(this.props,{})}),s.on("sourcedata",()=>{this._updateStyleComponents(this.props,{})});for(const f in R)s.on(f,this._onPointerEvent);for(const f in N)s.on(f,this._onCameraEvent);for(const f in z)s.on(f,this._onEvent);this._map=s}recycle(){this.map.getContainer().querySelector("[mapboxgl-children]")?.remove(),E.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const t=this._map;!this._inRender&&t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}_createProxyTransform(t){const o=q(t.transform);t.transform=o,t.painter.transform=o,this._proxyTransform=o}_updateSize(t){const{viewState:o}=t;if(o){const i=this._map;if(o.width!==i.transform.width||o.height!==i.transform.height)return i.resize(),!0}return!1}_updateViewState(t,o){const i=t.viewState||t,n=this._proxyTransform,{zoom:r,pitch:s,bearing:a}=n,l=$(this._proxyTransform,i);if(n.$reactViewState=i,l&&o){const u=this._deferredEvents;u.move=!0,u.zoom||(u.zoom=r!==n.zoom),u.rotate||(u.rotate=a!==n.bearing),u.pitch||(u.pitch=s!==n.pitch)}return l}_updateSettings(t,o){const i=this._map;let n=!1;for(const r of G)r in t&&!_(t[r],o[r])&&(n=!0,i[`set${r[0].toUpperCase()}${r.slice(1)}`]?.call(i,t[r]));return n}_updateStyle(t,o){if(t.cursor!==o.cursor&&(this._map.getCanvas().style.cursor=t.cursor||""),t.mapStyle!==o.mapStyle){const{mapStyle:i=F,styleDiffing:n=!0}=t,r={diff:n};return"localIdeographFontFamily"in t&&(r.localIdeographFontFamily=t.localIdeographFontFamily),this._map.setStyle(T(i),r),!0}return!1}_updateStyleComponents(t,o){const i=this._map;let n=!1;return i.isStyleLoaded()&&("light"in t&&i.setLight&&!_(t.light,o.light)&&(n=!0,i.setLight(t.light)),"fog"in t&&i.setFog&&!_(t.fog,o.fog)&&(n=!0,i.setFog(t.fog)),"terrain"in t&&i.setTerrain&&!_(t.terrain,o.terrain)&&(!t.terrain||i.getSource(t.terrain.source))&&(n=!0,i.setTerrain(t.terrain))),n}_updateHandlers(t,o){const i=this._map;let n=!1;for(const r of Q){const s=t[r]??!0,a=o[r]??!0;_(s,a)||(n=!0,s?i[r].enable(s):i[r].disable())}return n}_queryRenderedFeatures(t){const o=this._map,{interactiveLayerIds:i=[]}=this.props;try{return o.queryRenderedFeatures(t,{layers:i.filter(o.getLayer.bind(o))})}catch{return[]}}_updateHover(t){const{props:o}=this;if(o.interactiveLayerIds&&(o.onMouseMove||o.onMouseEnter||o.onMouseLeave)){const n=t.type,r=this._hoveredFeatures?.length>0,s=this._queryRenderedFeatures(t.point),a=s.length>0;!a&&r&&(t.type="mouseleave",this._onPointerEvent(t)),this._hoveredFeatures=s,a&&!r&&(t.type="mouseenter",this._onPointerEvent(t)),t.type=n}else this._hoveredFeatures=null}_fireEvent(t,o,i){const n=this._map,r=this._proxyTransform,s=r.$internalUpdate;try{r.$internalUpdate=!1,t.call(n,o,i)}finally{r.$internalUpdate=s}return n}_fireDefferedEvents(){const t=this._map;this._internalUpdate=!0;for(const o in this._deferredEvents)this._deferredEvents[o]&&t.fire(o);this._internalUpdate=!1}}E.savedMaps=[];function K(){let e=null;if(typeof location<"u"){const t=/access_token=([^&\/]*)/.exec(location.search);e=t&&t[1]}try{e=e||w.MapboxAccessToken}catch{}try{e=e||w.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return e}const J=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function Y(e){if(!e)return null;const t=e.map,o={getMap:()=>t,getCenter:()=>e.transform.center,getZoom:()=>e.transform.zoom,getBearing:()=>e.transform.bearing,getPitch:()=>e.transform.pitch,getPadding:()=>e.transform.padding,getBounds:()=>e.transform.getBounds(),project:i=>{const n=t.transform;t.transform=e.transform;const r=t.project(i);return t.transform=n,r},unproject:i=>{const n=t.transform;t.transform=e.transform;const r=t.unproject(i);return t.transform=n,r},queryTerrainElevation:(i,n)=>{const r=t.transform;t.transform=e.transform;const s=t.queryTerrainElevation(i,n);return t.transform=r,s},queryRenderedFeatures:(i,n)=>{const r=t.transform;t.transform=e.transform;const s=t.queryRenderedFeatures(i,n);return t.transform=r,s}};for(const i of X(t))!(i in o)&&!J.includes(i)&&(o[i]=t[i].bind(t));return o}function X(e){const t=new Set;let o=e;for(;o;){for(const i of Object.getOwnPropertyNames(o))i[0]!=="_"&&typeof e[i]=="function"&&i!=="fire"&&i!=="setEventedParent"&&t.add(i);o=Object.getPrototypeOf(o)}return Array.from(t)}const ee=typeof document<"u"?c.useLayoutEffect:c.useEffect,te=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function ne(e,t){for(const i of te)i in t&&(e[i]=t[i]);const{RTLTextPlugin:o="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=t;o&&e.getRTLTextPluginStatus&&e.getRTLTextPluginStatus()==="unavailable"&&e.setRTLTextPlugin(o,i=>{i&&console.error(i)},!0)}const M=c.createContext(null);function oe(e,t){const o=c.useContext(D),[i,n]=c.useState(null),r=c.useRef(),{current:s}=c.useRef({mapLib:null,map:null});c.useEffect(()=>{const u=e.mapLib;let y=!0,f;return Promise.resolve(u||U(()=>import("./mapbox-gl-CVYYZmbF.js").then(d=>d.m),__vite__mapDeps([0,1]))).then(d=>{if(!y)return;if(!d)throw new Error("Invalid mapLib");const m="Map"in d?d:d.default;if(!m.Map)throw new Error("Invalid mapLib");ne(m,e),e.reuseMaps&&(f=E.reuse(e,r.current)),f||(f=new E(m.Map,e,r.current)),s.map=Y(f),s.mapLib=m,n(f),o?.onMapMount(s.map,e.id)}).catch(d=>{const{onError:m}=e;m?m({type:"error",target:null,error:d}):console.error(d)}),()=>{y=!1,f&&(o?.onMapUnmount(e.id),e.reuseMaps?f.recycle():f.destroy())}},[]),ee(()=>{i&&i.setProps(e)}),c.useImperativeHandle(t,()=>s.map,[i]);const a=c.useMemo(()=>({position:"relative",width:"100%",height:"100%",...e.style}),[e.style]),l={height:"100%"};return c.createElement("div",{id:e.id,ref:r,style:a},i&&c.createElement(M.Provider,{value:s},c.createElement("div",{"mapboxgl-children":"",style:l},e.children)))}const fe=c.forwardRef(oe),re=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function v(e,t){if(!e||!t)return;const o=e.style;for(const i in t){const n=t[i];Number.isFinite(n)&&!re.test(i)?o[i]=`${n}px`:o[i]=n}}function A(e,t){if(e===t)return null;const o=P(e),i=P(t),n=[];for(const r of i)o.has(r)||n.push(r);for(const r of o)i.has(r)||n.push(r);return n.length===0?null:n}function P(e){return new Set(e?e.trim().split(/\s+/):[])}const de=c.memo(c.forwardRef((e,t)=>{const{map:o,mapLib:i}=c.useContext(M),n=c.useRef({props:e}),r=c.useMemo(()=>{let C=!1;c.Children.forEach(e.children,h=>{h&&(C=!0)});const O={...e,element:C?document.createElement("div"):null},p=new i.Marker(O);return p.setLngLat([e.longitude,e.latitude]),p.getElement().addEventListener("click",h=>{n.current.props.onClick?.({type:"click",target:p,originalEvent:h})}),p.on("dragstart",h=>{const g=h;g.lngLat=r.getLngLat(),n.current.props.onDragStart?.(g)}),p.on("drag",h=>{const g=h;g.lngLat=r.getLngLat(),n.current.props.onDrag?.(g)}),p.on("dragend",h=>{const g=h;g.lngLat=r.getLngLat(),n.current.props.onDragEnd?.(g)}),p},[]);c.useEffect(()=>(r.addTo(o.getMap()),()=>{r.remove()}),[]);const{longitude:s,latitude:a,offset:l,style:u,draggable:y=!1,popup:f=null,rotation:d=0,rotationAlignment:m="auto",pitchAlignment:S="auto"}=e;c.useEffect(()=>{v(r.getElement(),u)},[u]),c.useImperativeHandle(t,()=>r,[]);const Z=n.current.props;(r.getLngLat().lng!==s||r.getLngLat().lat!==a)&&r.setLngLat([s,a]),l&&!B(r.getOffset(),l)&&r.setOffset(l),r.isDraggable()!==y&&r.setDraggable(y),r.getRotation()!==d&&r.setRotation(d),r.getRotationAlignment()!==m&&r.setRotationAlignment(m),r.getPitchAlignment()!==S&&r.setPitchAlignment(S),r.getPopup()!==f&&r.setPopup(f);const L=A(Z.className,e.className);if(L)for(const C of L)r.toggleClassName(C);return n.current.props=e,k.createPortal(e.children,r.getElement())})),me=c.memo(c.forwardRef((e,t)=>{const{map:o,mapLib:i}=c.useContext(M),n=c.useMemo(()=>document.createElement("div"),[]),r=c.useRef({props:e}),s=c.useMemo(()=>{const a={...e},l=new i.Popup(a);return l.setLngLat([e.longitude,e.latitude]),l.once("open",u=>{r.current.props.onOpen?.(u)}),l},[]);if(c.useEffect(()=>{const a=l=>{r.current.props.onClose?.(l)};return s.on("close",a),s.setDOMContent(n).addTo(o.getMap()),()=>{s.off("close",a),s.isOpen()&&s.remove()}},[]),c.useEffect(()=>{v(s.getElement(),e.style)},[e.style]),c.useImperativeHandle(t,()=>s,[]),s.isOpen()){const a=r.current.props;(s.getLngLat().lng!==e.longitude||s.getLngLat().lat!==e.latitude)&&s.setLngLat([e.longitude,e.latitude]),e.offset&&!_(a.offset,e.offset)&&(s.options.anchor=e.anchor,s.setOffset(e.offset)),(a.anchor!==e.anchor||a.maxWidth!==e.maxWidth)&&s.setMaxWidth(e.maxWidth);const l=A(a.className,e.className);if(l)for(const u of l)s.toggleClassName(u);r.current.props=e}return k.createPortal(e.children,n)}));function b(e,t,o,i){const n=c.useContext(M),r=c.useMemo(()=>e(n),[]);return c.useEffect(()=>{const s=t,a=null,l=typeof t=="function"?t:null,{map:u}=n;return u.hasControl(r)||(u.addControl(r,s?.position),a&&a(n)),()=>{l&&l(n),u.hasControl(r)&&u.removeControl(r)}},[]),r}function ie(e){const t=b(({mapLib:o})=>new o.AttributionControl(e),{position:e.position});return c.useEffect(()=>{v(t._container,e.style)},[e.style]),null}c.memo(ie);function se(e){const t=b(({mapLib:o})=>new o.FullscreenControl({container:e.containerId&&document.getElementById(e.containerId)}),{position:e.position});return c.useEffect(()=>{v(t._controlContainer,e.style)},[e.style]),null}c.memo(se);function ae(e,t){const o=c.useRef({props:e}),i=b(({mapLib:n})=>{const r=new n.GeolocateControl(e),s=r._setupUI.bind(r);return r._setupUI=a=>{r._container.hasChildNodes()||s(a)},r.on("geolocate",a=>{o.current.props.onGeolocate?.(a)}),r.on("error",a=>{o.current.props.onError?.(a)}),r.on("outofmaxbounds",a=>{o.current.props.onOutOfMaxBounds?.(a)}),r.on("trackuserlocationstart",a=>{o.current.props.onTrackUserLocationStart?.(a)}),r.on("trackuserlocationend",a=>{o.current.props.onTrackUserLocationEnd?.(a)}),r},{position:e.position});return o.current.props=e,c.useImperativeHandle(t,()=>i,[]),c.useEffect(()=>{v(i._container,e.style)},[e.style]),null}c.memo(c.forwardRef(ae));function ce(e){const t=b(({mapLib:o})=>new o.NavigationControl(e),{position:e.position});return c.useEffect(()=>{v(t._container,e.style)},[e.style]),null}c.memo(ce);function le(e){const t=b(({mapLib:r})=>new r.ScaleControl(e),{position:e.position}),o=c.useRef(e),i=o.current;o.current=e;const{style:n}=e;return e.maxWidth!==void 0&&e.maxWidth!==i.maxWidth&&(t.options.maxWidth=e.maxWidth),e.unit!==void 0&&e.unit!==i.unit&&t.setUnit(e.unit),c.useEffect(()=>{v(t._container,n)},[n]),null}c.memo(le);export{fe as M,me as P,de as a,M as b,_ as d};
