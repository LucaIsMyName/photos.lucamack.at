import{f as te,c as se,r as f,e as K,j as t,C as S,i as le,k as ie,h as ce,g as J,l as I,a as W,L as Q,s as X,b as Y}from"./index-B2KoAEc4.js";import{H as Z}from"./Href-DKf_mUxa.js";import{V as oe,T as me,I as he,S as de,a as fe,b as ue,c as xe,d as ge,P as pe,C as be,R as je}from"./index-Dun-e625.js";import{M as ae}from"./map-pin-Da3M9DzY.js";import{D as we}from"./download-BOXhMjAX.js";import"./mapbox-gl-CNTiHEyl.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Se=te("chevron-left",ye);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ve=te("chevron-right",Ne);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],$e=te("clock",De),re=u=>{const e=se.c(25),{children:i,className:F}=u,x=F===void 0?"":F,g=f.useRef(null),[d,E]=f.useState(!1),[v,M]=f.useState(!1),{theme:m}=K();let $;e[0]===Symbol.for("react.memo_cache_sentinel")?($=r=>{const n=g.current;if(n){const o=n.clientWidth*.8;n.scrollBy({left:r==="left"?-o:o,behavior:"smooth"})}},e[0]=$):$=e[0];const h=$;let k;e[1]===Symbol.for("react.memo_cache_sentinel")?(k=()=>{const r=()=>{const o=g.current;if(o){const{scrollLeft:L,scrollWidth:R,clientWidth:H}=o,B=L<=0,V=L>=R-H-1;E(!B),M(!V)}},n=g.current;if(n){r(),n.addEventListener("scroll",r);const o=new ResizeObserver(r);return o.observe(n),()=>{n.removeEventListener("scroll",r),o.unobserve(n)}}},e[1]=k):k=e[1];let c;e[2]!==i?(c=[i],e[2]=i,e[3]=c):c=e[3],f.useEffect(k,c);const N=`flex items-center  w-full overflow-x-auto no-scrollbar py-2 ${x}`;let p;e[4]!==i||e[5]!==N?(p=t.jsx("div",{ref:g,className:N,children:i}),e[4]=i,e[5]=N,e[6]=p):p=e[6];const C=`absolute top-0 left-0 bottom-0 w-12 bg-gradient-to-r ${m==="light"?"from-white":"from-black"} to-transparent pointer-events-none transition-opacity duration-300 ${d?"opacity-100":"opacity-0"}`;let w;e[7]===Symbol.for("react.memo_cache_sentinel")?(w=()=>h("left"),e[7]=w):w=e[7];const D=`absolute top-1/2 -translate-y-1/2 left-0 ${m==="dark"?"text-white":"text-black"} pointer-events-auto`;let T;e[8]===Symbol.for("react.memo_cache_sentinel")?(T=t.jsx(Se,{size:20}),e[8]=T):T=e[8];let b;e[9]!==D?(b=t.jsx("button",{onClick:w,className:D,children:T}),e[9]=D,e[10]=b):b=e[10];let j;e[11]!==b||e[12]!==C?(j=t.jsx("div",{className:C,children:b}),e[11]=b,e[12]=C,e[13]=j):j=e[13];const y=`absolute top-0 right-0 bottom-0 w-12 bg-gradient-to-l ${m==="light"?"from-white":"from-black"} to-transparent pointer-events-none transition-opacity duration-300 ${v?"opacity-100":"opacity-0"}`;let A;e[14]===Symbol.for("react.memo_cache_sentinel")?(A=()=>h("right"),e[14]=A):A=e[14];const z=`absolute top-1/2 -translate-y-1/2 right-0 ${m==="dark"?"text-white":"text-black"} pointer-events-auto`;let O;e[15]===Symbol.for("react.memo_cache_sentinel")?(O=t.jsx(ve,{size:20}),e[15]=O):O=e[15];let s;e[16]!==z?(s=t.jsx("button",{onClick:A,className:z,children:O}),e[16]=z,e[17]=s):s=e[17];let l;e[18]!==y||e[19]!==s?(l=t.jsx("div",{className:y,children:s}),e[18]=y,e[19]=s,e[20]=l):l=e[20];let a;return e[21]!==j||e[22]!==l||e[23]!==p?(a=t.jsxs("div",{className:"relative flex items-center w-full",children:[p,j,l]}),e[21]=j,e[22]=l,e[23]=p,e[24]=a):a=e[24],a};function ee(u,e){const i=se.c(4),[F,x]=f.useState(u);let g,d;return i[0]!==e||i[1]!==u?(g=()=>{const E=setTimeout(()=>{x(u)},e);return()=>{clearTimeout(E)}},d=[u,e],i[0]=e,i[1]=u,i[2]=g,i[3]=d):(g=i[2],d=i[3]),f.useEffect(g,d),F}const ne=u=>{const e=se.c(56),{searchTerm:i,setSearchTerm:F,sortKey:x,setSortKey:g,sortOptions:d,sortOrder:E,setSortOrder:v,startDate:M,setStartDate:m,endDate:$,setEndDate:h,onClearFilters:k}=u,{theme:c}=K();let N;e[0]!==F?(N=G=>F(G.target.value),e[0]=F,e[1]=N):N=e[1];let p;e[2]!==i||e[3]!==N?(p=t.jsx("div",{className:`flex-shrink-0 p-2  ${S.theme.border.right} `,children:t.jsx("input",{type:"text",placeholder:"Suchen...",value:i,onChange:N,className:"bg-transparent focus:outline-none w-48"})}),e[2]=i,e[3]=N,e[4]=p):p=e[4];let C;e[5]===Symbol.for("react.memo_cache_sentinel")?(C=t.jsx("label",{htmlFor:"startDate",className:"whitespace-nowrap",children:"Filter von"}),e[5]=C):C=e[5];let w;e[6]!==m?(w=G=>m(G.target.value),e[6]=m,e[7]=w):w=e[7];let D;e[8]!==M||e[9]!==w?(D=t.jsx("input",{id:"startDate",type:"date",value:M,onChange:w,className:"bg-transparent focus:outline-none uppercase"}),e[8]=M,e[9]=w,e[10]=D):D=e[10];let T;e[11]===Symbol.for("react.memo_cache_sentinel")?(T=t.jsx("label",{htmlFor:"endDate",children:"bis"}),e[11]=T):T=e[11];let b;e[12]!==h?(b=G=>h(G.target.value),e[12]=h,e[13]=b):b=e[13];let j;e[14]!==$||e[15]!==b?(j=t.jsx("input",{id:"endDate",type:"date",value:$,onChange:b,className:"bg-transparent focus:outline-none uppercase"}),e[14]=$,e[15]=b,e[16]=j):j=e[16];let y;e[17]!==D||e[18]!==j?(y=t.jsxs("div",{className:`flex-shrink-0 flex items-center gap-4 p-2 px-4  ${S.theme.border.right}`,children:[C,D,T,j]}),e[17]=D,e[18]=j,e[19]=y):y=e[19];let A;e[20]===Symbol.for("react.memo_cache_sentinel")?(A=t.jsx("span",{className:"whitespace-nowrap",children:"Sortieren nach"}),e[20]=A):A=e[20];let z;e[21]===Symbol.for("react.memo_cache_sentinel")?(z=t.jsx(oe,{}),e[21]=z):z=e[21];let O;e[22]===Symbol.for("react.memo_cache_sentinel")?(O=t.jsxs(me,{className:"inline-flex items-center justify-center gap-2 bg-transparent focus:outline-none",children:[z,t.jsx(he,{children:t.jsx(le,{size:16})})]}),e[22]=O):O=e[22];const s=`overflow-hidden ${c==="dark"?"bg-black text-white ":"bg-white text-black"}  ${S.theme.border.default}`;let l;e[23]===Symbol.for("react.memo_cache_sentinel")?(l=t.jsx(de,{className:"flex items-center justify-center h-6 cursor-default",children:t.jsx(ie,{})}),e[23]=l):l=e[23];let a;if(e[24]!==d||e[25]!==c){let G;e[27]!==c?(G=U=>t.jsx(fe,{value:U.value,"aria-label":U.label,className:`text-sm leading-none flex items-center h-6 pr-8 pl-6 relative select-none data-[highlighted]:outline-none ${c==="dark"?"data-[highlighted]:bg-red-300 data-[highlighted]:text-black":"data-[highlighted]:bg-red-600 data-[highlighted]:text-white"}`,children:t.jsx(ue,{children:U.label})},U.value),e[27]=c,e[28]=G):G=e[28],a=d.map(G),e[24]=d,e[25]=c,e[26]=a}else a=e[26];let r;e[29]!==a?(r=t.jsx(xe,{className:"p-1",children:a}),e[29]=a,e[30]=r):r=e[30];let n;e[31]===Symbol.for("react.memo_cache_sentinel")?(n=t.jsx(ge,{className:"flex items-center justify-center h-6 cursor-default",children:t.jsx(le,{})}),e[31]=n):n=e[31];let o;e[32]!==s||e[33]!==r?(o=t.jsx(pe,{children:t.jsxs(be,{className:s,children:[l,r,n]})}),e[32]=s,e[33]=r,e[34]=o):o=e[34];let L;e[35]!==g||e[36]!==x||e[37]!==o?(L=t.jsxs(je,{value:x,"aria-label":"Sortieren nach",onValueChange:g,children:[O,o]}),e[35]=g,e[36]=x,e[37]=o,e[38]=L):L=e[38];let R;e[39]!==v||e[40]!==E?(R=()=>v(E==="asc"?"desc":"asc"),e[39]=v,e[40]=E,e[41]=R):R=e[41];const H=E==="asc"?"(Aufsteigend)":"(Absteigend)";let B;e[42]!==R||e[43]!==H?(B=t.jsx("button",{onClick:R,"aria-label":"Sortieren nach",className:"whitespace-nowrap",children:H}),e[42]=R,e[43]=H,e[44]=B):B=e[44];let V;e[45]!==L||e[46]!==B?(V=t.jsxs("div",{className:`flex-shrink-0 flex items-center gap-4 p-2 px-4  ${S.theme.border.right}`,children:[A,L,B]}),e[45]=L,e[46]=B,e[47]=V):V=e[47];const q=`${c==="dark"?"text-red-300":"text-red-600"} underline underline-offset-4 whitespace-nowrap hover:underline`;let P;e[48]!==k||e[49]!==q?(P=t.jsx("div",{className:"flex-shrink-0 p-2 px-4",children:t.jsx("button",{onClick:k,"aria-label":"Alle Filter löschen",className:q,children:"Filter löschen"})}),e[48]=k,e[49]=q,e[50]=P):P=e[50];let _;return e[51]!==p||e[52]!==V||e[53]!==P||e[54]!==y?(_=t.jsxs("div",{className:"flex items-center w-full",children:[p,y,V,P]}),e[51]=p,e[52]=V,e[53]=P,e[54]=y,e[55]=_):_=e[55],_},Ae=()=>{const[u,e]=ce(),[i,F]=f.useState(u.get("tab")||"images"),[x,g]=f.useState(u.get("search")||""),[d,E]=f.useState(u.get("sortBy")||"createDate"),[v,M]=f.useState(u.get("gallerySortBy")||"title"),[m,$]=f.useState(u.get("sortOrder")||"desc"),[h,k]=f.useState(u.get("startDate")||""),[c,N]=f.useState(u.get("endDate")||""),p=ee(x,300),C=ee(h,300),w=ee(c,300),{theme:D}=K();f.useEffect(()=>{const s=new URLSearchParams;i!=="images"&&s.set("tab",i),p&&s.set("search",p),d!=="createDate"&&s.set("sortBy",d),v!=="title"&&s.set("gallerySortBy",v),m!=="desc"&&s.set("sortOrder",m),C&&s.set("startDate",C),w&&s.set("endDate",w),e(s,{replace:!0})},[i,p,d,v,m,C,w,e]);const T=()=>{g(""),E("createDate"),M("title"),$("desc"),k(""),N("")},b=f.useMemo(()=>{const s=[];return J.forEach(l=>{l.images?.forEach((a,r)=>{s.push({...a,galleryTitle:l.title,gallerySlug:l.slug,index:r+1})})}),s},[]),j=f.useMemo(()=>{let s=b;if(x){const l=x.toLowerCase().split(" ").filter(Boolean);l.length>0&&(s=s.filter(a=>{const r=`${a.galleryTitle.toLowerCase()} ${a.filename?a.filename.toLowerCase():""}`;return l.every(n=>r.includes(n))}))}if(h){const l=new Date(h);l.setHours(0,0,0,0),s=s.filter(a=>{const r=I(a.createDate);return r&&r>=l})}if(c){const l=new Date(c);l.setHours(23,59,59,999),s=s.filter(a=>{const r=I(a.createDate);return r&&r<=l})}return[...s].sort((l,a)=>{const r=d==="createDate"?I(l.createDate):l.galleryTitle,n=d==="createDate"?I(a.createDate):a.galleryTitle;return r===null?1:n===null?-1:r<n?m==="asc"?-1:1:r>n?m==="asc"?1:-1:0})},[b,x,d,m,h,c]),y=f.useMemo(()=>{let s=J.map(l=>({...l,createDate:l.images?.[0]?.createDate}));if(x){const l=x.toLowerCase();s=s.filter(a=>{const r=a.title.toLowerCase().includes(l),n=a.images.some(o=>o.filename.toLowerCase().includes(l));return r||n})}if(h||c){const l=h?new Date(h):null;l&&l.setHours(0,0,0,0);const a=c?new Date(c):null;a&&a.setHours(23,59,59,999),s=s.filter(r=>b.filter(n=>{const o=I(n.createDate),L=h?new Date(h):null,R=c?new Date(c):null;return!(L&&o&&o<L||R&&o&&o>R)}).some(n=>n.gallerySlug===r.slug))}return[...s].sort((l,a)=>{const r=v==="createDate"?I(l.createDate):l.title,n=v==="createDate"?I(a.createDate):a.title;return r===null?1:n===null?-1:r<n?m==="asc"?-1:1:r>n?m==="asc"?1:-1:0})},[x,v,m,h,c]),A=f.useMemo(()=>{const s={};return J.forEach(l=>{l.images&&l.images.length>0?s[l.slug]=l.images[Math.floor(Math.random()*l.images.length)]:s[l.slug]=null}),s},[]),z=[{value:"createDate",label:"Datum"},{value:"galleryTitle",label:"Name"}],O=[{value:"title",label:"Name"},{value:"createDate",label:"Datum"}];return t.jsxs("div",{className:"p-4 md:px-8",children:[t.jsx("title",{children:`Liste aller Fotos und Galerien | ${S.meta.title}`}),t.jsx("meta",{name:"title",content:`Liste aller Fotos und Galerien | ${S.meta.title}`}),t.jsx("meta",{name:"description",content:"Eine Liste aller Fotos und Galerien. Sortierbar und Filterbar."}),t.jsxs("div",{className:`flex gap-4 ${S.theme.border.bottom}`,children:[t.jsx("button",{className:W(`${S.theme.headline.one} py-2 sm:py-4 ${i==="images"?K().theme==="dark"?`${S.theme.dark.text.primary}`:`${S.theme.light.text.primary}`:K().theme==="dark"?"text-white":"text-black"}`),onClick:()=>F("images"),children:"Fotos"}),t.jsx("button",{className:W(`${S.theme.headline.one} py-2 sm:py-4 ${i==="galleries"?K().theme==="dark"?`${S.theme.dark.text.primary}`:`${S.theme.light.text.primary}`:K().theme==="dark"?"text-white":"text-black"}`),onClick:()=>F("galleries"),children:"Serien"})]}),i==="images"&&t.jsxs("div",{className:"",children:[t.jsx(re,{className:`items-center ${S.theme.border.bottom} py-5 `,children:t.jsx(ne,{searchTerm:x,setSearchTerm:g,sortKey:d,setSortKey:E,sortOptions:z,sortOrder:m,setSortOrder:$,startDate:h,setStartDate:k,endDate:c,setEndDate:N,onClearFilters:T})}),t.jsxs("div",{className:"py-4 text-xs",children:[j.length," ",j.length===1?"Foto":"Fotos"," gefunden"]}),t.jsx("div",{className:"flex flex-col lg:flex-row lg:flex-wrap",children:j.map(s=>t.jsx("div",{className:"w-full lg:w-1/2",children:t.jsxs("div",{className:"flex lg:flex-row items-center gap-4 py-2",children:[t.jsx(Q,{className:"block min-w-24 min-h-24 lg:w-24 lg:h-24 flex-shrink-0",to:`/gallery/${s.gallerySlug}/image/${X(s.filename.replace(/\.[^/.]+$/,""))}`,children:t.jsx("img",{loading:"lazy",src:Y(s.gallerySlug,s.filename.replaceAll(" ","_"),160),alt:s.alt||`${s.galleryTitle} - ${s.filename}`,width:128,height:128,className:W(`${D==="dark"?"text-white bg-white/10":"text-black bg-black/10"} lg:w-24 lg:h-24 min-w-24 min-h-24 w-24 h-24 object-cover `)})}),t.jsxs("div",{className:"text-sm md:pr-4",children:[t.jsx(Q,{to:`/gallery/${s.gallerySlug}/image/${X(s.filename.replace(/\.[^/.]+$/,""))}`,children:t.jsx("h3",{className:"truncate text-base",children:s.filename.replaceAll(".jpg","")})}),t.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 lg:gap-4 flex-wrap",children:[t.jsxs("p",{className:"flex items-center gap-1 text-[11px] mt-1",children:[t.jsx($e,{size:12})," ",t.jsx(Z,{hasDecoration:!0,to:`/app/timeline?scrollTo=${I(s.createDate)?.toISOString().split("T")[0]}`,children:I(s.createDate)?.toLocaleString("de-AT")||"Ungültiges Datum"})]}),t.jsx("p",{className:"flex items-center gap-1 text-[11px] mt-1",children:s.latitude&&s.longitude?t.jsxs(t.Fragment,{children:[t.jsx(ae,{size:12}),t.jsx(Z,{target:"_self",className:"",href:`/app/map?gallery=${s.gallerySlug}&image=${X(s.filename.replace(/\.[^/.]+$/,""))}`,children:`${s.latitude.toFixed(3)}, ${s.longitude.toFixed(3)}`})]}):t.jsxs(t.Fragment,{children:[t.jsx(ae,{size:12}),t.jsx("span",{className:"truncate",children:"N/A"})]})}),t.jsxs(Z,{className:"flex items-center gap-1 text-[11px] mt-1",href:Y(s.gallerySlug,s.filename.replaceAll(" ","_"),"original"),download:!0,children:[t.jsx(we,{size:12}),t.jsx("span",{className:"",children:"Download"})]})]})]})]})},`${s.gallerySlug}-${s.filename}`))})]}),i==="galleries"&&t.jsxs("div",{children:[t.jsx(re,{className:`items-center  ${S.theme.border.bottom} py-5 `,children:t.jsx(ne,{searchTerm:x,setSearchTerm:g,sortKey:v,setSortKey:M,sortOptions:O,sortOrder:m,setSortOrder:$,startDate:h,setStartDate:k,endDate:c,setEndDate:N,onClearFilters:T})}),t.jsxs("div",{className:"py-4 text-xs",children:[y.length," ",y.length===1?"Galerie":"Galerien"," gefunden"]}),t.jsx("div",{className:"flex flex-col lg:flex-row lg:flex-wrap",children:y.map((s,l)=>{const a=A[s.slug];return t.jsxs("div",{className:"w-full lg:w-1/2",children:[t.jsxs(Q,{to:`/gallery/${s.slug}`,className:"flex lg:flex-row items-center gap-4 py-2",children:[a?t.jsx("img",{loading:"lazy",src:Y(s.slug,a.filename.replaceAll(" ","_"),160),alt:s.title,width:128,height:128,className:W(`${D==="dark"?"text-white bg-white/10":"text-black bg-black/10"} lg:w-24 lg:h-24 min-w-24 min-h-24 w-24 h-24 object-cover `)}):t.jsx("div",{className:"lg:w-24 lg:h-24 w-24 h-24 bg-gray-200 dark:bg-gray-700 flex items-center justify-center",children:t.jsx("span",{className:"text-xs text-gray-500",children:"Kein Bild"})}),t.jsxs("div",{className:"text-sm",children:[t.jsx("h3",{className:"truncate text-lg ",children:s.title}),t.jsxs("p",{className:"truncate",children:[s.images?.length||0," Bilder"]}),t.jsxs("p",{className:"truncate",children:["Erstellt: ",I(s.createDate)?.toLocaleDateString()||"N/V"]})]})]}),l<y.length-1&&""]},l)})})]})]})};export{Ae as default};
