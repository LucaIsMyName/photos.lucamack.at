import{f as J,c as se,r as f,e as K,j as t,C as S,i as le,k as ce,h as ie,g as X,l as I,a as W,L as Y,s as Z,b as ee}from"./index-BZ2qpZQh.js";import{H as q}from"./Href-4htwgfLR.js";import{V as oe,T as me,I as he,S as de,a as fe,b as ue,c as xe,d as ge,P as pe,C as be,R as je}from"./index-C8oFxKil.js";import{M as ae}from"./map-pin-DmP7a7l_.js";import{D as ye}from"./download-CqK-QOLg.js";import"./mapbox-gl-CNTiHEyl.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Se=J("chevron-left",we);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],De=J("chevron-right",Ne);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],$e=J("clock",ve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Ce=J("image",ke),re=u=>{const e=se.c(25),{children:c,className:F}=u,x=F===void 0?"":F,g=f.useRef(null),[d,E]=f.useState(!1),[D,M]=f.useState(!1),{theme:m}=K();let $;e[0]===Symbol.for("react.memo_cache_sentinel")?($=r=>{const n=g.current;if(n){const o=n.clientWidth*.8;n.scrollBy({left:r==="left"?-o:o,behavior:"smooth"})}},e[0]=$):$=e[0];const h=$;let k;e[1]===Symbol.for("react.memo_cache_sentinel")?(k=()=>{const r=()=>{const o=g.current;if(o){const{scrollLeft:T,scrollWidth:z,clientWidth:H}=o,B=T<=0,V=T>=z-H-1;E(!B),M(!V)}},n=g.current;if(n){r(),n.addEventListener("scroll",r);const o=new ResizeObserver(r);return o.observe(n),()=>{n.removeEventListener("scroll",r),o.unobserve(n)}}},e[1]=k):k=e[1];let i;e[2]!==c?(i=[c],e[2]=c,e[3]=i):i=e[3],f.useEffect(k,i);const N=`flex items-center  w-full overflow-x-auto no-scrollbar py-2 ${x}`;let p;e[4]!==c||e[5]!==N?(p=t.jsx("div",{ref:g,className:N,children:c}),e[4]=c,e[5]=N,e[6]=p):p=e[6];const C=`absolute top-0 left-0 bottom-0 w-12 bg-gradient-to-r ${m==="light"?"from-white":"from-black"} to-transparent pointer-events-none transition-opacity duration-300 ${d?"opacity-100":"opacity-0"}`;let y;e[7]===Symbol.for("react.memo_cache_sentinel")?(y=()=>h("left"),e[7]=y):y=e[7];const v=`absolute top-1/2 -translate-y-1/2 left-0 ${m==="dark"?"text-white":"text-black"} pointer-events-auto`;let L;e[8]===Symbol.for("react.memo_cache_sentinel")?(L=t.jsx(Se,{size:20}),e[8]=L):L=e[8];let b;e[9]!==v?(b=t.jsx("button",{onClick:y,className:v,children:L}),e[9]=v,e[10]=b):b=e[10];let j;e[11]!==b||e[12]!==C?(j=t.jsx("div",{className:C,children:b}),e[11]=b,e[12]=C,e[13]=j):j=e[13];const w=`absolute top-0 right-0 bottom-0 w-12 bg-gradient-to-l ${m==="light"?"from-white":"from-black"} to-transparent pointer-events-none transition-opacity duration-300 ${D?"opacity-100":"opacity-0"}`;let O;e[14]===Symbol.for("react.memo_cache_sentinel")?(O=()=>h("right"),e[14]=O):O=e[14];const R=`absolute top-1/2 -translate-y-1/2 right-0 ${m==="dark"?"text-white":"text-black"} pointer-events-auto`;let A;e[15]===Symbol.for("react.memo_cache_sentinel")?(A=t.jsx(De,{size:20}),e[15]=A):A=e[15];let s;e[16]!==R?(s=t.jsx("button",{onClick:O,className:R,children:A}),e[16]=R,e[17]=s):s=e[17];let l;e[18]!==w||e[19]!==s?(l=t.jsx("div",{className:w,children:s}),e[18]=w,e[19]=s,e[20]=l):l=e[20];let a;return e[21]!==j||e[22]!==l||e[23]!==p?(a=t.jsxs("div",{className:"relative flex items-center w-full",children:[p,j,l]}),e[21]=j,e[22]=l,e[23]=p,e[24]=a):a=e[24],a};function te(u,e){const c=se.c(4),[F,x]=f.useState(u);let g,d;return c[0]!==e||c[1]!==u?(g=()=>{const E=setTimeout(()=>{x(u)},e);return()=>{clearTimeout(E)}},d=[u,e],c[0]=e,c[1]=u,c[2]=g,c[3]=d):(g=c[2],d=c[3]),f.useEffect(g,d),F}const ne=u=>{const e=se.c(56),{searchTerm:c,setSearchTerm:F,sortKey:x,setSortKey:g,sortOptions:d,sortOrder:E,setSortOrder:D,startDate:M,setStartDate:m,endDate:$,setEndDate:h,onClearFilters:k}=u,{theme:i}=K();let N;e[0]!==F?(N=G=>F(G.target.value),e[0]=F,e[1]=N):N=e[1];let p;e[2]!==c||e[3]!==N?(p=t.jsx("div",{className:`flex-shrink-0 p-2  ${S.theme.border.right} `,children:t.jsx("input",{type:"text",placeholder:"Suchen...",value:c,onChange:N,className:"bg-transparent focus:outline-none w-48"})}),e[2]=c,e[3]=N,e[4]=p):p=e[4];let C;e[5]===Symbol.for("react.memo_cache_sentinel")?(C=t.jsx("label",{htmlFor:"startDate",className:"whitespace-nowrap",children:"Filter von"}),e[5]=C):C=e[5];let y;e[6]!==m?(y=G=>m(G.target.value),e[6]=m,e[7]=y):y=e[7];let v;e[8]!==M||e[9]!==y?(v=t.jsx("input",{id:"startDate",type:"date",value:M,onChange:y,className:"bg-transparent focus:outline-none uppercase"}),e[8]=M,e[9]=y,e[10]=v):v=e[10];let L;e[11]===Symbol.for("react.memo_cache_sentinel")?(L=t.jsx("label",{htmlFor:"endDate",children:"bis"}),e[11]=L):L=e[11];let b;e[12]!==h?(b=G=>h(G.target.value),e[12]=h,e[13]=b):b=e[13];let j;e[14]!==$||e[15]!==b?(j=t.jsx("input",{id:"endDate",type:"date",value:$,onChange:b,className:"bg-transparent focus:outline-none uppercase"}),e[14]=$,e[15]=b,e[16]=j):j=e[16];let w;e[17]!==v||e[18]!==j?(w=t.jsxs("div",{className:`flex-shrink-0 flex items-center gap-4 p-2 px-4  ${S.theme.border.right}`,children:[C,v,L,j]}),e[17]=v,e[18]=j,e[19]=w):w=e[19];let O;e[20]===Symbol.for("react.memo_cache_sentinel")?(O=t.jsx("span",{className:"whitespace-nowrap",children:"Sortieren nach"}),e[20]=O):O=e[20];let R;e[21]===Symbol.for("react.memo_cache_sentinel")?(R=t.jsx(oe,{}),e[21]=R):R=e[21];let A;e[22]===Symbol.for("react.memo_cache_sentinel")?(A=t.jsxs(me,{className:"inline-flex items-center justify-center gap-2 bg-transparent focus:outline-none",children:[R,t.jsx(he,{children:t.jsx(le,{size:16})})]}),e[22]=A):A=e[22];const s=`overflow-hidden ${i==="dark"?"bg-black text-white ":"bg-white text-black"}  ${S.theme.border.default}`;let l;e[23]===Symbol.for("react.memo_cache_sentinel")?(l=t.jsx(de,{className:"flex items-center justify-center h-6 cursor-default",children:t.jsx(ce,{})}),e[23]=l):l=e[23];let a;if(e[24]!==d||e[25]!==i){let G;e[27]!==i?(G=U=>t.jsx(fe,{value:U.value,"aria-label":U.label,className:`text-sm leading-none flex items-center h-6 pr-8 pl-6 relative select-none data-[highlighted]:outline-none ${i==="dark"?"data-[highlighted]:bg-red-300 data-[highlighted]:text-black":"data-[highlighted]:bg-red-600 data-[highlighted]:text-white"}`,children:t.jsx(ue,{children:U.label})},U.value),e[27]=i,e[28]=G):G=e[28],a=d.map(G),e[24]=d,e[25]=i,e[26]=a}else a=e[26];let r;e[29]!==a?(r=t.jsx(xe,{className:"p-1",children:a}),e[29]=a,e[30]=r):r=e[30];let n;e[31]===Symbol.for("react.memo_cache_sentinel")?(n=t.jsx(ge,{className:"flex items-center justify-center h-6 cursor-default",children:t.jsx(le,{})}),e[31]=n):n=e[31];let o;e[32]!==s||e[33]!==r?(o=t.jsx(pe,{children:t.jsxs(be,{className:s,children:[l,r,n]})}),e[32]=s,e[33]=r,e[34]=o):o=e[34];let T;e[35]!==g||e[36]!==x||e[37]!==o?(T=t.jsxs(je,{value:x,"aria-label":"Sortieren nach",onValueChange:g,children:[A,o]}),e[35]=g,e[36]=x,e[37]=o,e[38]=T):T=e[38];let z;e[39]!==D||e[40]!==E?(z=()=>D(E==="asc"?"desc":"asc"),e[39]=D,e[40]=E,e[41]=z):z=e[41];const H=E==="asc"?"(Aufsteigend)":"(Absteigend)";let B;e[42]!==z||e[43]!==H?(B=t.jsx("button",{onClick:z,"aria-label":"Sortieren nach",className:"whitespace-nowrap",children:H}),e[42]=z,e[43]=H,e[44]=B):B=e[44];let V;e[45]!==T||e[46]!==B?(V=t.jsxs("div",{className:`flex-shrink-0 flex items-center gap-4 p-2 px-4  ${S.theme.border.right}`,children:[O,T,B]}),e[45]=T,e[46]=B,e[47]=V):V=e[47];const Q=`${i==="dark"?"text-red-300":"text-red-600"} underline underline-offset-4 whitespace-nowrap hover:underline`;let P;e[48]!==k||e[49]!==Q?(P=t.jsx("div",{className:"flex-shrink-0 p-2 px-4",children:t.jsx("button",{onClick:k,"aria-label":"Alle Filter löschen",className:Q,children:"Filter löschen"})}),e[48]=k,e[49]=Q,e[50]=P):P=e[50];let _;return e[51]!==p||e[52]!==V||e[53]!==P||e[54]!==w?(_=t.jsxs("div",{className:"flex items-center w-full",children:[p,w,V,P]}),e[51]=p,e[52]=V,e[53]=P,e[54]=w,e[55]=_):_=e[55],_},ze=()=>{const[u,e]=ie(),[c,F]=f.useState(u.get("tab")||"images"),[x,g]=f.useState(u.get("search")||""),[d,E]=f.useState(u.get("sortBy")||"createDate"),[D,M]=f.useState(u.get("gallerySortBy")||"title"),[m,$]=f.useState(u.get("sortOrder")||"desc"),[h,k]=f.useState(u.get("startDate")||""),[i,N]=f.useState(u.get("endDate")||""),p=te(x,300),C=te(h,300),y=te(i,300),{theme:v}=K();f.useEffect(()=>{const s=new URLSearchParams;c!=="images"&&s.set("tab",c),p&&s.set("search",p),d!=="createDate"&&s.set("sortBy",d),D!=="title"&&s.set("gallerySortBy",D),m!=="desc"&&s.set("sortOrder",m),C&&s.set("startDate",C),y&&s.set("endDate",y),e(s,{replace:!0})},[c,p,d,D,m,C,y,e]);const L=()=>{g(""),E("createDate"),M("title"),$("desc"),k(""),N("")},b=f.useMemo(()=>{const s=[];return X.forEach(l=>{l.images?.forEach((a,r)=>{s.push({...a,galleryTitle:l.title,gallerySlug:l.slug,index:r+1})})}),s},[]),j=f.useMemo(()=>{let s=b;if(x){const l=x.toLowerCase().split(" ").filter(Boolean);l.length>0&&(s=s.filter(a=>{const r=`${a.galleryTitle.toLowerCase()} ${a.filename?a.filename.toLowerCase():""}`;return l.every(n=>r.includes(n))}))}if(h){const l=new Date(h);l.setHours(0,0,0,0),s=s.filter(a=>{const r=I(a.createDate);return r&&r>=l})}if(i){const l=new Date(i);l.setHours(23,59,59,999),s=s.filter(a=>{const r=I(a.createDate);return r&&r<=l})}return[...s].sort((l,a)=>{const r=d==="createDate"?I(l.createDate):l.galleryTitle,n=d==="createDate"?I(a.createDate):a.galleryTitle;return r===null?1:n===null?-1:r<n?m==="asc"?-1:1:r>n?m==="asc"?1:-1:0})},[b,x,d,m,h,i]),w=f.useMemo(()=>{let s=X.map(l=>({...l,createDate:l.images?.[0]?.createDate}));if(x){const l=x.toLowerCase();s=s.filter(a=>{const r=a.title.toLowerCase().includes(l),n=a.images.some(o=>o.filename.toLowerCase().includes(l));return r||n})}if(h||i){const l=h?new Date(h):null;l&&l.setHours(0,0,0,0);const a=i?new Date(i):null;a&&a.setHours(23,59,59,999),s=s.filter(r=>b.filter(n=>{const o=I(n.createDate),T=h?new Date(h):null,z=i?new Date(i):null;return!(T&&o&&o<T||z&&o&&o>z)}).some(n=>n.gallerySlug===r.slug))}return[...s].sort((l,a)=>{const r=D==="createDate"?I(l.createDate):l.title,n=D==="createDate"?I(a.createDate):a.title;return r===null?1:n===null?-1:r<n?m==="asc"?-1:1:r>n?m==="asc"?1:-1:0})},[x,D,m,h,i]),O=f.useMemo(()=>{const s={};return X.forEach(l=>{l.images&&l.images.length>0?s[l.slug]=l.images[Math.floor(Math.random()*l.images.length)]:s[l.slug]=null}),s},[]),R=[{value:"createDate",label:"Datum"},{value:"galleryTitle",label:"Name"}],A=[{value:"title",label:"Name"},{value:"createDate",label:"Datum"}];return t.jsxs("div",{className:"p-4 md:px-8",children:[t.jsx("title",{children:`Liste aller Fotos und Galerien | ${S.meta.title}`}),t.jsx("meta",{name:"title",content:`Liste aller Fotos und Galerien | ${S.meta.title}`}),t.jsx("meta",{name:"description",content:"Eine Liste aller Fotos und Galerien. Sortierbar und Filterbar."}),t.jsxs("div",{className:`flex gap-4 ${S.theme.border.bottom}`,children:[t.jsx("button",{className:W(`${S.theme.headline.one} py-2 sm:py-4 ${c==="images"?K().theme==="dark"?`${S.theme.dark.text.primary}`:`${S.theme.light.text.primary}`:K().theme==="dark"?"text-white":"text-black"}`),onClick:()=>F("images"),children:"Fotos"}),t.jsx("button",{className:W(`${S.theme.headline.one} py-2 sm:py-4 ${c==="galleries"?K().theme==="dark"?`${S.theme.dark.text.primary}`:`${S.theme.light.text.primary}`:K().theme==="dark"?"text-white":"text-black"}`),onClick:()=>F("galleries"),children:"Serien"})]}),c==="images"&&t.jsxs("div",{className:"",children:[t.jsx(re,{className:`items-center ${S.theme.border.bottom} py-5 `,children:t.jsx(ne,{searchTerm:x,setSearchTerm:g,sortKey:d,setSortKey:E,sortOptions:R,sortOrder:m,setSortOrder:$,startDate:h,setStartDate:k,endDate:i,setEndDate:N,onClearFilters:L})}),t.jsxs("div",{className:"py-4 text-xs",children:[j.length," ",j.length===1?"Foto":"Fotos"," gefunden"]}),t.jsx("div",{className:"flex flex-col lg:flex-row lg:flex-wrap",children:j.map(s=>t.jsx("div",{className:"w-full lg:w-1/2",children:t.jsxs("div",{className:"flex lg:flex-row items-center gap-4 py-2",children:[t.jsx(Y,{className:"block min-w-24 min-h-24 lg:w-24 lg:h-24 flex-shrink-0",to:`/gallery/${s.gallerySlug}/image/${Z(s.filename.replace(/\.[^/.]+$/,""))}`,children:t.jsx("img",{loading:"lazy",src:ee(s.gallerySlug,s.filename.replaceAll(" ","_"),160),alt:s.alt||`${s.galleryTitle} - ${s.filename}`,width:128,height:128,className:W(`${v==="dark"?"text-white bg-white/10":"text-black bg-black/10"} lg:w-24 lg:h-24 min-w-24 min-h-24 w-24 h-24 object-cover `)})}),t.jsxs("div",{className:"text-sm md:pr-4",children:[t.jsx(Y,{to:`/gallery/${s.gallerySlug}/image/${Z(s.filename.replace(/\.[^/.]+$/,""))}`,children:t.jsx("h3",{className:"truncate text-base",children:s.filename.replaceAll(".jpg","")})}),t.jsxs("div",{className:"flex items-center  space-x-2  flex-wrap",children:[t.jsxs("p",{className:"flex items-center gap-1 text-[11px] mt-1",children:[t.jsx(Ce,{size:12}),t.jsx(q,{to:`/gallery/${s.gallerySlug}`,children:s.galleryTitle})]}),t.jsxs("p",{className:"flex items-center gap-1 text-[11px] mt-1",children:[t.jsx($e,{size:12})," ",t.jsx(q,{hasDecoration:!0,to:`/app/timeline?scrollTo=${I(s.createDate)?.toISOString().split("T")[0]}`,children:I(s.createDate)&&new Date(I(s.createDate)).toLocaleDateString("de-DE",{year:"numeric",month:"long",day:"numeric"})})]}),t.jsx("p",{className:"flex items-center gap-1 text-[11px] mt-1",children:s.latitude&&s.longitude?t.jsxs(t.Fragment,{children:[t.jsx(ae,{size:12}),t.jsx(q,{target:"_self",className:"",href:`/app/map?gallery=${s.gallerySlug}&image=${Z(s.filename.replace(/\.[^/.]+$/,""))}`,children:`${s.latitude.toFixed(3)}, ${s.longitude.toFixed(3)}`})]}):t.jsxs(t.Fragment,{children:[t.jsx(ae,{size:12}),t.jsx("span",{className:"truncate",children:"N/A"})]})}),t.jsxs(q,{className:"flex items-center gap-1 text-[11px] mt-1",href:ee(s.gallerySlug,s.filename.replaceAll(" ","_"),"original"),download:!0,children:[t.jsx(ye,{size:12}),t.jsx("span",{className:"",children:"Download"})]})]})]})]})},`${s.gallerySlug}-${s.filename}`))})]}),c==="galleries"&&t.jsxs("div",{children:[t.jsx(re,{className:`items-center  ${S.theme.border.bottom} py-5 `,children:t.jsx(ne,{searchTerm:x,setSearchTerm:g,sortKey:D,setSortKey:M,sortOptions:A,sortOrder:m,setSortOrder:$,startDate:h,setStartDate:k,endDate:i,setEndDate:N,onClearFilters:L})}),t.jsxs("div",{className:"py-4 text-xs",children:[w.length," ",w.length===1?"Galerie":"Galerien"," gefunden"]}),t.jsx("div",{className:"flex flex-col lg:flex-row lg:flex-wrap",children:w.map((s,l)=>{const a=O[s.slug];return t.jsxs("div",{className:"w-full lg:w-1/2",children:[t.jsxs(Y,{to:`/gallery/${s.slug}`,className:"flex lg:flex-row items-center gap-4 py-2",children:[a?t.jsx("img",{loading:"lazy",src:ee(s.slug,a.filename.replaceAll(" ","_"),160),alt:s.title,width:128,height:128,className:W(`${v==="dark"?"text-white bg-white/10":"text-black bg-black/10"} lg:w-24 lg:h-24 min-w-24 min-h-24 w-24 h-24 object-cover `)}):t.jsx("div",{className:"lg:w-24 lg:h-24 w-24 h-24 bg-gray-200 dark:bg-gray-700 flex items-center justify-center",children:t.jsx("span",{className:"text-xs text-gray-500",children:"Kein Bild"})}),t.jsxs("div",{className:"text-sm",children:[t.jsx("h3",{className:"truncate text-lg ",children:s.title}),t.jsxs("p",{className:"truncate",children:[s.images?.length||0," Bilder"]}),t.jsxs("p",{className:"truncate",children:["Erstellt: ",I(s.createDate)?.toLocaleDateString()||"N/V"]})]})]}),l<w.length-1&&""]},l)})})]})]})};export{ze as default};
