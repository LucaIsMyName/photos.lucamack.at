import{h as q,c as Y,u as B,r as z,j as a,L as W,g as H,C as Z}from"./index-CEQ1Ji3z.js";import{M as ee}from"./map-pin-BrO8J1B0.js";import{E as te}from"./eye-DJWbpQ4o.js";import{S as se}from"./SeoHead-CZrTM1H9.js";import"./mapbox-gl-CNTiHEyl.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],re=q("calendar",ae),le=n=>{const e=Y.c(44),{onApiKeySet:t}=n,{theme:i}=B(),[s,m]=z.useState(""),[o,c]=z.useState(!1);let d;e[0]!==s||e[1]!==t?(d=async()=>{if(s.trim()){if(c(!0),!s.startsWith("AIza")){alert('Invalid API key format. Google Vision API keys should start with "AIza"'),c(!1);return}localStorage.setItem("google-vision-api-key",s.trim()),setTimeout(()=>{t(s.trim()),c(!1)},500)}},e[0]=s,e[1]=t,e[2]=d):d=e[2];const b=d,h=`max-w-md mx-auto p-8 ${i==="dark"?"bg-black text-white":"bg-white text-black"} border ${i==="dark"?"border-white":"border-black"}`,l=`text-xl font-semibold mb-6 text-center ${i==="dark"?"text-white":"text-black"}`;let r;e[3]!==l?(r=a.jsx("h2",{className:l,children:"Google Vision API Key Required"}),e[3]=l,e[4]=r):r=e[4];const u=`block text-sm font-medium mb-2 ${i==="dark"?"text-white":"text-black"}`;let f;e[5]!==u?(f=a.jsx("label",{htmlFor:"apiKey",className:u,children:"API Key"}),e[5]=u,e[6]=f):f=e[6];let w;e[7]===Symbol.for("react.memo_cache_sentinel")?(w=Q=>m(Q.target.value),e[7]=w):w=e[7];const g=`w-full px-3 py-2 border focus:outline-none ${i==="dark"?"border-white bg-black text-white focus:border-red-500":"border-black bg-white text-black focus:border-red-500"}`;let y;e[8]!==s||e[9]!==g?(y=a.jsx("input",{type:"password",id:"apiKey",value:s,onChange:w,placeholder:"Enter your Google Vision API key",className:g}),e[8]=s,e[9]=g,e[10]=y):y=e[10];let x;e[11]!==f||e[12]!==y?(x=a.jsxs("div",{className:"mb-6",children:[f,y]}),e[11]=f,e[12]=y,e[13]=x):x=e[13];let k;e[14]!==s||e[15]!==o?(k=!s.trim()||o,e[14]=s,e[15]=o,e[16]=k):k=e[16];const M=`w-full font-medium py-2 px-4 transition-colors ${!s.trim()||o?i==="dark"?"bg-gray-800 text-gray-500":"bg-gray-200 text-gray-400":"bg-red-600 hover:bg-red-700 text-white"}`,C=o?"Validating...":"Set API Key";let v;e[17]!==b||e[18]!==k||e[19]!==M||e[20]!==C?(v=a.jsx("button",{onClick:b,disabled:k,className:M,children:C}),e[17]=b,e[18]=k,e[19]=M,e[20]=C,e[21]=v):v=e[21];const j=`mt-8 p-4 border ${i==="dark"?"border-white":"border-black"}`,A=`text-sm font-medium mb-2 ${i==="dark"?"text-white":"text-black"}`;let I;e[22]!==A?(I=a.jsx("h3",{className:A,children:"How to get your API key:"}),e[22]=A,e[23]=I):I=e[23];const E=`text-sm space-y-1 list-decimal list-inside ${i==="dark"?"text-white":"text-black"}`;let D,R,P,K,_;e[24]===Symbol.for("react.memo_cache_sentinel")?(D=a.jsxs("li",{children:["Go to ",a.jsx("a",{href:"https://console.cloud.google.com/",target:"_blank",rel:"noopener noreferrer",className:"underline text-red-600",children:"Google Cloud Console"})]}),R=a.jsx("li",{children:"Create a new project or select an existing one"}),P=a.jsx("li",{children:'Enable the "Cloud Vision API"'}),K=a.jsx("li",{children:'Go to "Credentials" and create an API key'}),_=a.jsx("li",{children:'Restrict the key to "Cloud Vision API" only'}),e[24]=D,e[25]=R,e[26]=P,e[27]=K,e[28]=_):(D=e[24],R=e[25],P=e[26],K=e[27],_=e[28]);let N;e[29]!==E?(N=a.jsxs("ol",{className:E,children:[D,R,P,K,_]}),e[29]=E,e[30]=N):N=e[30];const T=`text-xs mt-2 ${i==="dark"?"text-gray-300":"text-gray-600"}`;let S;e[31]!==T?(S=a.jsx("p",{className:T,children:"Your API key is stored locally and never sent to our servers."}),e[31]=T,e[32]=S):S=e[32];let $;e[33]!==j||e[34]!==I||e[35]!==N||e[36]!==S?($=a.jsxs("div",{className:j,children:[I,N,S]}),e[33]=j,e[34]=I,e[35]=N,e[36]=S,e[37]=$):$=e[37];let L;return e[38]!==x||e[39]!==v||e[40]!==h||e[41]!==$||e[42]!==r?(L=a.jsxs("div",{className:h,children:[r,x,v,$]}),e[38]=x,e[39]=v,e[40]=h,e[41]=$,e[42]=r,e[43]=L):L=e[43],L},ne=(n,e,t="original")=>{const i=encodeURI(e.replaceAll(" ","_"));if(t==="original")return`/content/galleries/${n}/${i}`;const s=e.split(".").pop()?.toLowerCase(),m=e.replace(/\.[^/.]+$/,"").replaceAll(" ","_");return`/content/galleries/${n}/${m}-${t}w.${s}`},oe=n=>{const e=Y.c(18),{images:t,message:i}=n,{theme:s}=B(),m=ie;if(t.length===0){const h=`text-center py-8 ${s==="light"?"text-gray-500":"text-gray-400"}`;let l;e[0]!==i?(l=a.jsx("p",{children:i}),e[0]=i,e[1]=l):l=e[1];let r;return e[2]!==h||e[3]!==l?(r=a.jsx("div",{className:h,children:l}),e[2]=h,e[3]=l,e[4]=r):r=e[4],r}let o;e[5]!==i||e[6]!==s?(o=i&&a.jsx("div",{className:"p-3 border ",children:a.jsx("p",{className:"font-medium",children:i})}),e[5]=i,e[6]=s,e[7]=o):o=e[7];let c;if(e[8]!==t||e[9]!==s){let h;e[11]!==s?(h=(l,r)=>a.jsxs("div",{className:`border overflow-hidden ${s==="dark"?"bg-black border-white":"bg-white border-black"}`,children:[a.jsx(W,{to:`/gallery/${l.gallerySlug}/image/${encodeURIComponent(l.filename.replace(/\.[^/.]+$/,""))}`,children:a.jsx("div",{className:"aspect-square overflow-hidden",children:a.jsx("img",{src:ne(l.gallerySlug,l.filename,"380"),alt:l.filename,className:"w-full h-full object-cover hover:scale-105 transition-transform duration-300",loading:"lazy"})})}),a.jsxs("div",{className:"p-3 space-y-2",children:[a.jsx("h3",{className:`font-medium text-sm truncate ${s==="dark"?"text-white":"text-black"}`,children:l.filename.replace(/\.[^/.]+$/,"")}),a.jsx(W,{to:`/gallery/${l.gallerySlug}`,className:`text-xs underline ${s==="dark"?"text-red-400 hover:text-red-300":"text-red-600 hover:text-red-700"}`,children:l.galleryTitle}),a.jsxs("div",{className:"flex flex-wrap gap-2 text-xs",children:[l.createDate&&a.jsxs("div",{className:`flex items-center gap-1 ${s==="dark"?"text-gray-300":"text-gray-600"}`,children:[a.jsx(re,{size:12}),m(l.createDate)]}),l.latitude&&l.longitude&&a.jsxs("div",{className:`flex items-center gap-1 ${s==="dark"?"text-gray-300":"text-gray-600"}`,children:[a.jsx(ee,{size:12}),"GPS"]})]}),l.aiAnalysis&&l.aiAnalysis.labels.length>0&&a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:`flex items-center gap-1 text-xs ${s==="dark"?"text-gray-300":"text-gray-600"}`,children:[a.jsx(te,{size:12}),"AI erkannt:"]}),a.jsx("div",{className:"flex flex-wrap gap-1",children:l.aiAnalysis.labels.slice(0,3).map((u,f)=>a.jsx("span",{className:`px-2 py-1 text-xs border ${s==="dark"?"border-white text-white":"border-black text-black"}`,children:u.description},f))})]})]})]},`${l.gallerySlug}-${l.filename}-${r}`),e[11]=s,e[12]=h):h=e[12],c=t.map(h),e[8]=t,e[9]=s,e[10]=c}else c=e[10];let d;e[13]!==c?(d=a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c}),e[13]=c,e[14]=d):d=e[14];let b;return e[15]!==o||e[16]!==d?(b=a.jsxs("div",{className:"space-y-4",children:[o,d]}),e[15]=o,e[16]=d,e[17]=b):b=e[17],b};function ie(n){return new Date(n).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"})}const ce=n=>{const e=Y.c(58),{messages:t,onSendMessage:i,isLoading:s,apiKey:m,onApiKeyChange:o}=n,{theme:c}=B(),[d,b]=z.useState(""),h=z.useRef(null),l=z.useRef(null);let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=()=>{h.current?.scrollIntoView({behavior:"smooth"})},e[0]=r):r=e[0];let u;e[1]!==s||e[2]!==t?(u=[t,s],e[1]=s,e[2]=t,e[3]=u):u=e[3],z.useEffect(r,u);let f,w;e[4]===Symbol.for("react.memo_cache_sentinel")?(f=()=>{l.current?.focus()},w=[],e[4]=f,e[5]=w):(f=e[4],w=e[5]),z.useEffect(f,w);let g;e[6]!==d||e[7]!==s||e[8]!==i?(g=p=>{p.preventDefault(),!(!d.trim()||s)&&(i(d.trim()),b(""))},e[6]=d,e[7]=s,e[8]=i,e[9]=g):g=e[9];const y=g;let x;e[10]===Symbol.for("react.memo_cache_sentinel")?(x=["Show me images from May 2023","Find photos with trees","3 random images from 'vacation' gallery","Images taken in Vienna","Photos with people from last year"],e[10]=x):x=e[10];const k=x;let M;e[11]!==i?(M=p=>{b(p),i(p)},e[11]=i,e[12]=M):M=e[12];const C=M,v=`flex flex-col h-full w-full ${c==="dark"?"bg-black text-white":"bg-white text-black"}`;let j;e[13]!==m||e[14]!==o?(j=()=>{const p=prompt("Enter new Google Vision API key:",m);p!==null&&(p.trim()?(localStorage.setItem("google-vision-api-key",p.trim()),o(p.trim())):(localStorage.removeItem("google-vision-api-key"),o("")))},e[13]=m,e[14]=o,e[15]=j):j=e[15];const A=`px-3 py-1 text-xs border ${c==="dark"?"border-white text-white hover:bg-white hover:text-black":"border-black text-black hover:bg-black hover:text-white"} transition-colors`;let I;e[16]!==A||e[17]!==j?(I=a.jsx("div",{className:"absolute top-4 right-4 z-10",children:a.jsx("button",{onClick:j,className:A,children:"Change API Key"})}),e[16]=A,e[17]=j,e[18]=I):I=e[18];let E;e[19]!==C||e[20]!==t.length||e[21]!==c?(E=t.length===0&&a.jsx("div",{className:"flex flex-col items-center justify-center h-full",children:a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 max-w-2xl mx-auto",children:k.map((p,V)=>a.jsx("button",{onClick:()=>C(p),className:`p-3 text-sm text-left border transition-colors ${c==="dark"?"border-white text-white hover:bg-white hover:text-black":"border-black text-black hover:bg-black hover:text-white"}`,children:p},V))})}),e[19]=C,e[20]=t.length,e[21]=c,e[22]=E):E=e[22];let D;if(e[23]!==t||e[24]!==c){let p;e[26]!==c?(p=(V,X)=>a.jsx("div",{className:`flex ${V.type==="user"?"justify-end":"justify-start"}`,children:a.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 ${V.type==="user"?"bg-red-600 text-white":c==="dark"?"bg-white text-black":"bg-black text-white"}`,children:[a.jsx("p",{className:"text-sm",children:V.content}),V.results&&V.results.length>0&&a.jsx("div",{className:"mt-3",children:a.jsx(oe,{images:V.results,message:""})})]})},X),e[26]=c,e[27]=p):p=e[27],D=t.map(p),e[23]=t,e[24]=c,e[25]=D}else D=e[25];let R;e[28]===Symbol.for("react.memo_cache_sentinel")?(R=a.jsx("div",{ref:h}),e[28]=R):R=e[28];let P;e[29]!==E||e[30]!==D?(P=a.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",ref:h,children:[E,D,R]}),e[29]=E,e[30]=D,e[31]=P):P=e[31];const K=`border-t p-4 ${c==="dark"?"border-white":"border-black"}`;let _;e[32]===Symbol.for("react.memo_cache_sentinel")?(_=p=>b(p.target.value),e[32]=_):_=e[32];let N;e[33]!==y?(N=p=>p.key==="Enter"&&y(p),e[33]=y,e[34]=N):N=e[34];const T=`flex-1 px-3 py-2 border focus:outline-none ${c==="dark"?"border-white bg-black text-white focus:border-red-500":"border-black bg-white text-black focus:border-red-500"}`;let S;e[35]!==d||e[36]!==s||e[37]!==N||e[38]!==T?(S=a.jsx("input",{ref:l,type:"text",value:d,onChange:_,onKeyPress:N,placeholder:"Ask about your photos...",disabled:s,className:T}),e[35]=d,e[36]=s,e[37]=N,e[38]=T,e[39]=S):S=e[39];let $;e[40]!==y?($=p=>y(p),e[40]=y,e[41]=$):$=e[41];const L=!d.trim()||s,Q=`px-4 py-2 transition-colors ${!d.trim()||s?c==="dark"?"bg-gray-800 text-gray-500":"bg-gray-200 text-gray-400":"bg-red-600 hover:bg-red-700 text-white"}`,J=s?"Sending...":"Send";let G;e[42]!==$||e[43]!==L||e[44]!==Q||e[45]!==J?(G=a.jsx("button",{onClick:$,disabled:L,className:Q,children:J}),e[42]=$,e[43]=L,e[44]=Q,e[45]=J,e[46]=G):G=e[46];let F;e[47]!==S||e[48]!==G?(F=a.jsxs("div",{className:"flex space-x-2",children:[S,G]}),e[47]=S,e[48]=G,e[49]=F):F=e[49];let O;e[50]!==K||e[51]!==F?(O=a.jsx("div",{className:K,children:F}),e[50]=K,e[51]=F,e[52]=O):O=e[52];let U;return e[53]!==I||e[54]!==P||e[55]!==O||e[56]!==v?(U=a.jsxs("div",{className:v,children:[I,P,O]}),e[53]=I,e[54]=P,e[55]=O,e[56]=v,e[57]=U):U=e[57],U};class de{apiKey;baseUrl="https://vision.googleapis.com/v1/images:annotate";constructor(e){this.apiKey=e}async analyzeImage(e){try{const t=await fetch(`${this.baseUrl}?key=${this.apiKey}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({requests:[{image:{source:{imageUri:e}},features:[{type:"LABEL_DETECTION",maxResults:10},{type:"TEXT_DETECTION",maxResults:1}]}]})});if(!t.ok)throw new Error(`API request failed: ${t.status} ${t.statusText}`);const s=(await t.json()).responses[0];if(s.error)throw new Error(`Vision API error: ${s.error.message}`);return{labels:s.labelAnnotations?.map(m=>({description:m.description.toLowerCase(),confidence:m.score}))||[],text:s.textAnnotations?.[0]?.description||void 0}}catch(t){return console.error("Error analyzing image:",t),{labels:[],error:t instanceof Error?t.message:"Unknown error occurred"}}}async analyzeImages(e){const i=[];for(let s=0;s<e.length;s+=5){const o=e.slice(s,s+5).map(d=>this.analyzeImage(d)),c=await Promise.all(o);i.push(...c),s+5<e.length&&await new Promise(d=>setTimeout(d,100))}return i}}class me{visionService;analysisCache=new Map;constructor(e){this.visionService=new de(e),this.loadCachedAnalysis()}loadCachedAnalysis(){try{const e=localStorage.getItem("vision-analysis-cache");if(e){const t=JSON.parse(e);this.analysisCache=new Map(t)}}catch(e){console.error("Error loading cached analysis:",e)}}saveCachedAnalysis(){try{const e=Array.from(this.analysisCache.entries());localStorage.setItem("vision-analysis-cache",JSON.stringify(e))}catch(e){console.error("Error saving cached analysis:",e)}}async processQuery(e){const t=this.parseQuery(e.toLowerCase());let s=[...H.flatMap(m=>m.images.map(o=>({...o,gallerySlug:m.slug,galleryTitle:m.title})))];if(t.dateRange&&(s=s.filter(m=>{if(!m.createDate)return!1;const o=new Date(m.createDate);return o>=t.dateRange.start&&o<=t.dateRange.end})),t.location){const m=t.location.toLowerCase();s=s.filter(o=>{const c=H.find(d=>d.slug===o.gallerySlug);return c?.tags?c.tags.some(d=>d.toLowerCase().includes(m)):c?.title.toLowerCase().includes(m)||!1})}return t.galleryNames&&t.galleryNames.length>0&&(s=s.filter(m=>{const o=H.find(c=>c.slug===m.gallerySlug);return t.galleryNames.some(c=>o?.title.toLowerCase().includes(c)||o?.slug.toLowerCase().includes(c))})),t.content&&t.content.length>0&&(s=await this.filterByContent(s,t.content)),t.random&&t.limit?s=this.getRandomItems(s,t.limit):t.limit&&(s=s.slice(0,t.limit)),{type:"images",items:s,message:this.generateResponseMessage(s.length,t,e),totalFound:s.length}}parseQuery(e){const t={},i=[/(\d{1,2})\.?\s+(januar|februar|märz|april|mai|juni|juli|august|september|oktober|november|dezember)\s*(\d{4})/gi,/(\d{1,2})\.?\s*(\d{1,2})\.?\s*(\d{4})/g,/(\d{4})-(\d{1,2})-(\d{1,2})/g,/^.*(januar|februar|märz|april|mai|juni|juli|august|september|oktober|november|dezember)\s*(\d{4}).*$/gi];for(const h of i){const l=[...e.matchAll(h)];if(l.length>0){const r=l[0];if(r[3]&&r[2]&&r[1]){const u=parseInt(r[1]),f=r[2].toLowerCase(),w=parseInt(r[3]),y={januar:0,februar:1,märz:2,april:3,mai:4,juni:5,juli:6,august:7,september:8,oktober:9,november:10,dezember:11}[f];if(y!==void 0){const x=new Date(w,y,u);t.dateRange={start:new Date(x.getFullYear(),x.getMonth(),x.getDate(),0,0,0),end:new Date(x.getFullYear(),x.getMonth(),x.getDate(),23,59,59)};break}}else if(r[3]&&!isNaN(parseInt(r[1]))&&!isNaN(parseInt(r[2]))){const u=parseInt(r[1]),f=parseInt(r[2])-1,w=parseInt(r[3]),g=new Date(w,f,u);t.dateRange={start:new Date(g.getFullYear(),g.getMonth(),g.getDate(),0,0,0),end:new Date(g.getFullYear(),g.getMonth(),g.getDate(),23,59,59)};break}else if(r[1]&&r[2]&&r[3]&&r[1].length===4){const u=parseInt(r[1]),f=parseInt(r[2])-1,w=parseInt(r[3]),g=new Date(u,f,w);t.dateRange={start:new Date(g.getFullYear(),g.getMonth(),g.getDate(),0,0,0),end:new Date(g.getFullYear(),g.getMonth(),g.getDate(),23,59,59)};break}else if(r[2]&&!isNaN(parseInt(r[2]))){const u=parseInt(r[2]),f=r[1].toLowerCase(),g={januar:0,februar:1,märz:2,april:3,mai:4,juni:5,juli:6,august:7,september:8,oktober:9,november:10,dezember:11}[f];if(g!==void 0){t.dateRange={start:new Date(u,g,1),end:new Date(u,g+1,0,23,59,59)};break}}}}const s=[/(?:aus|von|in)\s+(wien|vienna|salzburg|burghausen|österreich|austria|deutschland|germany|schweiz|swiss|zürich|zurich|berlin|karlsruhe|bern)/gi,/wien|vienna|salzburg|burghausen|österreich|austria|deutschland|germany|schweiz|swiss|zürich|zurich|berlin|karlsruhe|bern/gi,/(\d+)\s*km\s*(?:um|around)/gi];for(const h of s){const l=e.match(h);if(l){t.location=l[0].replace(/(?:aus|von|in)\s+/gi,"").trim();break}}const m=[/(?:aus|von)\s+(?:der\s+)?["']([^"']+)["']\s*(?:galerie|gallery)/gi,/["']([^"']+)["']\s*(?:galerie|gallery)/gi,/\b(öffis|arsenal)\b(?:\s+(?:galerie|gallery))?\b/gi,/\bwien\s+(?:galerie|gallery)\b/gi],o=[];for(const h of m){const l=[...e.matchAll(h)];l.length>0&&l.forEach(r=>{const u=(r[1]||r[0]).toLowerCase().replace(/\s+(?:galerie|gallery)/,"").trim();u&&!o.includes(u)&&o.push(u)})}o.length>0&&(t.galleryNames=o);const d=["baum","bäume","tree","trees","regenbogen","rainbow","auto","car","cars","haus","häuser","house","houses","building","person","menschen","people","himmel","sky","wasser","water","blume","blumen","flower","flowers","baum","bäume","tree","trees","beton","betonelemente","concrete","concrete elements","glas","gläser","glass","glasses","person","menschen","people","tisch","tische","table","tables","stuhl","stühle","chair","chairs","lampe","lampen","lamp","lamps"].filter(h=>new RegExp(`\\b${h}\\b`,"i").test(e));d.length>0&&(t.content=d);const b=e.match(/(\d+)\s*(?:zufällige|random)\s*(?:bilder|fotos|images)/i);if(b)t.limit=parseInt(b[1]),t.random=!0;else{const h=e.match(/(\d+)\s*(?:bilder|fotos|images)/i);h&&(t.limit=parseInt(h[1]),t.random=!1)}return t}async filterByContent(e,t){const i=[];for(const s of e){const m=`${s.gallerySlug}/${s.filename}`;let o=this.analysisCache.get(m);if(!o){const c=`https://photos.lucamack.at/content/galleries/${s.gallerySlug}/${encodeURI(s.filename.replaceAll(" ","_"))}`;o=await this.visionService.analyzeImage(c),o.error||(this.analysisCache.set(m,o),this.saveCachedAnalysis())}o&&o.labels&&t.some(d=>o.labels.some(b=>{const h=b.description.toLowerCase(),l=this.translateContent(h),r=d.toLowerCase();return b.confidence>.7&&(h===r||l===r||h.includes(r)||l.includes(r))}))&&i.push({...s,aiAnalysis:o})}return i}translateContent(e){return{tree:"baum",building:"haus",car:"auto",person:"person",sky:"himmel",water:"wasser",flower:"blume"}[e.toLowerCase()]||e}getRandomItems(e,t){return[...e].sort(()=>.5-Math.random()).slice(0,t)}generateResponseMessage(e,t,i){if(e===0)return`Keine Bilder gefunden für "${i}". Versuche eine andere Suchanfrage.`;let s=`${e} Bild${e===1?"":"er"} gefunden`;if(t.dateRange){const m=t.dateRange.start.toLocaleDateString("de-DE");s+=` vom ${m}`}return t.location&&(s+=` aus ${t.location}`),t.content&&t.content.length>0&&(s+=` mit ${t.content.join(", ")}`),t.galleryNames&&t.galleryNames.length>0&&(s+=` aus der "${t.galleryNames.join('", "')}" Galerie`),s+"."}}const be=()=>{const n=Y.c(15),{theme:e}=B(),[t,i]=z.useState("");let s;n[0]===Symbol.for("react.memo_cache_sentinel")?(s=[],n[0]=s):s=n[0];const[m,o]=z.useState(s),[c,d]=z.useState(!1);let b,h;n[1]===Symbol.for("react.memo_cache_sentinel")?(b=()=>{const k=localStorage.getItem("google-vision-api-key");k&&i(k)},h=[],n[1]=b,n[2]=h):(b=n[1],h=n[2]),z.useEffect(b,h);let l;n[3]===Symbol.for("react.memo_cache_sentinel")?(l=k=>{i(k),k?localStorage.setItem("google-vision-api-key",k):localStorage.removeItem("google-vision-api-key")},n[3]=l):l=n[3];const r=l;let u;n[4]!==t?(u=async k=>{if(!t){alert("Please enter your Google Vision API key first.");return}const M={type:"user",content:k,timestamp:new Date};o(C=>[...C,M]),d(!0);try{const v=await new me(t).processQuery(k),j={type:"ai",content:v.message,timestamp:new Date,results:v.items};o(A=>[...A,j]),d(!1)}catch(C){console.error("Error processing message:",C);const j={type:"ai",content:"Sorry, there was an error processing your request. Please try again.",timestamp:new Date};o(A=>[...A,j]),d(!1)}},n[4]=t,n[5]=u):u=n[5];const f=u,w=`w-full h-full md:h-screen relative overflow-hidden ${e==="dark"?"bg-black text-white":"bg-white text-black"}`;let g;n[6]===Symbol.for("react.memo_cache_sentinel")?(g=a.jsx(se,{title:`AI Photo Intelligence | ${Z.meta.title}`,description:"AI-powered photo search and analysis"}),n[6]=g):g=n[6];let y;n[7]!==t||n[8]!==f||n[9]!==c||n[10]!==m?(y=t?a.jsx(ce,{messages:m,onSendMessage:f,isLoading:c,apiKey:t,onApiKeyChange:r}):a.jsx("div",{className:"flex items-center justify-center h-full",children:a.jsx(le,{onApiKeySet:i})}),n[7]=t,n[8]=f,n[9]=c,n[10]=m,n[11]=y):y=n[11];let x;return n[12]!==w||n[13]!==y?(x=a.jsxs("div",{className:w,children:[g,y]}),n[12]=w,n[13]=y,n[14]=x):x=n[14],x};export{be as default};
