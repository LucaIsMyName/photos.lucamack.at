import{c as R,d as T,g as S,s as N,u as P,r as k,j as e,p as w,C as n,b as c,a as x,L as D}from"./index-BDTGdGlU.js";import{M as U,a as E}from"./scale-control-CRTlSRJr.js";import{I as _}from"./Image-Cc8bg_BU.js";import{C as $}from"./CopyButton-B7qmbjEW.js";import{H as u}from"./Href-DDDWNMyL.js";import F from"./NotFoundPage-DKURrjDU.js";import"./mapbox-gl-CNTiHEyl.js";import"./check-C2s2JsUF.js";const O=()=>{const r=R.c(10),{gallerySlug:p,slug:t}=T();let s;e:{if(!p||!t){s=void 0;break e}let l,f;if(r[0]!==p||r[1]!==t){let i;if(r[5]!==p?(i=m=>m.slug===p,r[5]=p,r[6]=i):i=r[6],l=S.find(i),!l){s=void 0;break e}f=l.images?.find(m=>{const y=m.filename.replace(/\.[^/.]+$/,"");return N(y)===t}),r[0]=p,r[1]=t,r[2]=l,r[3]=f,r[4]=s}else l=r[2],f=r[3],s=r[4];const h=f;if(h){let i;r[7]!==l||r[8]!==h?(i={image:h,gallery:l},r[7]=l,r[8]=h,r[9]=i):i=r[9],s=i;break e}s=void 0}return s},Q=()=>{const{theme:r}=P(),p=O();if(k.useEffect(()=>{if(p){const{image:l,gallery:f}=p,h=document.createElement("script");h.type="application/ld+json",h.id="image-structured-data";const i={"@context":"https://schema.org","@type":"ImageObject",name:l.filename.replaceAll("_"," ").replace(".jpg","").trim(),description:`A photo from the gallery: ${f.title}`,contentUrl:`${n.url}${c(f.slug,encodeURI(l.filename.replaceAll(" ","_")),"original")}`,width:"1920",height:"1080",datePublished:l.createDate?w(l.createDate)?.toISOString().split("T")[0]||new Date().toISOString().split("T")[0]:new Date().toISOString().split("T")[0],dateCreated:l.createDate?w(l.createDate)?.toISOString().split("T")[0]||new Date().toISOString().split("T")[0]:new Date().toISOString().split("T")[0],author:{"@type":"Person",name:n.author,url:n.url},copyrightHolder:{"@type":"Person",name:n.author},license:"https://creativecommons.org/licenses/by-nc/4.0/",...l.latitude&&l.longitude&&{geo:{"@type":"GeoCoordinates",latitude:l.latitude,longitude:l.longitude}},...l.googleMapsUrl&&{sameAs:l.googleMapsUrl}};return h.innerHTML=JSON.stringify(i),document.head.appendChild(h),()=>{const m=document.getElementById("image-structured-data");m&&document.head.removeChild(m)}}},[p]),!p)return e.jsx(e.Fragment,{children:e.jsx(F,{title:"Foto nicht gefunden"})});const{image:t,gallery:s}=p,v=k.useMemo(()=>{if(!p)return[];const{image:l,gallery:f}=p,h=(o,a,d,g)=>{const A=(d-o)*(Math.PI/180),M=(g-a)*(Math.PI/180),C=Math.sin(A/2)*Math.sin(A/2)+Math.cos(o*(Math.PI/180))*Math.cos(d*(Math.PI/180))*Math.sin(M/2)*Math.sin(M/2);return 6371*(2*Math.atan2(Math.sqrt(C),Math.sqrt(1-C)))},i=new Set;i.add(l.filename);const m=[],y=S.flatMap(o=>o.images.map(a=>({...a,gallerySlug:o.slug}))).filter(o=>o.filename!==l.filename);l.latitude&&l.longitude&&y.filter(a=>!i.has(a.filename)&&a.latitude&&a.longitude).map(a=>({...a,distance:h(l.latitude,l.longitude,a.latitude,a.longitude),isNearestPick:!0})).sort((a,d)=>a.distance-d.distance).slice(0,2).forEach(a=>{a.colorData?.dominantColors&&(a.colorData.dominantColors=a.colorData.dominantColors.map(d=>({...d,rgb:d.rgb.slice(0,3)}))),m.push(a),i.add(a.filename)});const j=f.images.filter(o=>!i.has(o.filename)).map(o=>({...o,gallerySlug:f.slug,isSameGalleryPick:!0}));if(j.length>2)for(let o=j.length-1;o>0;o--){const a=Math.floor(Math.random()*(o+1));[j[o],j[a]]=[j[a],j[o]]}j.slice(0,2).forEach(o=>{o.colorData?.dominantColors&&(o.colorData.dominantColors=o.colorData.dominantColors.map(a=>({...a,rgb:a.rgb.slice(0,3)}))),m.push(o),i.add(o.filename)});const b=y.filter(o=>!i.has(o.filename));if(b.length>0){for(let a=b.length-1;a>0;a--){const d=Math.floor(Math.random()*(a+1));[b[a],b[d]]=[b[d],b[a]]}b.slice(0,2).map(a=>({...a,isRandomPick:!0})).forEach(a=>{a.colorData?.dominantColors&&(a.colorData.dominantColors=a.colorData.dominantColors.map(d=>({...d,rgb:d.rgb.slice(0,3)}))),m.push(a),i.add(a.filename)})}if(m.length<6){const o=6-m.length,a=y.filter(d=>!i.has(d.filename));if(a.length>0){for(let g=a.length-1;g>0;g--){const I=Math.floor(Math.random()*(g+1));[a[g],a[I]]=[a[I],a[g]]}a.slice(0,o).map(g=>({...g,isRandomPick:!0,isAdditionalRandomPick:!0})).forEach(g=>{m.push(g),i.add(g.filename)})}}for(let o=m.length-1;o>0;o--){const a=Math.floor(Math.random()*(o+1));[m[o],m[a]]=[m[a],m[o]]}return m},[p]);return e.jsxs("div",{className:"w-full md:max-w-[var(--content-width)] p-4 md:py-8 md:px-0  md:px-8  flex flex-col items-center",children:[e.jsx("title",{children:`${t.filename.replace("_"," ").replace(".jpg","").trim()} | ${s.title} | ${n.meta.title}`}),e.jsx("meta",{name:"title",content:`${t.filename.replace("_"," ").replace(".jpg","").trim()} | ${s.title} | ${n.meta.title}`}),e.jsx("meta",{name:"description",content:`${s.title} - ${t.filename.replace(".jpg","")}`}),e.jsx("meta",{name:"image",content:`${n.url}${c(s.slug,encodeURI(t.filename.replaceAll(" ","_")),640)}`}),e.jsx("meta",{name:"og:image",content:`${n.url}${c(s.slug,encodeURI(t.filename.replaceAll(" ","_")),640)}`}),e.jsx("meta",{name:"og:title",content:`${t.filename} | ${s.title} | ${n.meta.title}`}),e.jsx("meta",{name:"og:description",content:`${t.filename.replaceAll("_"," ").replace(".jpg","").trim()}`}),e.jsx("meta",{name:"og:url",content:`${window.location.origin}/gallery/${s.slug}/image/${N(t.filename)}`}),e.jsxs("div",{className:"w-full max-w-4xl flex flex-col gap-4",children:[e.jsx("div",{className:"flex items-center h-auto md:h-[85vh]",children:e.jsx(_,{src:c(s.slug,encodeURI(t.filename.replaceAll(" ","_"))),alt:t.filename.replaceAll("_"," ").replace(".jpg","").trim(),width:t.width,height:t.height,sizes:"(max-width: 768px) 100vw, 1024px",className:"max-h-full h-full max-w-full object-contain"})}),e.jsxs("div",{className:"flex flex-col gap-0 w-full",children:[e.jsx("h1",{className:"text-base md:text-3xl mb-4 text-balance",children:t.filename.replaceAll("_"," ").replace(".jpg","").trim()}),e.jsxs("div",{className:`flex w-full justify-between items-center gap-4 my-4 ${n.theme.border.top} pt-8`,children:[e.jsx("div",{className:"flex justify-start items-center gap-1 text-[11px] leading-[20px]",children:e.jsxs("div",{className:x("flex-1 flex justify-between  w-full items-center gap-4  "),children:[e.jsx(D,{to:`/gallery/${s.slug}`,children:e.jsx("img",{src:c(s.slug,encodeURI(s.images[0].filename.replaceAll(" ","_")),160),alt:s.title,className:"w-16 h-16 object-cover"})}),e.jsxs("div",{children:[e.jsx("div",{children:e.jsx(u,{to:`/gallery/${s.slug}`,className:"text-base truncate",hasDecoration:!1,children:s.title})}),t.createDate&&w(t.createDate)&&e.jsx(u,{to:`/app/timeline?scrollTo=${w(t.createDate)?.toISOString().split("T")[0]}`,className:x("text-[11px] font-mono truncate"),children:w(t.createDate)&&new Date(w(t.createDate)).toLocaleDateString("de-DE",{year:"numeric",month:"long",day:"numeric"})})]})]})}),e.jsx($,{className:" min-h-4 min-w-4 sm:flex-row-reverse",iconToRight:!1,textToCopy:window.location.href,children:e.jsx("span",{className:"text-[11px] text-nowrap hidden sm:block truncate font-mono",children:"URL Kopieren"})})]}),e.jsxs("div",{className:`flex flex-col lg:flex-row-reverse gap-8 mt-4 ${n.theme.border.top} pt-4 md:pt-8`,children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-base mb-2",children:"URLs"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[100px,1fr] gap-x-4 gap-y-3 text-sm",children:[e.jsx("div",{className:`text-[10px] tracking-wider font-mono pt-4 ${n.theme.border.top}`,children:"Original"}),e.jsxs("div",{className:x(`w-full justify-between flex items-center gap-2 font-mono pb-4 ${n.theme.border.bottom}`),children:[e.jsx(u,{href:c(s.slug,t.filename.replaceAll(" ","_"),"original"),hasDecoration:!1,className:x("truncate font-mono text-xs max-w-[calc(100%-40px)]"),children:`${n.url}${c(s.slug,encodeURI(t.filename.replaceAll(" ","_")),"original")}`}),e.jsx($,{className:"",textToCopy:`${n.url}${c(s.slug,encodeURI(t.filename.replaceAll(" ","_")),"original")}`})]}),e.jsx("div",{className:"text-[10px] tracking-wider font-mono",children:"1440 px"}),e.jsxs("div",{className:x(`w-full justify-between flex items-center gap-2 font-mono pb-4 ${n.theme.border.bottom}`),children:[e.jsx(u,{href:c(s.slug,t.filename.replaceAll(" ","_"),1440),hasDecoration:!1,className:x("truncate font-mono text-xs max-w-[calc(100%-40px)]"),children:`${n.url}${c(s.slug,encodeURI(t.filename.replaceAll(" ","_")),1440)}`}),e.jsx($,{textToCopy:window.location.href})]}),e.jsx("div",{className:"text-[10px] tracking-wider font-mono",children:"640 px"}),e.jsxs("div",{className:x(`w-full justify-between flex items-center gap-2 font-mono pb-4 ${n.theme.border.bottom}`),children:[e.jsx(u,{href:c(s.slug,t.filename.replaceAll(" ","_"),640),hasDecoration:!1,className:x("truncate font-mono text-xs max-w-[calc(100%-40px)]"),children:`${n.url}${c(s.slug,encodeURI(t.filename.replaceAll(" ","_")),640)}`}),e.jsx($,{textToCopy:`${n.url}${c(s.slug,encodeURI(t.filename.replaceAll(" ","_")),640)}`})]}),e.jsx("div",{className:"text-[10px] tracking-wider font-mono",children:"380 px"}),e.jsxs("div",{className:x(`w-full justify-between flex items-center gap-2 font-mono pb-4 ${n.theme.border.bottom}`),children:[e.jsx(u,{href:c(s.slug,t.filename.replaceAll(" ","_"),380),hasDecoration:!1,className:x("truncate font-mono text-xs max-w-[calc(100%-40px)]"),children:`${n.url}${c(s.slug,encodeURI(t.filename.replaceAll(" ","_")),380)}`}),e.jsx($,{textToCopy:`${n.url}${c(s.slug,encodeURI(t.filename.replaceAll(" ","_")),380)}`})]}),e.jsx("div",{className:"text-[10px] tracking-wider font-mono",children:"160 px"}),e.jsxs("div",{className:x(`w-full justify-between flex items-center gap-2 font-mono pb-4 ${n.theme.border.bottom}`),children:[e.jsx(u,{href:c(s.slug,t.filename.replaceAll(" ","_"),160),hasDecoration:!1,className:x("truncate font-mono text-xs max-w-[calc(100%-40px)]"),children:`${n.url}${c(s.slug,encodeURI(t.filename.replaceAll(" ","_")),160)}`}),e.jsx($,{textToCopy:`${n.url}${c(s.slug,encodeURI(t.filename.replaceAll(" ","_")),160)}`})]})]})]}),t.latitude&&t.longitude&&e.jsxs("div",{className:"flex-1 mb-8 md:mb-4",children:[e.jsx("h2",{className:"text-base mb-2",children:"Standort & Karte"}),e.jsx("p",{className:"text-xs mb-2 font-mono text-[11px]",children:`${t.latitude.toFixed(4)}, ${t.longitude.toFixed(4)}`}),e.jsx("div",{className:" aspect-square w-full overflow-hidden",children:e.jsx(U,{initialViewState:{latitude:t.latitude,longitude:t.longitude,zoom:12},style:{width:"100%",height:"100%"},mapStyle:r==="dark"?n.mapbox.style.dark:n.mapbox.style.light,mapboxAccessToken:n.mapbox.accessToken,scrollZoom:!0,dragPan:!1,children:e.jsx(E,{longitude:t.longitude,latitude:t.latitude,children:e.jsx("div",{children:e.jsx("div",{className:x("w-4 h-4 border border-white",r==="dark"?"bg-red-300":"bg-red-600")})})})},t.filename)}),e.jsxs("div",{className:"flex flex-wrap space-y-2 space-x-4 gap-0 mt-2",children:[e.jsx(D,{to:`/app/map?image=${N(t.filename.replace(/\.[^/.]+$/,""))}&gallery=${s.slug}`,className:x("text-sm inline-block underline underline-offset-4 inline-block ",r==="dark"?"text-white decoration-red-300 hover:text-red-300 hover:decoration-red-300":"text-black decoration-red-500 hover:text-red-600"),children:"Auf der Karte anzeigen"}),e.jsx(u,{className:"text-sm",href:`https://www.google.com/maps/search/?api=1&query=${t.latitude},${t.longitude}`,children:"Google Maps"}),e.jsx(u,{className:"text-sm",href:`http://maps.apple.com/?q=${t.latitude},${t.longitude}`,children:"Apple Maps"})]})]})]})]})]}),t.colorData?.dominantColors&&t.colorData.dominantColors.length>0&&e.jsxs("div",{className:"w-full pb-0 md:pb-0 max-w-4xl mt-8 pt-8 border-t border-neutral-500/50 border-dotted",children:[e.jsx("h2",{className:"text-base mb-4",children:"Farbpalette"}),e.jsx("div",{className:"flex flex-wrap gap-4 mb-4",children:t.colorData.dominantColors.map((l,f)=>e.jsxs("div",{className:"relative group cursor-pointer",title:`${l.hex} (${Math.round(l.percentage*100)}%)`,onClick:()=>{navigator.clipboard.writeText(l.hex);const h=document.createElement("div");document.body.appendChild(h),setTimeout(()=>document.body.removeChild(h),1e3)},children:[e.jsx("div",{className:"w-10 md:w-12 h-10 md:h-12 border border-neutral-500/20",style:{backgroundColor:l.hex}}),e.jsx("div",{className:"text-[7px] md:text-[9px] font-mono absolute inset-0 p-1 opacity-0 group-hover:opacity-100 text-white transition-opacity",children:l.hex})]},f))}),t.colorData.colorfulness!==void 0&&e.jsxs("p",{className:"text-[11px] mb-0 font-mono",children:["Farbwert: ",e.jsxs("span",{className:"",children:[t.colorData.colorfulness.toFixed(2),"%"]})]})]}),v.length>0&&e.jsxs("div",{className:"w-full pb-8 md:pb-0 max-w-4xl mt-8 pt-8 border-t border-neutral-500/50 border-dotted",children:[e.jsx("h2",{className:"text-base mb-4",children:"Andere Fotos"}),e.jsx("div",{className:"grid grid-cols-3 md:grid-cols-6 gap-4",children:v.map(l=>e.jsx(D,{to:`/gallery/${l.gallerySlug}/image/${N(l.filename.replace(/\.[^/.]+$/,""))}`,className:"relative",children:e.jsx("img",{src:c(l.gallerySlug,l.filename.replaceAll(" ","_"),380),alt:l.filename.replaceAll("_"," ").replace(".jpg","").trim(),width:160,height:160,sizes:"(max-width: 768px) 50vw, 20vw",className:x("aspect-square object-cover w-full h-full",l.isRandomPick&&"")})},l.filename))})]})]})};export{Q as default};
