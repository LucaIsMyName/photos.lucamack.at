const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/mapbox-gl-CNTiHEyl.js","assets/mapbox-gl-BTev-8MA.css"])))=>i.map(i=>d[i]);
import{r as a,_ as H,m as O}from"./index-BNWw3H1D.js";const I=a.createContext(null);function Z(e,t){const n=Array.isArray(e)?e[0]:e?e.x:0,r=Array.isArray(e)?e[1]:e?e.y:0,o=Array.isArray(t)?t[0]:t?t.x:0,s=Array.isArray(t)?t[1]:t?t.y:0;return n===o&&r===s}function p(e,t){if(e===t)return!0;if(!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!p(e[n],t[n]))return!1;return!0}else if(Array.isArray(t))return!1;if(typeof e=="object"&&typeof t=="object"){const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const o of n)if(!t.hasOwnProperty(o)||!p(e[o],t[o]))return!1;return!0}return!1}function B(e){const t=e.clone();return t.pixelsToGLUnits=e.pixelsToGLUnits,t}function w(e,t){if(!e.getProjection)return;const n=e.getProjection(),r=t.getProjection();p(n,r)||t.setProjection(n)}function b(e){return{longitude:e.center.lng,latitude:e.center.lat,zoom:e.zoom,pitch:e.pitch,bearing:e.bearing,padding:e.padding}}function x(e,t){const n=t.viewState||t;let r=!1;if("zoom"in n){const o=e.zoom;e.zoom=n.zoom,r=r||o!==e.zoom}if("bearing"in n){const o=e.bearing;e.bearing=n.bearing,r=r||o!==e.bearing}if("pitch"in n){const o=e.pitch;e.pitch=n.pitch,r=r||o!==e.pitch}if(n.padding&&!e.isPaddingEqual(n.padding)&&(r=!0,e.padding=n.padding),"longitude"in n&&"latitude"in n){const o=e.center;e.center=new o.constructor(n.longitude,n.latitude),r=r||o!==e.center}return r}const q=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function P(e){if(!e)return null;if(typeof e=="string"||("toJS"in e&&(e=e.toJS()),!e.layers))return e;const t={};for(const r of e.layers)t[r.id]=r;const n=e.layers.map(r=>{let o=null;"interactive"in r&&(o=Object.assign({},r),delete o.interactive);const s=t[r.ref];if(s){o=o||Object.assign({},r),delete o.ref;for(const i of q)i in s&&(o[i]=s[i])}return o||r});return{...e,layers:n}}var k={};const z={version:8,sources:{},layers:[]},A={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},S={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},N={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},V=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],W=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class E{constructor(t,n,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=o=>{const s=this.props[N[o.type]];s?s(o):o.type==="error"&&console.error(o.error)},this._onPointerEvent=o=>{(o.type==="mousemove"||o.type==="mouseout")&&this._updateHover(o);const s=this.props[A[o.type]];s&&(this.props.interactiveLayerIds&&o.type!=="mouseover"&&o.type!=="mouseout"&&(o.features=this._hoveredFeatures||this._queryRenderedFeatures(o.point)),s(o),delete o.features)},this._onCameraEvent=o=>{if(!this._internalUpdate){const s=this.props[S[o.type]];s&&s(o)}o.type in this._deferredEvents&&(this._deferredEvents[o.type]=!1)},this._MapClass=t,this.props=n,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(t){const n=this.props;this.props=t;const r=this._updateSettings(t,n);r&&this._createShadowTransform(this._map);const o=this._updateSize(t),s=this._updateViewState(t,!0);this._updateStyle(t,n),this._updateStyleComponents(t,n),this._updateHandlers(t,n),(r||o||s&&!this._map.isMoving())&&this.redraw()}static reuse(t,n){const r=E.savedMaps.pop();if(!r)return null;const o=r.map,s=o.getContainer();for(n.className=s.className;s.childNodes.length>0;)n.appendChild(s.childNodes[0]);o._container=n,r.setProps({...t,styleDiffing:!1}),o.resize();const{initialViewState:i}=t;return i&&(i.bounds?o.fitBounds(i.bounds,{...i.fitBoundsOptions,duration:0}):r._updateViewState(i,!1)),o.isStyleLoaded()?o.fire("load"):o.once("styledata",()=>o.fire("load")),o._update(),r}_initialize(t){const{props:n}=this,{mapStyle:r=z}=n,o={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||G()||null,container:t,style:P(r)},s=o.initialViewState||o.viewState||o;if(Object.assign(o,{center:[s.longitude||0,s.latitude||0],zoom:s.zoom||0,pitch:s.pitch||0,bearing:s.bearing||0}),n.gl){const l=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=l,n.gl)}const i=new this._MapClass(o);s.padding&&i.setPadding(s.padding),n.cursor&&(i.getCanvas().style.cursor=n.cursor),this._createShadowTransform(i);const c=i._render;i._render=l=>{this._inRender=!0,c.call(i,l),this._inRender=!1};const u=i._renderTaskQueue.run;i._renderTaskQueue.run=l=>{u.call(i._renderTaskQueue,l),this._onBeforeRepaint()},i.on("render",()=>this._onAfterRepaint());const f=i.fire;i.fire=this._fireEvent.bind(this,f),i.on("resize",()=>{this._renderTransform.resize(i.transform.width,i.transform.height)}),i.on("styledata",()=>{this._updateStyleComponents(this.props,{}),w(i.transform,this._renderTransform)}),i.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const l in A)i.on(l,this._onPointerEvent);for(const l in S)i.on(l,this._onCameraEvent);for(const l in N)i.on(l,this._onEvent);this._map=i}recycle(){this.map.getContainer().querySelector("[mapboxgl-children]")?.remove(),E.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const t=this._map;!this._inRender&&t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}_createShadowTransform(t){const n=B(t.transform);t.painter.transform=n,this._renderTransform=n}_updateSize(t){const{viewState:n}=t;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(t,n){if(this._internalUpdate)return!1;const r=this._map,o=this._renderTransform,{zoom:s,pitch:i,bearing:c}=o,u=r.isMoving();u&&(o.cameraElevationReference="sea");const f=x(o,{...b(r.transform),...t});if(u&&(o.cameraElevationReference="ground"),f&&n){const l=this._deferredEvents;l.move=!0,l.zoom||(l.zoom=s!==o.zoom),l.rotate||(l.rotate=c!==o.bearing),l.pitch||(l.pitch=i!==o.pitch)}return u||x(r.transform,t),f}_updateSettings(t,n){const r=this._map;let o=!1;for(const s of V)s in t&&!p(t[s],n[s])&&(o=!0,r[`set${s[0].toUpperCase()}${s.slice(1)}`]?.call(r,t[s]));return o}_updateStyle(t,n){if(t.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=t.cursor||""),t.mapStyle!==n.mapStyle){const{mapStyle:r=z,styleDiffing:o=!0}=t,s={diff:o};return"localIdeographFontFamily"in t&&(s.localIdeographFontFamily=t.localIdeographFontFamily),this._map.setStyle(P(r),s),!0}return!1}_updateStyleComponents(t,n){const r=this._map;let o=!1;return r.isStyleLoaded()&&("light"in t&&r.setLight&&!p(t.light,n.light)&&(o=!0,r.setLight(t.light)),"fog"in t&&r.setFog&&!p(t.fog,n.fog)&&(o=!0,r.setFog(t.fog)),"terrain"in t&&r.setTerrain&&!p(t.terrain,n.terrain)&&(!t.terrain||r.getSource(t.terrain.source))&&(o=!0,r.setTerrain(t.terrain))),o}_updateHandlers(t,n){const r=this._map;let o=!1;for(const s of W){const i=t[s]??!0,c=n[s]??!0;p(i,c)||(o=!0,i?r[s].enable(i):r[s].disable())}return o}_queryRenderedFeatures(t){const n=this._map,r=n.transform,{interactiveLayerIds:o=[]}=this.props;try{return n.transform=this._renderTransform,n.queryRenderedFeatures(t,{layers:o.filter(n.getLayer.bind(n))})}catch{return[]}finally{n.transform=r}}_updateHover(t){const{props:n}=this;if(n.interactiveLayerIds&&(n.onMouseMove||n.onMouseEnter||n.onMouseLeave)){const o=t.type,s=this._hoveredFeatures?.length>0,i=this._queryRenderedFeatures(t.point),c=i.length>0;!c&&s&&(t.type="mouseleave",this._onPointerEvent(t)),this._hoveredFeatures=i,c&&!s&&(t.type="mouseenter",this._onPointerEvent(t)),t.type=o}else this._hoveredFeatures=null}_fireEvent(t,n,r){const o=this._map,s=o.transform,i=typeof n=="string"?n:n.type;return i==="move"&&this._updateViewState(this.props,!1),i in S&&(typeof n=="object"&&(n.viewState=b(s)),this._map.isMoving())?(o.transform=this._renderTransform,t.call(o,n,r),o.transform=s,o):(t.call(o,n,r),o)}_onBeforeRepaint(){const t=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&t.fire(r);this._internalUpdate=!1;const n=this._map.transform;t.transform=this._renderTransform,this._onAfterRepaint=()=>{w(this._renderTransform,n),t.transform=n}}}E.savedMaps=[];function G(){let e=null;if(typeof location<"u"){const t=/access_token=([^&\/]*)/.exec(location.search);e=t&&t[1]}try{e=e||k.MapboxAccessToken}catch{}try{e=e||k.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return e}const Q=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function K(e){if(!e)return null;const t=e.map,n={getMap:()=>t,getCenter:()=>e.transform.center,getZoom:()=>e.transform.zoom,getBearing:()=>e.transform.bearing,getPitch:()=>e.transform.pitch,getPadding:()=>e.transform.padding,getBounds:()=>e.transform.getBounds(),project:r=>{const o=t.transform;t.transform=e.transform;const s=t.project(r);return t.transform=o,s},unproject:r=>{const o=t.transform;t.transform=e.transform;const s=t.unproject(r);return t.transform=o,s},queryTerrainElevation:(r,o)=>{const s=t.transform;t.transform=e.transform;const i=t.queryTerrainElevation(r,o);return t.transform=s,i},queryRenderedFeatures:(r,o)=>{const s=t.transform;t.transform=e.transform;const i=t.queryRenderedFeatures(r,o);return t.transform=s,i}};for(const r of $(t))!(r in n)&&!Q.includes(r)&&(n[r]=t[r].bind(t));return n}function $(e){const t=new Set;let n=e;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof e[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&t.add(r);n=Object.getPrototypeOf(n)}return Array.from(t)}const J=typeof document<"u"?a.useLayoutEffect:a.useEffect,Y=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function X(e,t){for(const r of Y)r in t&&(e[r]=t[r]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=t;n&&e.getRTLTextPluginStatus&&e.getRTLTextPluginStatus()==="unavailable"&&e.setRTLTextPlugin(n,r=>{r&&console.error(r)},!0)}const M=a.createContext(null);function ee(e,t){const n=a.useContext(I),[r,o]=a.useState(null),s=a.useRef(),{current:i}=a.useRef({mapLib:null,map:null});a.useEffect(()=>{const f=e.mapLib;let l=!0,m;return Promise.resolve(f||H(()=>import("./mapbox-gl-CNTiHEyl.js").then(d=>d.m),__vite__mapDeps([0,1]))).then(d=>{if(!l)return;if(!d)throw new Error("Invalid mapLib");const h="Map"in d?d:d.default;if(!h.Map)throw new Error("Invalid mapLib");X(h,e),e.reuseMaps&&(m=E.reuse(e,s.current)),m||(m=new E(h.Map,e,s.current)),i.map=K(m),i.mapLib=h,o(m),n?.onMapMount(i.map,e.id)}).catch(d=>{const{onError:h}=e;h?h({type:"error",target:null,error:d}):console.error(d)}),()=>{l=!1,m&&(n?.onMapUnmount(e.id),e.reuseMaps?m.recycle():m.destroy())}},[]),J(()=>{r&&r.setProps(e)}),a.useImperativeHandle(t,()=>i.map,[r]);const c=a.useMemo(()=>({position:"relative",width:"100%",height:"100%",...e.style}),[e.style]),u={height:"100%"};return a.createElement("div",{id:e.id,ref:s,style:c},r&&a.createElement(M.Provider,{value:i},a.createElement("div",{"mapboxgl-children":"",style:u},e.children)))}const ce=a.forwardRef(ee),te=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function v(e,t){if(!e||!t)return;const n=e.style;for(const r in t){const o=t[r];Number.isFinite(o)&&!te.test(r)?n[r]=`${o}px`:n[r]=o}}function j(e,t){if(e===t)return null;const n=F(e),r=F(t),o=[];for(const s of r)n.has(s)||o.push(s);for(const s of n)r.has(s)||o.push(s);return o.length===0?null:o}function F(e){return new Set(e?e.trim().split(/\s+/):[])}const le=a.memo(a.forwardRef((e,t)=>{const{map:n,mapLib:r}=a.useContext(M),o=a.useRef({props:e}),s=a.useMemo(()=>{let L=!1;a.Children.forEach(e.children,g=>{g&&(L=!0)});const U={...e,element:L?document.createElement("div"):null},_=new r.Marker(U);return _.setLngLat([e.longitude,e.latitude]),_.getElement().addEventListener("click",g=>{o.current.props.onClick?.({type:"click",target:_,originalEvent:g})}),_.on("dragstart",g=>{const y=g;y.lngLat=s.getLngLat(),o.current.props.onDragStart?.(y)}),_.on("drag",g=>{const y=g;y.lngLat=s.getLngLat(),o.current.props.onDrag?.(y)}),_.on("dragend",g=>{const y=g;y.lngLat=s.getLngLat(),o.current.props.onDragEnd?.(y)}),_},[]);a.useEffect(()=>(s.addTo(n.getMap()),()=>{s.remove()}),[]);const{longitude:i,latitude:c,offset:u,style:f,draggable:l=!1,popup:m=null,rotation:d=0,rotationAlignment:h="auto",pitchAlignment:T="auto"}=e;a.useEffect(()=>{v(s.getElement(),f)},[f]),a.useImperativeHandle(t,()=>s,[]);const D=o.current.props;(s.getLngLat().lng!==i||s.getLngLat().lat!==c)&&s.setLngLat([i,c]),u&&!Z(s.getOffset(),u)&&s.setOffset(u),s.isDraggable()!==l&&s.setDraggable(l),s.getRotation()!==d&&s.setRotation(d),s.getRotationAlignment()!==h&&s.setRotationAlignment(h),s.getPitchAlignment()!==T&&s.setPitchAlignment(T),s.getPopup()!==m&&s.setPopup(m);const R=j(D.className,e.className);if(R)for(const L of R)s.toggleClassName(L);return o.current.props=e,O.createPortal(e.children,s.getElement())})),ue=a.memo(a.forwardRef((e,t)=>{const{map:n,mapLib:r}=a.useContext(M),o=a.useMemo(()=>document.createElement("div"),[]),s=a.useRef({props:e}),i=a.useMemo(()=>{const c={...e},u=new r.Popup(c);return u.setLngLat([e.longitude,e.latitude]),u.once("open",f=>{s.current.props.onOpen?.(f)}),u},[]);if(a.useEffect(()=>{const c=u=>{s.current.props.onClose?.(u)};return i.on("close",c),i.setDOMContent(o).addTo(n.getMap()),()=>{i.off("close",c),i.isOpen()&&i.remove()}},[]),a.useEffect(()=>{v(i.getElement(),e.style)},[e.style]),a.useImperativeHandle(t,()=>i,[]),i.isOpen()){const c=s.current.props;(i.getLngLat().lng!==e.longitude||i.getLngLat().lat!==e.latitude)&&i.setLngLat([e.longitude,e.latitude]),e.offset&&!p(c.offset,e.offset)&&(i.options.anchor=e.anchor,i.setOffset(e.offset)),(c.anchor!==e.anchor||c.maxWidth!==e.maxWidth)&&i.setMaxWidth(e.maxWidth);const u=j(c.className,e.className);if(u)for(const f of u)i.toggleClassName(f);s.current.props=e}return O.createPortal(e.children,o)}));function C(e,t,n,r){const o=a.useContext(M),s=a.useMemo(()=>e(o),[]);return a.useEffect(()=>{const i=t,c=null,u=typeof t=="function"?t:null,{map:f}=o;return f.hasControl(s)||(f.addControl(s,i?.position),c&&c(o)),()=>{u&&u(o),f.hasControl(s)&&f.removeControl(s)}},[]),s}function ne(e){const t=C(({mapLib:n})=>new n.AttributionControl(e),{position:e.position});return a.useEffect(()=>{v(t._container,e.style)},[e.style]),null}a.memo(ne);function oe(e){const t=C(({mapLib:n})=>new n.FullscreenControl({container:e.containerId&&document.getElementById(e.containerId)}),{position:e.position});return a.useEffect(()=>{v(t._controlContainer,e.style)},[e.style]),null}a.memo(oe);function re(e,t){const n=a.useRef({props:e}),r=C(({mapLib:o})=>{const s=new o.GeolocateControl(e),i=s._setupUI.bind(s);return s._setupUI=c=>{s._container.hasChildNodes()||i(c)},s.on("geolocate",c=>{n.current.props.onGeolocate?.(c)}),s.on("error",c=>{n.current.props.onError?.(c)}),s.on("outofmaxbounds",c=>{n.current.props.onOutOfMaxBounds?.(c)}),s.on("trackuserlocationstart",c=>{n.current.props.onTrackUserLocationStart?.(c)}),s.on("trackuserlocationend",c=>{n.current.props.onTrackUserLocationEnd?.(c)}),s},{position:e.position});return n.current.props=e,a.useImperativeHandle(t,()=>r,[]),a.useEffect(()=>{v(r._container,e.style)},[e.style]),null}a.memo(a.forwardRef(re));function se(e){const t=C(({mapLib:n})=>new n.NavigationControl(e),{position:e.position});return a.useEffect(()=>{v(t._container,e.style)},[e.style]),null}a.memo(se);function ie(e){const t=C(({mapLib:s})=>new s.ScaleControl(e),{position:e.position}),n=a.useRef(e),r=n.current;n.current=e;const{style:o}=e;return e.maxWidth!==void 0&&e.maxWidth!==r.maxWidth&&(t.options.maxWidth=e.maxWidth),e.unit!==void 0&&e.unit!==r.unit&&t.setUnit(e.unit),a.useEffect(()=>{v(t._container,o)},[o]),null}a.memo(ie);export{ce as M,ue as P,le as a,M as b,p as d};
